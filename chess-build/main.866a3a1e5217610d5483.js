(()=>{"use strict";var e,t={57:(e,t,n)=>{n.r(t)},995:(e,t,n)=>{n.r(t)},978:(e,t,n)=>{n.r(t)},115:(e,t,n)=>{n.r(t)},906:(e,t,n)=>{n.r(t)},801:(e,t,n)=>{n.r(t)},457:(e,t,n)=>{n.r(t)},94:(e,t,n)=>{n.r(t)},786:(e,t,n)=>{n.r(t)},729:(e,t,n)=>{n.r(t)},241:(e,t,n)=>{n.r(t)},563:(e,t,n)=>{n.r(t)},77:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,o,i,s,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;var s=n(690),r=n(0),a=n(229),l=n(977),c=n(381),p=n(456),h=n(561),u=n(649),d=n(610),m=n(266),v=function(){function e(e){this.rootElement=e,this.initDB(),this.header=new l.Header,this.rootElement.appendChild(this.header.element),this.footer=new r.Footer,this.rootElement.appendChild(this.footer.element),this.router=new u.Router}return e.prototype.initDB=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,s.storage.createDataBase()];case 1:return e.sent(),this.initRoute(),this.router.changeRoute(),[2]}}))}))},e.prototype.initRoute=function(){var t=this;this.router.add({pageName:"watch-replays",hash:"Watch-replay",needFoo:function(){return t.startWatchReplay()}}),this.router.add({pageName:"lobby",hash:"#/Lobby",needFoo:function(){return t.startLobbyPage()}}),this.router.add({pageName:"setting",hash:"#/Setting",needFoo:function(){return e.startSettingPage()}}),this.router.add({pageName:"game",hash:"#/Game",needFoo:function(){return t.startGamePage()}}),this.router.add({pageName:"replays",hash:"#/Replays",needFoo:function(){return t.startReplaysPage()}})},e.prototype.startLobbyPage=function(){this.header.removeAllBtns(),this.clearWindow(),this.lobby?this.lobby.resetOnlineSearch():this.lobby=new c.Lobby,this.activePage=this.lobby,this.rootElement.insertBefore(this.lobby.element,this.footer.element)},e.startSettingPage=function(){},e.prototype.startGamePage=function(){var e;this.header.removeAllBtns(),this.clearWindow(),(null===(e=this.lobby)||void 0===e?void 0:e.socket)&&this.lobby.color?this.game=new p.OnlineGame(this.lobby.color,this.lobby.socket):(this.game=new a.Game,this.game.dragAndDropListners());var t=this.header.createSurrenderAndDrawBtns();this.initGameBtns(t.surrenderBtn,t.drawBtn),this.initTimer(),d.timer.startTimer(),this.activePage=this.game,this.rootElement.insertBefore(this.game.element,this.footer.element)},e.prototype.initGameBtns=function(e,t){var n=this;e.addEventListener("click",(function(){var e,t;(null===(e=n.game)||void 0===e?void 0:e.isEndGame)||(n.game instanceof p.OnlineGame?n.game.surrenderBtnEvent():null===(t=n.game)||void 0===t||t.surrender())}),{once:!0}),t.addEventListener("click",(function(){var e,t;(null===(e=n.game)||void 0===e?void 0:e.isEndGame)||(n.game instanceof p.OnlineGame?n.game.drawBtnEvent():null===(t=n.game)||void 0===t||t.draw())}))},e.prototype.startReplaysPage=function(){this.header.removeAllBtns(),this.clearWindow(),this.replays=new h.Replays,this.activePage=this.replays,this.rootElement.insertBefore(this.replays.element,this.footer.element)},e.prototype.startWatchReplay=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(o){switch(o.label){case 0:return this.header.removeAllBtns(),this.clearWindow(),[4,e.getReplay()];case 1:return t=o.sent(),n=this.header.createReplayBtns(),this.initTimer(),this.watchReplay=new m.WatchReplay(t,n),this.activePage=this.watchReplay,this.rootElement.insertBefore(this.watchReplay.element,this.footer.element),[2]}}))}))},e.getReplay=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t){return o(e,void 0,void 0,(function(){var e,n,o,r,a;return i(this,(function(i){switch(i.label){case 0:return e=window.location.hash,n=e.split("/"),o=n[n.length-1],[4,s.storage.getReplays()];case 1:return r=i.sent(),a=r[Number(o)],t(a),[2]}}))}))}))]}))}))},e.prototype.initTimer=function(){d.timer.clearTimer(),this.header.getContainer().appendChild(d.timer.element)},e.prototype.clearWindow=function(){var e,t,n;this.game instanceof p.OnlineGame?this.game.offSocket():(null===(e=this.game)||void 0===e?void 0:e.isEndGame)||null===(t=this.game)||void 0===t||t.surrender(),this.game=void 0,null===(n=this.activePage)||void 0===n||n.element.remove()},e}();t.App=v},636:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ChessBoard=void 0;var s=n(650),r=n(836),a=n(175),l=n(443),c=n(767),p=n(278),h=n(506),u=n(188),d=n(595);n(57);var m=n(510),v=function(e){function t(n){var o=e.call(this,"div",[d.setting.classNames.board,d.setting.classNames.game.noRotate])||this;return o.pieces=[],o.allMoves=[],d.setting.gameSetup=JSON.parse(JSON.stringify(n)),o.cells=o.cellsInit(),o.element.appendChild(t.boardNumerationInit("number")),o.element.appendChild(t.boardNumerationInit("letter")),o.newPlacePieces(n),o.allPossibleMoveDetermination(),o}return i(t,e),t.prototype.cellsInit=function(){for(var e=[],t=!0,n=8;n>=1;n--){for(var o=1;o<=8;o++){var i=document.createElement("div");i.id=""+String.fromCharCode(96+o)+n,t?i.classList.add(d.setting.classNames.cell,d.setting.classNames.whiteCell):i.classList.add(d.setting.classNames.cell,d.setting.classNames.blackCell),t=!t,e.push(i),this.element.appendChild(i)}t=!t}return e},t.boardNumerationInit=function(e){var t=document.createElement("div");if(t.classList.add(d.setting.classNames.numerationAll),e===d.setting.classNames.numberId){t.id=d.setting.classNames.numberId;for(var n=8;n>=1;n--){var o=document.createElement("div");o.innerHTML=String(n),o.classList.add(d.setting.classNames.numerationEach),t.appendChild(o)}}else for(t.id=d.setting.classNames.letterId,n=1;n<=8;n++){var i=document.createElement("div");i.innerHTML=String.fromCharCode(96+n),i.classList.add(d.setting.classNames.numerationEach),t.appendChild(i)}return t},t.prototype.newPlacePieces=function(e){var t=this;e.forEach((function(e){var n=e.piece,o=d.setting.createFunctions[n](e.cell);t.pieces.push(o);var i=r.cellNameToCellPosition(e.cell);t.cells[i].appendChild(o.element)}))},t.prototype.allPossibleMoveDetermination=function(){var e=this;this.pieces.forEach((function(t){t.possibleMoveDetermination(d.setting.gameSetup),e.capturingEnPassantValidation(t)})),this.castlingDetermination(),this.updateAllPossibleMoves()},t.prototype.updateAllPossibleMoves=function(){var e=this;this.allMoves=[],this.pieces.forEach((function(t){e.allMoves.push({cell:t.cell,moves:t.possibleMoves})}))},t.prototype.capturingEnPassantValidation=function(e){if(e instanceof c.Pawn){var t=a.cellNameToCoordinates(e.cell),n=e.getPawnIncrement()>0?d.setting.passantCell.positiveIncrement:d.setting.passantCell.negativeIncrement,o={X:t.X,Y:n};JSON.stringify(t)===JSON.stringify(o)&&(this.passantInDirection(e,1),this.passantInDirection(e,-1))}},t.prototype.passantInDirection=function(e,t){var n=a.cellNameToCoordinates(e.cell),o={X:n.X+t,Y:n.Y+e.getPawnIncrement()},i=s.cellCoordinatesToName(o),r={X:n.X+t,Y:n.Y},l=s.cellCoordinatesToName(r);this.passantPiecesValidation(l)&&e.possibleMoves.push(i)},t.prototype.passantPiecesValidation=function(e){for(var t=0;t<this.pieces.length;t++){var n=this.pieces[t];if(n.cell===e&&n instanceof c.Pawn&&n.canBeCapturedEnPassant)return!0}return!1},t.prototype.castlingDetermination=function(){this.castlingForEachPiece(u.color.white),this.castlingForEachPiece(u.color.black)},t.prototype.castlingForEachPiece=function(e){var t=this.kingSearcher(e),n=a.cellNameToCoordinates(t.cell);this.castlingValidationInDirection(t,1)&&t.possibleMoves.push(s.cellCoordinatesToName({X:n.X+2,Y:n.Y})),this.castlingValidationInDirection(t,-1)&&t.possibleMoves.push(s.cellCoordinatesToName({X:n.X-2,Y:n.Y}))},t.prototype.kingSearcher=function(e){for(var t=0;t<this.pieces.length;t++){var n=this.pieces[t];if(n instanceof l.King&&n.color===e)return n}throw Error("King does not exist!")},t.prototype.castlingValidationInDirection=function(e,t){if(e.isFirstMove){var n=a.cellNameToCoordinates(e.cell),o=m.colorFunctions.getReverseColor(e.color);return!(this.clearCellAndRookValidation(n,t)||this.castlingCellInCheckValidation(o,n,t))}return!1},t.prototype.clearCellAndRookValidation=function(e,t){for(var n,o=e.X+t;o<8&&o>-1;o+=t){if(7===o||0===o){for(var i=0;i<this.pieces.length;i++)if(this.pieces[i].cell===s.cellCoordinatesToName({X:o,Y:e.Y})&&this.pieces[i]instanceof p.Rook){n=this.pieces[i];break}return!(null==n?void 0:n.isFirstMove)}var r=s.cellCoordinatesToName({X:o,Y:e.Y});for(i=0;i<d.setting.gameSetup.length;i++)if(d.setting.gameSetup[i].cell===r)return!0}throw Error("Breaking bad!")},t.prototype.castlingCellInCheckValidation=function(e,t,n){for(var o=this.possibleWhitesOrBlacksMoves(e),i=Math.abs(2*n),r=t.X;r>t.X-i&&r<t.X+i;r+=n){var a=s.cellCoordinatesToName({X:r,Y:t.Y});if(-1!==o.indexOf(a))return!0}return!1},t.prototype.getAllCells=function(){return this.cells},t.prototype.selectPiece=function(e){for(var t=0;t<this.pieces.length;t++)if(this.pieces[t].cell===e)return this.pieces[t];throw Error()},t.prototype.pieceMove=function(e,n){(n instanceof p.Rook||n instanceof l.King)&&(this.castlingMove(e,n),n.isFirstMove=!1),this.capturingEnPassantTry(e,n),this.longPawnMoveReset(),t.longPawnMoveValidation(e,n),this.capturingTry(e),n.element.remove(),this.cells[r.cellNameToCellPosition(e)].appendChild(n.element),t.updateGameSetup(e,n),n.cell=e},t.prototype.removeCloseMove=function(){this.allPossibleMoveDetermination(),this.removeMovesForСheck(u.color.white),this.removeMovesForСheck(u.color.black)},t.prototype.longPawnMoveReset=function(){for(var e=0;e<this.pieces.length;e++){var t=this.pieces[e];t instanceof c.Pawn&&(t.canBeCapturedEnPassant=!1)}},t.longPawnMoveValidation=function(e,t){var n=a.cellNameToCoordinates(e),o=a.cellNameToCoordinates(t.cell);t instanceof c.Pawn&&(t.canBeCapturedEnPassant=2===Math.abs(n.Y-o.Y))},t.prototype.capturingEnPassantTry=function(e,t){if(t instanceof c.Pawn){var n=a.cellNameToCoordinates(e),o=a.cellNameToCoordinates(t.cell),i=n.X-o.X;if(i)for(var r=s.cellCoordinatesToName({X:o.X+i,Y:o.Y}),l=0;l<this.pieces.length;l++){var p=this.pieces[l];if(p instanceof c.Pawn&&p.cell===r&&p.canBeCapturedEnPassant){for(var h=0;h<d.setting.gameSetup.length;h++)if(d.setting.gameSetup[h].cell===r){d.setting.gameSetup.splice(h,1);break}p.element.remove(),this.pieces.splice(l,1);break}}}},t.updateGameSetup=function(e,t){for(var n=0;n<d.setting.gameSetup.length;n++)if(d.setting.gameSetup[n].cell===t.cell){d.setting.gameSetup[n].cell=e;break}},t.prototype.capturingTry=function(e){for(var t=0;t<this.pieces.length;t++)if(this.pieces[t].cell===e){for(var n=0;n<d.setting.gameSetup.length;n++)d.setting.gameSetup[n].cell===e&&d.setting.gameSetup.splice(n,1);this.pieces[t].element.remove(),this.pieces.splice(t,1);break}},t.prototype.castlingMove=function(e,n){var o=a.cellNameToCoordinates(e),i=a.cellNameToCoordinates(n.cell);if(n instanceof l.King&&n.isFirstMove&&(o.X===i.X+2||o.X===i.X-2)){for(var c=(o.X-i.X)/2,h=c>0?7:0,u=s.cellCoordinatesToName({X:h,Y:i.Y}),d=void 0,m=0;m<this.pieces.length;m++)if(this.pieces[m].cell===u&&this.pieces[m]instanceof p.Rook){d=this.pieces[m];break}if(!d)throw Error("Rook does not exist!");var v=s.cellCoordinatesToName({X:i.X+c,Y:i.Y});d.element.remove(),this.cells[r.cellNameToCellPosition(v)].appendChild(d.element),t.updateGameSetup(v,d),d.cell=v}},t.prototype.removeMovesForСheck=function(e){var t=JSON.parse(JSON.stringify(d.setting.gameSetup)),n=m.colorFunctions.getReverseColor(e);this.possibleMoveDeterminationInCheck(n,t)},t.prototype.possibleMoveDeterminationInCheck=function(e,n){var o=[],i=[];this.pieces.forEach((function(t){t.color===e?o.push(t):i.push(t)})),o.forEach((function(e){for(var o=e.cell,s=0;s<e.possibleMoves.length;s++){var r=t.testCapturing(n,e,i,e.possibleMoves[s]);t.moveTesting(n,e,e.possibleMoves[s]),t.testCheckValidation(n,i)&&(e.possibleMoves.splice(s,1),s--),r&&(n.push(r.capturedPieceSetup),i.push(r.capturedPiece))}t.moveTesting(n,e,o)})),this.updateAllPossibleMoves()},t.testCheckValidation=function(e,n){if(!n.length||t.captureAttakingKingCheck(e,n[0].color))return!1;var o=n[0].color===u.color.white?u.color.black:u.color.white,i=t.getKingPosition(e,o),s=[];return n.forEach((function(t){var n=Object.assign(Object.create(Object.getPrototypeOf(t)),t);n.possibleMoveDetermination(e),s.push.apply(s,n.possibleMoves)})),-1!==s.indexOf(i)},t.captureAttakingKingCheck=function(e,t){for(var n=0,o=e;n<o.length;n++)if(o[n].piece===t+"King")return!1;return!0},t.moveTesting=function(e,t,n){for(var o=0;o<e.length;o++)if(e[o].cell===t.cell&&-1!==e[o].piece.indexOf(t.color)){e[o].cell=n;break}t.cell=n},t.testCapturing=function(e,n,o,i){for(var s,r,a=0;a<e.length;a++)if(e[a].cell===i&&-1===e[a].piece.indexOf(n.color)){s=e[a],e.splice(a,1);break}for(a=0;a<o.length;a++)if(o[a].cell===i){r=o[a],o.splice(a,1);break}if(t.testCapturingEnPassant(s,r,i,e,n,o),r&&s)return{capturedPieceSetup:s,capturedPiece:r}},t.testCapturingEnPassant=function(e,t,n,o,i,r){if(i instanceof c.Pawn)for(var l=a.cellNameToCoordinates(n),p=s.cellCoordinatesToName({X:l.X,Y:l.Y-i.getPawnIncrement()}),h=0;h<r.length;h++){var u=r[h];if(u instanceof c.Pawn&&u.cell===p&&u.canBeCapturedEnPassant){for(var d=0;d<o.length;d++)if(o[d].cell===p){o[d],o.splice(d,1);break}r.splice(h,1);break}}},t.prototype.checkValidation=function(e){var n=m.colorFunctions.getReverseColor(e),o=t.getKingPosition(d.setting.gameSetup,n);return-1!==this.possibleWhitesOrBlacksMoves(e).indexOf(o)},t.prototype.movePossibilityValidation=function(e){var t=m.colorFunctions.getReverseColor(e);return!!this.possibleWhitesOrBlacksMoves(t).length},t.prototype.possibleWhitesOrBlacksMoves=function(e){var t=[];return this.pieces.forEach((function(n){n.color===e&&t.push.apply(t,n.possibleMoves)})),t},t.prototype.getCheckPieces=function(e){var n=[],o=m.colorFunctions.getReverseColor(e),i=t.getKingPosition(d.setting.gameSetup,o);return this.pieces.forEach((function(e){-1===e.possibleMoves.indexOf(i)&&e.cell!==i||n.push(e)})),n},t.getKingPosition=function(e,t){for(var n=0;n<e.length;n++)if(e[n].piece===t+"King")return e[n].cell;throw Error("King does not exist")},t.prototype.renderNewChessBoard=function(e){this.pieces.forEach((function(e){e.element.remove()})),this.pieces.length=0,this.newPlacePieces(e)},t}(h.BaseComponents);t.ChessBoard=v},839:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.BasePiece=void 0;var s=n(650),r=n(506),a=n(188),l=n(595),c=function(e){function t(t,n,o){var i=e.call(this,"img",[l.setting.classNames.piece])||this;return i.name=o,i.possibleMoves=[],i.cell=t,i.color=n,i}return i(t,e),t.piecesCheck=function(e,t){var n=s.cellCoordinatesToName({X:e.X,Y:e.Y}),o="";if(t.forEach((function(e){e.cell===n&&(o=e.piece)})),o)return-1!==o.indexOf(a.color.black)?a.color.black:a.color.white},t.prototype.possibleMoveCheck=function(e,n,o,i){for(var r=e.X+n,a=e.Y+o;r<8&&r>-1&&a<8&&a>-1;r+=n,a+=o){var l={X:r,Y:a},c=t.piecesCheck(l,i);if(c){c!==this.color&&this.possibleMoves.push(s.cellCoordinatesToName(l));break}this.possibleMoves.push(s.cellCoordinatesToName(l))}},t}(r.BaseComponents);t.BasePiece=c},91:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Bishop=void 0;var s=n(175),r=n(595),a=function(e){function t(t,n){var o=e.call(this,t,n,"Bishop")||this,i=n+o.name;return o.element.setAttribute(r.setting.classNames.dataPiece,i),o.element.src=r.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=s.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,-1,1,e),this.possibleMoveCheck(t,1,1,e),this.possibleMoveCheck(t,1,-1,e),this.possibleMoveCheck(t,-1,-1,e)},t}(n(839).BasePiece);t.Bishop=a},443:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.King=void 0;var s=n(650),r=n(175),a=n(595),l=n(839),c=function(e){function t(t,n){var o=e.call(this,t,n,"King")||this;o.isFirstMove=!0;var i=n+o.name;return o.element.setAttribute(a.setting.classNames.dataPiece,i),o.element.src=a.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];for(var t=r.cellNameToCoordinates(this.cell),n=t.Y-1;n<t.Y+2;n++)if(n<8&&n>-1)for(var o=t.X-1;o<t.X+2;o++)o<8&&o>-1&&l.BasePiece.piecesCheck({X:o,Y:n},e)!==this.color&&this.possibleMoves.push(s.cellCoordinatesToName({X:o,Y:n}))},t}(l.BasePiece);t.King=c},822:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Knight=void 0;var s=n(650),r=n(175),a=n(595),l=n(839),c=function(e){function t(t,n){var o=e.call(this,t,n,"Knight")||this,i=n+o.name;return o.element.setAttribute(a.setting.classNames.dataPiece,i),o.element.src=a.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=r.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,1,2,e),this.possibleMoveCheck(t,-1,2,e),this.possibleMoveCheck(t,1,-2,e),this.possibleMoveCheck(t,-1,-2,e),this.possibleMoveCheck(t,2,1,e),this.possibleMoveCheck(t,2,-1,e),this.possibleMoveCheck(t,-2,1,e),this.possibleMoveCheck(t,-2,-1,e)},t.prototype.possibleMoveCheck=function(e,t,n,o){var i=e.X+t,r=e.Y+n;i<8&&i>-1&&r<8&&r>-1&&l.BasePiece.piecesCheck({X:i,Y:r},o)!==this.color&&this.possibleMoves.push(s.cellCoordinatesToName({X:i,Y:r}))},t}(l.BasePiece);t.Knight=c},767:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Pawn=void 0;var s=n(650),r=n(175),a=n(188),l=n(595),c=n(839),p=function(e){function t(t,n){var o,i,s=e.call(this,t,n,"Pawn")||this;s.canBeCapturedEnPassant=!1;var r=n+s.name;return s.element.setAttribute(l.setting.classNames.dataPiece,r),s.element.src=l.setting.imgNames[r],l.setting.isWhiteFromBelow?(o=s.color===a.color.white?[1,"2"]:[-1,"7"],s.pawnIncrement=o[0],s.startRow=o[1]):(i=s.color===a.color.white?[-1,"7"]:[1,"2"],s.pawnIncrement=i[0],s.startRow=i[1]),s}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=r.cellNameToCoordinates(this.cell);this.possiblePawnMoveCheck(t,e)&&this.cell[1]===this.startRow&&this.possiblePawnMoveCheck({X:t.X,Y:t.Y+this.pawnIncrement},e),this.possibleCaptureCheck(t,-1,e),this.possibleCaptureCheck(t,1,e)},t.prototype.possiblePawnMoveCheck=function(e,t){var n=e.Y+this.pawnIncrement;return n<8&&n>-1&&!c.BasePiece.piecesCheck({X:e.X,Y:n},t)&&(this.possibleMoves.push(s.cellCoordinatesToName({X:e.X,Y:n})),!0)},t.prototype.possibleCaptureCheck=function(e,t,n){var o=e.X+t,i=e.Y+this.pawnIncrement;o<8&&o>-1&&i<8&&i>-1&&c.BasePiece.piecesCheck({X:o,Y:i},n)&&c.BasePiece.piecesCheck({X:o,Y:i},n)!==this.color&&this.possibleMoves.push(s.cellCoordinatesToName({X:o,Y:i}))},t.prototype.getPawnIncrement=function(){return this.pawnIncrement},t}(c.BasePiece);t.Pawn=p},336:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Queen=void 0;var s=n(175),r=n(595),a=function(e){function t(t,n){var o=e.call(this,t,n,"Queen")||this,i=n+o.name;return o.element.setAttribute(r.setting.classNames.dataPiece,i),o.element.src=r.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=s.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,-1,1,e),this.possibleMoveCheck(t,0,1,e),this.possibleMoveCheck(t,1,1,e),this.possibleMoveCheck(t,1,0,e),this.possibleMoveCheck(t,1,-1,e),this.possibleMoveCheck(t,0,-1,e),this.possibleMoveCheck(t,-1,-1,e),this.possibleMoveCheck(t,-1,0,e)},t}(n(839).BasePiece);t.Queen=a},278:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Rook=void 0;var s=n(175),r=n(595),a=function(e){function t(t,n){var o=e.call(this,t,n,"Rook")||this;o.isFirstMove=!0;var i=n+o.name;return o.element.setAttribute(r.setting.classNames.dataPiece,i),o.element.src=r.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=s.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,0,1,e),this.possibleMoveCheck(t,0,-1,e),this.possibleMoveCheck(t,1,0,e),this.possibleMoveCheck(t,-1,0,e)},t.prototype.getPossibleMoves=function(){return this.possibleMoves},t}(n(839).BasePiece);t.Rook=a},690:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.storage=void 0;var o=n(491);t.storage=new o.DataBase},491:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataBase=void 0;var o=n(595),i=function(){function e(){}return e.prototype.createDataBase=function(){var e=this;return new Promise((function(t){var n=indexedDB.open("Chess",o.setting.dataBase.version);n.onupgradeneeded=function(){e.dataBase=n.result,e.dataBase.createObjectStore(o.setting.dataBase.storeUserName,{keyPath:"counter"}),e.dataBase.createObjectStore(o.setting.dataBase.storeGamesName,{autoIncrement:!0})},n.onsuccess=function(){e.dataBase=n.result,t()},n.onerror=function(){throw Error("Error opening database!")}}))},e.prototype.addPlayer=function(e,t,n){var i,s=null===(i=this.dataBase)||void 0===i?void 0:i.transaction([o.setting.dataBase.storeUserName],"readwrite");if(!s)throw Error("Data base not exist!");var r={player:e,counter:t,color:n};s.objectStore(o.setting.dataBase.storeUserName).put(r),s.oncomplete=function(){console.log("Player saved!")},s.onerror=function(){console.log("Error storing player!")}},e.prototype.getPlayers=function(){var e=this;return new Promise((function(t){var n,i=null===(n=e.dataBase)||void 0===n?void 0:n.transaction([o.setting.dataBase.storeUserName],"readonly");if(!i)throw Error("Data base not exist!");var s=i.objectStore(o.setting.dataBase.storeUserName).openCursor(),r=[];s.onsuccess=function(){var e=s.result;e?(r.push(e.value.player),e.continue()):t(r)},s.onerror=function(){throw Error("Error with cursor request!")}}))},e.prototype.addReplay=function(e,t,n,i,s){var r,a=null===(r=this.dataBase)||void 0===r?void 0:r.transaction([o.setting.dataBase.storeGamesName],"readwrite");if(!a)throw Error("Data base not exist!");var l={firstPlayer:e,secondPlayer:t,winner:n,moveAmount:i,time:s};a.objectStore(o.setting.dataBase.storeGamesName).put(l),a.oncomplete=function(){console.log("Replay saved!")},a.onerror=function(){console.log("Error storing replay!")}},e.prototype.getReplays=function(){var e=this;return new Promise((function(t){var n,i=null===(n=e.dataBase)||void 0===n?void 0:n.transaction([o.setting.dataBase.storeGamesName],"readonly");if(!i)throw Error("Data base not exist!");var s=i.objectStore(o.setting.dataBase.storeGamesName).openCursor(),r=[];s.onsuccess=function(){var e=s.result;e?(r.push(e.value),e.continue()):t(r)},s.onerror=function(){throw Error("Error with cursor request!")}}))},e}();t.DataBase=i},0:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0;var s=n(506);n(995);var r=function(e){function t(){var t=e.call(this,"footer",["footer"])||this;return t.element.innerHTML='\n    <div class="footer__container">\n      <a class="footer__link" href="https://github.com/Dauniusha">GitHub</a>\n      <span class="footer__text">RS School 2021</span>\n    </div>\n    ',t}return i(t,e),t}(s.BaseComponents);t.Footer=r},229:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,o,i,s,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var a=n(836),l=n(510),c=n(735),p=n(513),h=n(636),u=n(767),d=n(690),m=n(506),v=n(188),f=n(874),g=n(53),y=n(595),b=n(610);n(978);var w=function(e){function t(t,n){var o,i,s=e.call(this,"section",["game"])||this;return s.possibleCells=[],s.isWhiteMove=!0,s.isEndGame=!1,s.isDragAndDrop=!1,s.isSecondClick=!1,t?(o=s.replayPlayerInit(t.firstPlayer,t.secondPlayer),s.firstPlayer=o[0],s.secondPlayer=o[1],setTimeout((function(){s.addMoveHolder()}),200),s.chessBoard=new h.ChessBoard(y.setting.initialGameSetup),s.element.insertBefore(s.chessBoard.element,s.secondPlayer.element)):(i=s.playerInit(n),s.firstPlayer=i[0],s.secondPlayer=i[1],setTimeout((function(){s.addMoveHolder()}),200),s.chessBoard=new h.ChessBoard(y.setting.initialGameSetup),s.element.insertBefore(s.chessBoard.element,s.secondPlayer.element)),s}return i(t,e),t.prototype.playerInit=function(e){e||(e=l.colorFunctions.getRandomColor());var t=new f.PlayerStatistics({color:e,counter:0});this.element.appendChild(t.element);var n=l.colorFunctions.getReverseColor(e),o=new f.PlayerStatistics({color:n,counter:1});return this.element.appendChild(o.element),[t,o]},t.prototype.replayPlayerInit=function(e,t){var n=new f.PlayerStatistics(void 0,{player:e,counter:0});this.element.appendChild(n.element);var o=new f.PlayerStatistics(void 0,{player:t,counter:1});return this.element.appendChild(o.element),[n,o]},t.prototype.getChessBoard=function(){return this.chessBoard},t.prototype.dragAndDropListners=function(){var e=this;this.chessBoard.element.addEventListener("mousedown",(function(t){var n,o;e.isDragAndDrop=!1;var i=null===(n=t.target)||void 0===n?void 0:n.closest("."+y.setting.classNames.piece);i&&(i.ondragstart=function(){return!1});var s=null===(o=t.target)||void 0===o?void 0:o.closest("."+y.setting.classNames.cell);e.onMouseDown(i,s,t)}))},t.prototype.onMouseDown=function(e,t,n){var o,i,s,r,a,l=this,c=this.isWhiteMove?v.color.white:v.color.black;if(t&&((null===(o=n.target)||void 0===o?void 0:o.closest("."+y.setting.classNames.possibleClearCell))||(null===(i=n.target)||void 0===i?void 0:i.closest("."+y.setting.classNames.possibleEngagedCell))))return this.completeMove(t.id),document.onmousemove=null,void(this.isSecondClick=!1);e&&-1!==(null===(s=e.getAttribute(y.setting.classNames.dataPiece))||void 0===s?void 0:s.indexOf(c))?(t&&(null===(r=this.pieceActive)||void 0===r?void 0:r.cell)!==t.id?this.selectPiece(t.id):t&&(null===(a=this.pieceActive)||void 0===a?void 0:a.cell)===t.id&&(this.isSecondClick=!0),this.takeDragObj(e,n),e.onmouseup=function(n){l.clickOrDragDelegating(e,n,t)},document.onmousemove=function(e){l.onMouseMove(e)}):(this.possibleCellsBacklightRemove(),this.pieceActive=void 0,this.isSecondClick=!1)},t.prototype.takeDragObj=function(e,n){this.dragObj={object:e,shiftX:n.clientX-e.getBoundingClientRect().left,shiftY:n.clientY-e.getBoundingClientRect().top,currentDroppable:null},t.addDragStyles(e),this.moveAtCoordinates(n.pageX,n.pageY)},t.prototype.clickOrDragDelegating=function(e,n,o){var i;if(this.isDragAndDrop){var s=t.takeElementBelow(e,n);if(o&&this.removeDragStyles(e,o),(null==s?void 0:s.closest("."+y.setting.classNames.possibleClearCell))||(null==s?void 0:s.closest("."+y.setting.classNames.possibleEngagedCell)))return this.completeMove(s.id),this.isSecondClick=!1,document.onmousemove=null,void(e.onmouseup=null)}else o&&(this.removeDragStyles(e,o),(null===(i=this.pieceActive)||void 0===i?void 0:i.cell)===o.id&&this.isSecondClick&&(this.possibleCellsBacklightRemove(),this.isSecondClick=!1,this.pieceActive=void 0));document.onmousemove=null,e.onmouseup=null},t.prototype.onMouseMove=function(e){if(this.isDragAndDrop=!0,this.dragObj){var n=t.takeElementBelow(this.dragObj.object,e);if(!n)return;this.moveAtCoordinates(e.pageX,e.pageY);var o=n.closest("."+y.setting.classNames.cell);this.dragObj.currentDroppable!==o&&(this.dragObj.currentDroppable&&t.removeDragBacklights(this.dragObj.currentDroppable),this.dragObj.currentDroppable=o,this.dragObj.currentDroppable&&t.addDragBacklights(this.dragObj.currentDroppable))}},t.addDragStyles=function(e){e.classList.add("draging"),document.body.append(e)},t.prototype.removeDragStyles=function(e,t){t.appendChild(e),e.classList.remove("draging"),this.removeSelectCellsBacklights(),t.classList.add(y.setting.classNames.selectPieceBacklight)},t.takeElementBelow=function(e,t){e.hidden=!0;var n=document.elementFromPoint(t.clientX,t.clientY);return e.hidden=!1,n?n.closest("."+y.setting.classNames.cell):null},t.prototype.moveAtCoordinates=function(e,t){this.dragObj&&(this.dragObj.object.style.left=e-this.dragObj.shiftX+"px",this.dragObj.object.style.top=t-this.dragObj.shiftY+"px")},t.prototype.selectPiece=function(e){this.possibleCellsBacklightRemove(),this.pieceActive=this.chessBoard.selectPiece(e),this.possibleCellsBacklightAdd()},t.prototype.possibleCellsBacklightAdd=function(){var e,t,n,o=this,i=this.chessBoard.getAllCells();null===(t=null===(e=this.pieceActive)||void 0===e?void 0:e.element.parentElement)||void 0===t||t.classList.add(y.setting.classNames.selectPieceBacklight),null===(n=this.pieceActive)||void 0===n||n.possibleMoves.forEach((function(e){i.forEach((function(t){e===t.id&&(t.childElementCount?t.classList.add(y.setting.classNames.possibleEngagedCell):t.classList.add(y.setting.classNames.possibleClearCell),o.possibleCells.push(t))}))}))},t.prototype.possibleCellsBacklightRemove=function(){var e,t;null===(t=null===(e=this.pieceActive)||void 0===e?void 0:e.element.parentElement)||void 0===t||t.classList.remove(y.setting.classNames.selectPieceBacklight),this.possibleCells.forEach((function(e){e.classList.remove(y.setting.classNames.possibleClearCell),e.classList.remove(y.setting.classNames.possibleEngagedCell)})),this.possibleCells=[]},t.prototype.completeMove=function(e){if(this.pieceActive){var t=this.pieceActive.cell;this.pieceMove(e),this.pieceActive instanceof u.Pawn&&(-1!==this.pieceActive.cell.indexOf("8")||-1!==this.pieceActive.cell.indexOf("1"))?this.initPawnTransformation(this.pieceActive,t):(this.takeActivePlayer(t),this.removeCancelMoveAndCheckValidation(this.pieceActive.color))}},t.prototype.pieceMove=function(e){this.pieceActive&&(this.checkBacklightRemove(),this.moveBacklightRemove(),this.possibleCellsBacklightRemove(),this.moveBacklightAdd(e),this.chessBoard.pieceMove(e,this.pieceActive))},t.prototype.initPawnTransformation=function(e,n){var o=this,i=this.createChoosePiecePopup(e.color);i.showPopup(),i.element.addEventListener("click",(function(s){if(s.target instanceof HTMLImageElement){var r=e.color+s.target.alt;o.replaceTransormPiece(e,r),o.takeActivePlayer(n,r),t.removePopup(i),o.removeCancelMoveAndCheckValidation(e.color)}}))},t.prototype.replaceTransormPiece=function(e,t){for(var n=0;n<y.setting.gameSetup.length;n++)if(y.setting.gameSetup[n].cell===e.cell){y.setting.gameSetup[n].piece=t;break}var o=y.setting.createFunctions[t](e.cell);e.element.remove();var i=a.cellNameToCellPosition(e.cell);this.chessBoard.getAllCells()[i].appendChild(o.element),this.chessBoard.pieces.splice(this.chessBoard.pieces.indexOf(e),1,o)},t.prototype.removeCancelMoveAndCheckValidation=function(e){this.chessBoard.removeCloseMove(),this.checkMateValidation(e),this.pieceActive=void 0,this.isWhiteMove=!this.isWhiteMove,this.addMoveHolder()},t.prototype.takeActivePlayer=function(e,t){var n,o;if(!this.pieceActive)throw new Error("pieceActive does not exist!");this.activePlayer=this.pieceActive.color===(null===(n=this.firstPlayer)||void 0===n?void 0:n.getColor())?this.firstPlayer:this.secondPlayer,null===(o=this.activePlayer)||void 0===o||o.moveTable.addMove(this.pieceActive.name,this.activePlayer.getColor(),e,this.pieceActive.cell,p.timeFunctions.getStringTime(b.timer.getTimeNow()),t,y.setting.gameSetup)},t.prototype.moveBacklightAdd=function(e){var t=this;this.chessBoard.getAllCells().forEach((function(n){var o;(null===(o=t.pieceActive)||void 0===o?void 0:o.cell)!==n.id&&e!==n.id||n.classList.add(y.setting.classNames.moveBacklight)}))},t.prototype.moveBacklightRemove=function(){this.chessBoard.getAllCells().forEach((function(e){e.classList.contains(y.setting.classNames.moveBacklight)&&e.classList.remove(y.setting.classNames.moveBacklight)}))},t.addDragBacklights=function(e){e.classList.add(y.setting.classNames.selectPieceBacklight)},t.removeDragBacklights=function(e){e.classList.remove(y.setting.classNames.selectPieceBacklight)},t.prototype.removeSelectCellsBacklights=function(){this.chessBoard.getAllCells().forEach((function(e){e.classList.remove(y.setting.classNames.selectPieceBacklight)}))},t.prototype.checkMateValidation=function(e){var t=this.chessBoard.checkValidation(e),n=this.chessBoard.movePossibilityValidation(e);t&&!n?(this.checkBacklightAdd(),this.createEndGame(!0,this.activePlayer),this.isEndGame=!0):t?(this.checkBacklightAdd(),console.log("check")):n||(this.createEndGame(!1),this.isEndGame=!0),2===this.chessBoard.pieces.length&&(this.createEndGame(!1),this.isEndGame=!0)},t.prototype.createEndGame=function(e,t){b.timer.stopTimer(),e&&t?(this.createWinPopup(t.getName()),this.createReplay(t.getPlayer().getNameWithAvatar())):(this.createDrawPopup(),this.createReplay(null))},t.prototype.createReplay=function(e){var t,n;if(this.firstPlayer&&this.secondPlayer&&this.activePlayer){var o=null===(t=this.firstPlayer)||void 0===t?void 0:t.getPlayerWithMoves(),i=null===(n=this.secondPlayer)||void 0===n?void 0:n.getPlayerWithMoves(),s=o.moves.length+i.moves.length;d.storage.addReplay(o,i,e,s,p.timeFunctions.getStringTime(b.timer.getTimeNow()))}},t.prototype.createWinPopup=function(e){this.createPopup(e+" won!")},t.prototype.createDrawPopup=function(){this.createPopup("Draw!")},t.prototype.createPopup=function(e){var n,o=new g.Popup;o.btnsInit(),o.text.innerHTML=e,null===(n=this.element.parentElement)||void 0===n||n.appendChild(o.element),o.showPopup(),o.element.addEventListener("click",(function(){t.removePopup(o)}),{once:!0})},t.createConfirmDrawPopup=function(){var e=new g.Popup;return e.element.id="confirm-popup",e.text.innerHTML="The opponent offers a draw",e},t.prototype.checkBacklightAdd=function(e){var t;void 0===e&&(e=null===(t=this.pieceActive)||void 0===t?void 0:t.color),e&&(this.checkPieces=this.chessBoard.getCheckPieces(e),this.checkPieces.forEach((function(e){var t;null===(t=e.element.parentElement)||void 0===t||t.classList.add(y.setting.classNames.checkBacklight)})))},t.prototype.checkBacklightRemove=function(){this.checkPieces&&this.checkPieces.forEach((function(e){var t;null===(t=e.element.parentElement)||void 0===t||t.classList.remove(y.setting.classNames.checkBacklight)}))},t.prototype.checkRotateChessBoard=function(){y.setting.isTwoPlayersOffline&&this.rotateChessBoard()},t.prototype.rotateChessBoard=function(){this.chessBoard.element.classList.toggle(y.setting.classNames.game.rotate),this.chessBoard.element.classList.toggle(y.setting.classNames.game.noRotate)},t.prototype.addMoveHolder=function(){var e,t,n=(null===(e=this.firstPlayer)||void 0===e?void 0:e.getColor())===v.color.white?this.firstPlayer:this.secondPlayer,o=(null===(t=this.firstPlayer)||void 0===t?void 0:t.getColor())===v.color.black?this.firstPlayer:this.secondPlayer;this.isWhiteMove?(null==n||n.getPlayer().getAvatar().classList.add(y.setting.classNames.game.playerActive),null==o||o.getPlayer().getAvatar().classList.remove(y.setting.classNames.game.playerActive)):(null==n||n.getPlayer().getAvatar().classList.remove(y.setting.classNames.game.playerActive),null==o||o.getPlayer().getAvatar().classList.add(y.setting.classNames.game.playerActive))},t.prototype.getPlayerStatistics=function(){if(this.firstPlayer&&this.secondPlayer)return{firstPlayer:this.firstPlayer,secondPlayer:this.secondPlayer};throw new Error("Players does not exist!")},t.prototype.surrender=function(){var e,t,n=(null===(e=this.firstPlayer)||void 0===e?void 0:e.getColor())===v.color.white?this.firstPlayer:this.secondPlayer,o=(null===(t=this.firstPlayer)||void 0===t?void 0:t.getColor())===v.color.black?this.firstPlayer:this.secondPlayer;this.isWhiteMove?this.createEndGame(!0,o):this.createEndGame(!0,n),this.isEndGame=!0},t.prototype.draw=function(){var e,n=this,o=t.createConfirmDrawPopup();o.confirmPopupBtns(),null===(e=this.element.parentElement)||void 0===e||e.appendChild(o.element),o.showPopup(),o.element.addEventListener("click",(function(e){return s(n,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,o.closePopup()];case 1:return t.sent(),o.element.remove(),e.target.classList.contains(y.setting.classNames.popups.popupLobbyBtn)&&(this.createEndGame(!1),this.isEndGame=!0),[2]}}))}))}),{once:!0})},t.prototype.createChoosePiecePopup=function(e){var t,n=new g.Popup;n.text.innerHTML="Choose new piece";var o=c.createElement(["choose-piece"]);return o.innerHTML='\n    <img class="choose-piece__each" src="./chess/'+e+'-queen.svg" alt="Queen">\n    <img class="choose-piece__each" src="./chess/'+e+'-rook.svg" alt="Rook">\n    <img class="choose-piece__each" src="./chess/'+e+'-knight.svg" alt="Knight">\n    <img class="choose-piece__each" src="./chess/'+e+'-bishop.svg" alt="Bishop">\n    ',n.element.appendChild(o),null===(t=this.element.parentElement)||void 0===t||t.appendChild(n.element),n},t.removePopup=function(e){return s(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,e.closePopup()];case 1:return t.sent(),e.element.remove(),[2]}}))}))},t}(m.BaseComponents);t.Game=w},977:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;var s=n(735),r=n(506),a=n(595);n(115);var l=function(e){function t(){var t=e.call(this,"header",[a.setting.classNames.headers.header])||this;return t.container=document.createElement("div"),t.container.classList.add(a.setting.classNames.headers.container),t.element.appendChild(t.container),t.addLogo(),t}return i(t,e),t.prototype.addLogo=function(){var e=document.createElement("div");e.classList.add(a.setting.classNames.headers.logo),e.innerHTML='\n      <img class="'+a.setting.classNames.headers.logoImg+'" src="../../../logo/logo.svg">\n      <a href="#/Lobby" class="'+a.setting.classNames.headers.logoText+'">Chess</a>\n    ',this.container.appendChild(e)},t.prototype.createReplayBtns=function(){var e=this.createReplayMoveBtns(),t=this.createReplayBoostModeBtns();return this.createExitBtn(),{moveBtns:e,boostBtns:t}},t.prototype.createReplayMoveBtns=function(){var e=s.createElement([a.setting.classNames.headers.replaysMoveBtns]),t=s.createElement([a.setting.classNames.headers.replaysMoveBtn,a.setting.classNames.disable]);t.style.backgroundImage="url("+a.setting.imgNames.leftArrow+")",e.appendChild(t);var n=s.createElement([a.setting.classNames.headers.replaysMoveBtn]);n.style.backgroundImage="url("+a.setting.imgNames.pause+")",n.id="stop-btn",e.appendChild(n);var o=s.createElement([a.setting.classNames.headers.replaysMoveBtn]);return o.style.backgroundImage="url("+a.setting.imgNames.rightArrow+")",e.appendChild(o),this.container.appendChild(e),{prevBtn:t,stopBtn:n,nextBtn:o}},t.prototype.createReplayBoostModeBtns=function(){for(var e=s.createElement([a.setting.classNames.headers.replaysBoostBtns]),t=[],n=0;n<a.setting.boostBtnsAmount;n++){var o=s.createElement([a.setting.classNames.headers.replaysBoostBtn]);o.id=String(n+1),o.innerHTML="x"+(n+1),e.appendChild(o),t.push(o)}return this.container.appendChild(e),t},t.prototype.createExitBtn=function(){var e=document.createElement("a");return e.classList.add(a.setting.classNames.headers.replaysExitBtn),e.href="#/Replays",e.style.backgroundImage="url("+a.setting.imgNames.exit+")",this.container.appendChild(e),e},t.prototype.createSurrenderAndDrawBtns=function(){var e=s.createElement([a.setting.classNames.headers.gameBtnsContainer]);return this.surrenderBtn=s.createElement([a.setting.classNames.headers.gameBtn]),this.surrenderBtn.innerHTML="surrender",this.surrenderBtn.id="surrender",e.appendChild(this.surrenderBtn),this.drawBtn=s.createElement([a.setting.classNames.headers.gameBtn]),this.drawBtn.innerHTML="offer a draw",this.drawBtn.id="draw",e.appendChild(this.drawBtn),this.container.appendChild(e),{surrenderBtn:this.surrenderBtn,drawBtn:this.drawBtn}},t.prototype.removeAllBtns=function(){this.container.innerHTML="",this.addLogo()},t.prototype.getContainer=function(){return this.container},t}(r.BaseComponents);t.Header=l},381:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Lobby=void 0;var s=n(735),r=n(690),a=n(506),l=n(559),c=n(595);n(906);var p=function(e){function t(){var n,o=e.call(this,"section",[c.setting.classNames.lobby.lobby])||this;o.container=s.createElement([c.setting.classNames.lobby.container]),o.element.appendChild(o.container);var i=o.playerBlockInit();o.playerFirst=new l.Player({writable:!0,counter:0}),o.replaysBtn=t.replaysBtnInit(),i.appendChild(o.playerFirst.element),i.appendChild(o.replaysBtn),n=t.startBtnAndSwicherInit(),o.startGameBtn=n[0],o.startTextElement=n[1],o.gameSwitcherBtn=n[2],o.container.appendChild(o.startGameBtn),o.initStartListner(),o.initToogleListner();var r=o.playerBlockInit();return o.playerSecond=new l.Player({writable:!0,counter:1}),o.settingBtn=t.settingBtnInit(),r.appendChild(o.playerSecond.element),r.appendChild(o.settingBtn),o}return i(t,e),t.prototype.playerBlockInit=function(){var e=document.createElement("div");return e.classList.add("player-menu"),this.container.appendChild(e),e},t.replaysBtnInit=function(){var e=document.createElement("a");return e.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.replay),e.href="#/Replays",e.innerHTML='\n      <p class="'+c.setting.classNames.lobby.menu.replayText+'">View replays</p>\n      <img class="'+c.setting.classNames.lobby.menu.replayImg+'" src="./lobby/replays/play-button.svg" alt="play">\n    ',e},t.settingBtnInit=function(){var e=document.createElement("a");return e.href="#/Setting",e.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.setting),e.innerHTML='\n      <img class="'+c.setting.classNames.lobby.menu.settingImg+'" src="./lobby/setting/settings.svg" alt="setting">\n    ',e},t.startBtnAndSwicherInit=function(){var e=s.createElement([c.setting.classNames.lobby.menu.start]),t=document.createElement("a");t.href="#/Game",t.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.startText),t.innerHTML="Start";var n=document.createElement("div");return n.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.gameMode),n.dataset.mode="online",n.innerHTML='\n      <div class="game-mode__text" id="online">Online</div>\n      <div class="game-mode__text" id="offline">Offline</div>\n    ',e.appendChild(t),e.appendChild(n),[e,t,n]},t.prototype.initToogleListner=function(){var e=this;this.gameSwitcherBtn.addEventListener("click",(function(){var t="online";"online"===e.gameSwitcherBtn.dataset.mode&&(e.resetOnlineSearch(),e.hideLoadingScreen(),t="offline"),e.startGameBtn.dataset.mode="start-"+t,e.gameSwitcherBtn.dataset.mode=t}))},t.prototype.initStartListner=function(){var e=this;this.startTextElement.addEventListener("click",(function(t){"online"===e.gameSwitcherBtn.dataset.mode?(t.preventDefault(),e.blockBtns(),e.showLoadingOrConnectingScreen("connecting"),e.initSocket()):(r.storage.addPlayer(e.playerFirst.getNameWithAvatar(),0),r.storage.addPlayer(e.playerSecond.getNameWithAvatar(),1))}))},t.prototype.initSocket=function(){var e=this;this.socket=new WebSocket(c.setting.serverURL),this.socket.addEventListener("open",(function(){e.socket&&e.socket.addEventListener("message",(function(t){e.newMessage(t.data)}))}))},t.prototype.newMessage=function(e){var t,n;switch(console.log(e),e){case"loading":this.showLoadingOrConnectingScreen("loading");break;case"connected":null===(t=this.socket)||void 0===t||t.send("name "+this.playerFirst.getName()),null===(n=this.socket)||void 0===n||n.send("avatar "+this.playerFirst.getAvatarURL());break;case"white":case"black":this.color=e;break;default:var o=e.split(" ");switch(o[0]){case"name":this.playerSecond.setName(o.splice(1).join(" "));break;case"avatar":this.playerSecond.setAvatar(o[1]),r.storage.addPlayer(this.playerFirst.getNameWithAvatar(),0,this.color),r.storage.addPlayer(this.playerSecond.getNameWithAvatar(),1),this.hideLoadingScreen(),this.removeBlockBtns(),window.location.hash="#/Game"}}},t.prototype.showLoadingOrConnectingScreen=function(e){this.hideLoadingScreen(),this.loadingElement=s.createElement([c.setting.classNames.lobby.menu.menu,"loading"]),this.loadingElement.innerHTML=' \n    <p class="loading__text">'+e+'</p>\n    <div class="lds-ellipsis">\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n    ',this.playerSecond.element.appendChild(this.loadingElement)},t.prototype.resetOnlineSearch=function(){this.hideLoadingScreen(),this.removeBlockBtns(),this.resetColorAndSocket()},t.prototype.hideLoadingScreen=function(){var e;null===(e=this.loadingElement)||void 0===e||e.remove(),this.loadingElement=void 0},t.prototype.resetColorAndSocket=function(){var e;this.color=void 0,null===(e=this.socket)||void 0===e||e.close(),this.socket=void 0},t.prototype.blockBtns=function(){this.startTextElement.classList.add(c.setting.classNames.disable),this.playerSecond.getAvatar().classList.add(c.setting.classNames.disable),this.playerSecond.getNameElement().classList.add(c.setting.classNames.disable)},t.prototype.removeBlockBtns=function(){this.startTextElement.classList.remove(c.setting.classNames.disable),this.playerSecond.getAvatar().classList.remove(c.setting.classNames.disable),this.playerSecond.getNameElement().classList.remove(c.setting.classNames.disable)},t}(a.BaseComponents);t.Lobby=p},506:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponents=void 0;t.BaseComponents=function(e,t){var n;void 0===e&&(e="div"),void 0===t&&(t=[]),this.element=document.createElement(e),(n=this.element.classList).add.apply(n,t)}},188:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.color=void 0,t.color={white:"white",black:"black"}},152:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.MoveTable=void 0;var s=n(506),r=n(467),a=n(595);n(801);var l=function(e){function t(){var t=e.call(this,"div",[a.setting.classNames.game.playerMoveTable])||this;return t.fullPieceName=[],t}return i(t,e),t.prototype.addMove=function(e,t,n,o,i,s,a){var l=t+e,c=new r.Move(l,n,o,i,s,a);this.fullPieceName.push(c),this.element.appendChild(c.element)},t.prototype.moveInit=function(e){var t=this;e.forEach((function(e){var n=new r.Move(e.fullName,e.startCell,e.endCell,e.time,e.newPiece);t.fullPieceName.push(n),t.element.appendChild(n.element)}))},t.prototype.takeMove=function(e){if(e>=0&&e<this.fullPieceName.length)return this.fullPieceName[e];throw new Error("Invalid range!")},t.prototype.getAllMoves=function(){var e=[];return this.fullPieceName.forEach((function(t){e.push(t.getClearMove())})),e},t.prototype.getAllMovesElement=function(){return this.fullPieceName},t}(s.BaseComponents);t.MoveTable=l},467:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Move=void 0;var s=n(735),r=n(506),a=n(595);n(457);var l=function(e){function t(t,n,o,i,r,l){var c=e.call(this,"div",[a.setting.classNames.game.playerMoveTableEach])||this;c.fullName=t,c.startCell=n,c.endCell=o,c.time=i,c.newPiece=r,c.setup=l;var p=s.createElement([a.setting.classNames.game.playerMoveTableImg]);p.style.backgroundImage="url("+a.setting.imgNames[c.fullName]+")";var h=s.createElement([a.setting.classNames.game.playerMoveTableCells]);h.innerHTML=c.startCell+" - "+c.endCell;var u=s.createElement([a.setting.classNames.game.playerMoveTableTime]);return u.innerHTML=c.time,c.element.appendChild(p),c.element.appendChild(h),c.element.appendChild(u),c}return i(t,e),t.prototype.getClearMove=function(){return{fullName:this.fullName,startCell:this.startCell,endCell:this.endCell,time:this.time,newPiece:this.newPiece}},t.prototype.getSetup=function(){if(this.setup)return this.setup;throw new Error("Setup does not exist!")},t.prototype.setSetup=function(e){this.setup=e},t}(r.BaseComponents);t.Move=l},456:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,o,i,s,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineGame=void 0;var a=n(229),l=n(771),c=n(188),p=n(595),h=n(767),u=function(e){function t(t,n){var o=e.call(this,void 0,t)||this;return o.socket=n,"black"===t&&o.rotateChessBoard(),o.color=t,o.initListner(),o.makeMoveAndSendData(),o}return i(t,e),t.prototype.initListner=function(){var e=this;this.socket.addEventListener("message",(function(t){switch(t.data){case"draw":e.confirmDrawPopup();break;case"confirm draw":e.createEndGame(!1),e.isEndGame=!0;break;case"refuse draw":break;case"surrender":e.createEndGame(!0,e.firstPlayer),e.isEndGame=!0;break;case"Bishop":case"Rook":case"Queen":case"Knight":e.transformPieceFromMessage(t.data);break;default:e.makeEnemyOnlineMove(t.data)}})),this.socket.addEventListener("close",(function(){e.isEndGame||(e.createEndGame(!0,e.secondPlayer),e.isEndGame=!0)}))},t.prototype.confirmDrawPopup=function(){var e,t=this,n=a.Game.createConfirmDrawPopup();n.confirmPopupBtns(),null===(e=this.element.parentElement)||void 0===e||e.appendChild(n.element),n.showPopup(),n.element.addEventListener("click",(function(e){return s(t,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,n.closePopup()];case 1:return t.sent(),n.element.remove(),e.target.classList.contains(p.setting.classNames.popups.popupLobbyBtn)?(this.socket.send("confirm draw"),this.createEndGame(!1),this.isEndGame=!0):this.socket.send("refuse draw"),[2]}}))}))}),{once:!0})},t.prototype.transformPieceFromMessage=function(e){for(var t=0;t<this.chessBoard.pieces.length;t++){var n=this.chessBoard.pieces[t];if(n instanceof h.Pawn&&(-1!==n.cell.indexOf("8")||-1!==n.cell.indexOf("1"))){this.pieceActive=n;var o=n.color+e;return this.replaceTransormPiece(n,o),this.chessBoard.removeCloseMove(),this.checkMateValidation(n.color),void(this.pieceActive=void 0)}}},t.prototype.makeEnemyOnlineMove=function(e){if("disconnected"!==e){var t=l.MessageReader.readMessage(e),n=t[0],o=t[1];this.pieceActive=this.chessBoard.selectPiece(n),this.pieceMove(o),this.removeCancelMoveAndCheckValidation(this.pieceActive.color)}else this.isEndGame||(this.createEndGame(!0,this.firstPlayer),this.isEndGame=!0)},t.prototype.makeOnlineCompleteMove=function(e){this.pieceActive&&(this.socket.send(l.MessageReader.writeMessage(this.pieceActive.cell,e)),this.pieceMove(e),this.pieceActive instanceof h.Pawn&&(-1!==this.pieceActive.cell.indexOf("8")||-1!==this.pieceActive.cell.indexOf("1"))?this.initOnlinePawnTransformation(this.pieceActive):this.removeCancelMoveAndCheckValidation(this.pieceActive.color))},t.prototype.initOnlinePawnTransformation=function(e){var t=this,n=this.createChoosePiecePopup(e.color);n.showPopup(),n.element.addEventListener("click",(function(o){if(o.target instanceof HTMLImageElement){var i=o.target.alt,s=e.color+i;t.socket.send(i),t.replaceTransormPiece(e,s),a.Game.removePopup(n),t.removeCancelMoveAndCheckValidation(e.color)}}))},t.prototype.makeMoveAndSendData=function(){var e=this;this.chessBoard.element.addEventListener("mousedown",(function(t){var n,o;e.isDragAndDrop=!1;var i=null===(n=t.target)||void 0===n?void 0:n.closest("."+p.setting.classNames.piece);i&&(i.ondragstart=function(){return!1});var s=null===(o=t.target)||void 0===o?void 0:o.closest("."+p.setting.classNames.cell);e.onMouseDownSendData(i,s,t)}))},t.prototype.onMouseDownSendData=function(e,t,n){var o,i,s,r,a,l=this,h=this.isWhiteMove?c.color.white:c.color.black;if(t&&((null===(o=n.target)||void 0===o?void 0:o.closest("."+p.setting.classNames.possibleClearCell))||(null===(i=n.target)||void 0===i?void 0:i.closest("."+p.setting.classNames.possibleEngagedCell))))return this.makeOnlineCompleteMove(t.id),document.onmousemove=null,void(this.isSecondClick=!1);e&&-1!==(null===(s=e.getAttribute(p.setting.classNames.dataPiece))||void 0===s?void 0:s.indexOf(h))&&h===this.color?(t&&(null===(r=this.pieceActive)||void 0===r?void 0:r.cell)!==t.id?this.selectPiece(t.id):t&&(null===(a=this.pieceActive)||void 0===a?void 0:a.cell)===t.id&&(this.isSecondClick=!0),this.takeDragObj(e,n),e.onmouseup=function(n){l.clickOrDragDelegatingSendData(e,n,t)},document.onmousemove=function(e){l.onMouseMove(e)}):(this.possibleCellsBacklightRemove(),this.pieceActive=void 0,this.isSecondClick=!1)},t.prototype.clickOrDragDelegatingSendData=function(e,t,n){var o;if(this.isDragAndDrop){var i=a.Game.takeElementBelow(e,t);if(n&&this.removeDragStyles(e,n),(null==i?void 0:i.closest("."+p.setting.classNames.possibleClearCell))||(null==i?void 0:i.closest("."+p.setting.classNames.possibleEngagedCell)))return this.makeOnlineCompleteMove(i.id),this.isSecondClick=!1,document.onmousemove=null,void(e.onmouseup=null)}else n&&(console.log(p.setting.gameSetup),this.removeDragStyles(e,n),(null===(o=this.pieceActive)||void 0===o?void 0:o.cell)===n.id&&this.isSecondClick&&(this.possibleCellsBacklightRemove(),this.isSecondClick=!1,this.pieceActive=void 0));document.onmousemove=null,e.onmouseup=null},t.prototype.surrenderBtnEvent=function(){this.socket.send("surrender"),this.createEndGame(!0,this.secondPlayer),this.isEndGame=!0},t.prototype.drawBtnEvent=function(){this.socket.send("draw")},t.prototype.offSocket=function(){this.socket.close()},t}(a.Game);t.OnlineGame=u},874:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerStatistics=void 0;var s=n(506),r=n(152),a=n(559),l=n(595);n(94);var c=function(e){function t(t,n){var o=e.call(this,"div",[l.setting.classNames.game.playerStatistics])||this;if(t)o.color=t.color,o.player=new a.Player({writable:!1,counter:t.counter}),o.moveTable=new r.MoveTable;else{if(!n)throw new Error("All parametr is invalid!");o.color=n.player.color,o.player=new a.Player(void 0,{avatarURL:n.player.player.avatarURL,name:n.player.player.name}),o.moveTable=new r.MoveTable,o.moveTable.moveInit(n.player.moves)}return o.element.appendChild(o.player.element),o.element.appendChild(o.moveTable.element),o}return i(t,e),t.prototype.getColor=function(){return this.color},t.prototype.getName=function(){return this.player.getName()},t.prototype.getPlayer=function(){return this.player},t.prototype.getPlayerWithMoves=function(){return{player:this.player.getNameWithAvatar(),moves:this.moveTable.getAllMoves(),color:this.color}},t}(s.BaseComponents);t.PlayerStatistics=c},559:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,o,i,s,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;var a=n(690),l=n(506),c=n(595),p=function(e){function t(t,n){var o=e.call(this,"div",[c.setting.classNames.player.player])||this;return t?t.writable?o.playerInit(t.counter):o.getPlayer(t.counter):n&&o.createClearPlayer(n.avatarURL,n.name),o}return i(t,e),t.prototype.playerInit=function(e){return s(this,void 0,void 0,(function(){var t,n,o,i;return r(this,(function(s){switch(s.label){case 0:return[4,a.storage.getPlayers()];case 1:return t=s.sent(),i=t[e]?[t[e].avatarURL,t[e].name]:[c.setting.playersInitStates.playerImgURL,c.setting.playersInitStates.players[e]],this.avatarURL=i[0],this.name=i[1],(n=document.createElement("input")).type="file",n.classList.add(c.setting.classNames.player.avatar),n.style.backgroundImage="url("+this.avatarURL+")",this.avatar=n,this.element.appendChild(n),this.upload(n),(o=document.createElement("input")).classList.add(c.setting.classNames.player.name),o.type="text",o.value=this.name,this.nameElement=o,this.element.appendChild(o),this.input(o),[2]}}))}))},t.prototype.getPlayer=function(e){return s(this,void 0,void 0,(function(){var t,n;return r(this,(function(o){switch(o.label){case 0:return[4,a.storage.getPlayers()];case 1:return t=o.sent(),n=t[e]?[t[e].avatarURL,t[e].name]:[c.setting.playersInitStates.playerImgURL,c.setting.playersInitStates.players[e]],this.avatarURL=n[0],this.name=n[1],this.createClearPlayer(this.avatarURL,this.name),[2]}}))}))},t.prototype.createClearPlayer=function(e,t){var n=document.createElement("div");n.classList.add(c.setting.classNames.player.gameAvatar),e!==c.setting.playersInitStates.playerImgURL?n.style.backgroundImage="url("+e+")":n.innerHTML=t[0],this.avatar=n,this.element.appendChild(n);var o=document.createElement("div");o.classList.add(c.setting.classNames.player.name),o.innerHTML=t,this.nameElement=o,this.element.appendChild(o)},t.prototype.upload=function(e){var t=this;e.addEventListener("change",(function(){var n=new FileReader;if(!e.files)throw Error("Files for avatar does not exist!");var o=e.files[0];n.readAsDataURL(o),n.onload=function(){t.avatarURL=n.result,e.style.background="url("+n.result+") center no-repeat",e.style.backgroundSize="cover"}}))},t.prototype.input=function(e){var t=this;e.addEventListener("input",(function(){t.name=e.value}))},t.prototype.getName=function(){if(this.name)return this.name;throw new Error("Name does not exist!")},t.prototype.getNameElement=function(){if(this.nameElement)return this.nameElement;throw new Error("Name element does not exist!")},t.prototype.getNameWithAvatar=function(){if(this.avatarURL&&this.name)return{avatarURL:this.avatarURL,name:this.name};throw new Error("Name or avatar does not exist!")},t.prototype.getAvatar=function(){if(this.avatar)return this.avatar;throw new Error("Avatar does not exist!")},t.prototype.getAvatarURL=function(){if(this.avatarURL)return this.avatarURL;throw new Error("Avatar URL does not exist!")},t.prototype.setAvatar=function(e){this.avatarURL=e,this.avatar&&(this.avatar.style.backgroundImage="url("+e+")")},t.prototype.setName=function(e){this.name=e,this.nameElement&&(this.nameElement instanceof HTMLInputElement?this.nameElement.value=e:this.nameElement.innerHTML=e)},t}(l.BaseComponents);t.Player=p},53:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;var s=n(735),r=n(506),a=n(595);n(786);var l=function(e){function t(){var t=e.call(this,"div",["popup",a.setting.classNames.popups.closeClass])||this,n=new r.BaseComponents("div",["popup__inner"]);return t.popUp=new r.BaseComponents("div",["popup__container"]),n.element.appendChild(t.popUp.element),t.text=t.popupTextInit(),t.element.appendChild(n.element),t}return i(t,e),t.prototype.showPopup=function(){this.element.classList.remove(a.setting.classNames.popups.closeClass)},t.prototype.closePopup=function(){var e=this;return new Promise((function(t){e.element.classList.add(a.setting.classNames.popups.closeClass),e.element.addEventListener("transitionend",(function(){return t()}))}))},t.prototype.btnsInit=function(){var e=document.createElement("a");e.innerHTML="To lobby",e.href="#/Lobby",e.classList.add(a.setting.classNames.popups.popupLobbyBtn),this.popUp.element.appendChild(e);var t=document.createElement("a");t.innerHTML="Watch replay",t.href="#/Replays",t.classList.add(a.setting.classNames.popups.popupReplaysBtn),this.popUp.element.appendChild(t)},t.prototype.popupTextInit=function(){var e=document.createElement("p");return e.classList.add(a.setting.classNames.popups.popupText),this.popUp.element.appendChild(e),e},t.prototype.confirmPopupBtns=function(){var e=s.createElement([a.setting.classNames.popups.popupLobbyBtn]);e.id="confirm",e.innerHTML="Confirm",this.popUp.element.appendChild(e);var t=s.createElement([a.setting.classNames.popups.popupReplaysBtn]);return t.id="refuse",t.innerHTML="Refuse",this.popUp.element.appendChild(t),[e,t]},t}(r.BaseComponents);t.Popup=l},433:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Replay=void 0;var s=n(735),r=n(506),a=n(595);n(729);var l=function(e){function t(n,o){var i=e.call(this,"a",[a.setting.classNames.replays.replaysEach])||this;i.element.href="#/Replays/Watch-replay/"+o,i.element.title="Watch replay";var s=t.createReplayPieceElement(n.firstPlayer);i.element.appendChild(s);var r=t.addCrossImg();i.element.appendChild(r);var l=t.createReplayPieceElement(n.secondPlayer);i.element.appendChild(l);var c=t.createTimerElement(n.time);return i.element.appendChild(c),t.createCrownElement(n,s,l),i}return i(t,e),t.createReplayPieceElement=function(e){var n=s.createElement([a.setting.classNames.replays.replaysEachContainer]),o=t.createPieceProtoElement(e.color);n.appendChild(o);var i=s.createElement([a.setting.classNames.replays.playerContainer]);n.appendChild(i);var r=s.createElement([a.setting.classNames.replays.avatar]);e.player.avatarURL===a.setting.playersInitStates.playerImgURL?r.innerHTML=e.player.name[0]:r.style.backgroundImage="url("+e.player.avatarURL+")";var l=s.createElement([a.setting.classNames.replays.name]);return l.innerHTML=e.player.name,i.appendChild(r),i.appendChild(l),n},t.createPieceProtoElement=function(e){var t=e+"Pawn",n=s.createElement([a.setting.classNames.replays.piecePrototype]);return n.style.backgroundImage="url("+a.setting.imgNames[t]+")",n},t.createTimerElement=function(e){var t=s.createElement([a.setting.classNames.replays.time]);return t.innerHTML=e,t},t.createCrownElement=function(e,t,n){var o=s.createElement([a.setting.classNames.replays.crown]);if(e.winner)o.style.backgroundImage="url("+a.setting.imgNames.crown+")",(JSON.stringify(e.firstPlayer.player)===JSON.stringify(e.winner)?t:n).appendChild(o);else{o.style.backgroundImage="url("+a.setting.imgNames.draw+")",n.appendChild(o);var i=s.createElement([a.setting.classNames.replays.crown]);i.style.backgroundImage="url("+a.setting.imgNames.draw+")",t.appendChild(i)}},t.addCrossImg=function(){var e=s.createElement([a.setting.classNames.replays.cross]);return e.style.backgroundImage="url("+a.setting.imgNames.cross+")",e},t}(r.BaseComponents);t.Replay=l},561:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((o=o.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,o,i,s,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Replays=void 0;var a=n(735),l=n(690),c=n(506),p=n(433),h=n(595);n(241);var u=function(e){function t(){var t=e.call(this,"section",[h.setting.classNames.replays.replays])||this;return t.replays=[],t.container=a.createElement([h.setting.classNames.replays.replaysContainer]),t.element.appendChild(t.container),t.replaysInit(),t}return i(t,e),t.prototype.replaysInit=function(){return s(this,void 0,void 0,(function(){var e,t,n=this;return r(this,(function(o){switch(o.label){case 0:return[4,l.storage.getReplays()];case 1:return e=o.sent(),t=0,e.forEach((function(e){var o=new p.Replay(e,t++);n.replays.push(o),n.container.appendChild(o.element)})),[2]}}))}))},t}(c.BaseComponents);t.Replays=u},649:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;var o=n(595),i=function(){function e(){this.routes=[]}return e.prototype.add=function(e){this.routes.push(e)},e.prototype.newRoute=function(e){this.enumiration(e)},e.prototype.changeRoute=function(){var e=window.location.hash;e?this.enumiration(e):this.enumiration(o.setting.startPage)},e.prototype.enumiration=function(e){for(var t=0;t<this.routes.length;t++)if(-1!==e.indexOf(this.routes[t].hash)){this.routes[t].needFoo();break}},e}();t.Router=i},595:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setting=void 0;var o=n(91),i=n(443),s=n(822),r=n(767),a=n(336),l=n(278),c=n(188);t.setting={classNames:{board:"chess-board",cell:"cell",whiteCell:"white-cell",blackCell:"black-cell",numerationAll:"cell-numeration",numerationEach:"cell-nnumeration__each",letterId:"letter",numberId:"number",piece:"piece",dataPiece:"piece-type",possibleClearCell:"possible-clear-ceil",possibleEngagedCell:"possible-engaged-ceil",moveBacklight:"move-backlight",checkBacklight:"check-backlight",selectPieceBacklight:"select-piece-backlight",headers:{header:"header",container:"header__container",logo:"header-logo",logoImg:"header-logo__img",logoText:"header-logo__text",gameBtnsContainer:"header-game-btns",gameBtn:"header-game-btns__each",timer:{timer:"timer",timerEach:"timer__inner",timerColon:"timer__colon"},replaysMoveBtns:"header-btns",replaysMoveBtn:"header-btns__each",replaysBoostBtn:"replays__boost-btn",replaysBoostBtns:"replays__boost-btns",replaysExitBtn:"replays__exit-btn",replaysPlay:"replays__play"},lobby:{lobby:"lobby",container:"lobby__container",menu:{menu:"menu",replay:"menu-replay",replayText:"menu-replay__text",replayImg:"menu-replay__img",setting:"menu-setting",settingImg:"menu-setting__inner",start:"menu-start",startText:"menu-start__text",gameMode:"game-mode"}},player:{player:"player",avatar:"player__avatar",gameAvatar:"player__game-avatar",name:"player__name"},game:{playerStatistics:"player-statistics",playerMoveTable:"player-statistics__table",playerMoveTableEach:"player-statistics__table-each",playerMoveTableImg:"player-statistics__table-img",playerMoveTableCells:"player-statistics__table-cells",playerMoveTableTime:"player-statistics__table-time",rotate:"rotating",noRotate:"rotated",playerActive:"player-active"},popups:{closeClass:"popup_close",popupReplaysBtn:"popup__replays-btn",popupLobbyBtn:"popup__lobby-btn",popupText:"popup__text"},replays:{replays:"replays",replaysContainer:"replays__container",replaysEach:"replays__each",replaysEachContainer:"replays__each-container",piecePrototype:"replays__piece-prototype",avatar:"replays__avatar",name:"replays__name",time:"replays__time",crown:"replays__crown",cross:"replays__cross",playerContainer:"replays__player-container",activeMove:"replays__active-move"},disable:"disable",enable:"enable"},initialGameSetup:[{cell:"a8",piece:"blackRook"},{cell:"b8",piece:"blackKnight"},{cell:"c8",piece:"blackBishop"},{cell:"d8",piece:"blackQueen"},{cell:"e8",piece:"blackKing"},{cell:"f8",piece:"blackBishop"},{cell:"g8",piece:"blackKnight"},{cell:"h8",piece:"blackRook"},{cell:"a7",piece:"blackPawn"},{cell:"b7",piece:"blackPawn"},{cell:"c7",piece:"blackPawn"},{cell:"d7",piece:"blackPawn"},{cell:"e7",piece:"blackPawn"},{cell:"f7",piece:"blackPawn"},{cell:"g7",piece:"blackPawn"},{cell:"h7",piece:"blackPawn"},{cell:"a1",piece:"whiteRook"},{cell:"b1",piece:"whiteKnight"},{cell:"c1",piece:"whiteBishop"},{cell:"d1",piece:"whiteQueen"},{cell:"e1",piece:"whiteKing"},{cell:"f1",piece:"whiteBishop"},{cell:"g1",piece:"whiteKnight"},{cell:"h1",piece:"whiteRook"},{cell:"a2",piece:"whitePawn"},{cell:"b2",piece:"whitePawn"},{cell:"c2",piece:"whitePawn"},{cell:"d2",piece:"whitePawn"},{cell:"e2",piece:"whitePawn"},{cell:"f2",piece:"whitePawn"},{cell:"g2",piece:"whitePawn"},{cell:"h2",piece:"whitePawn"}],gameSetup:[{cell:"a8",piece:"blackRook"},{cell:"b8",piece:"blackKnight"},{cell:"c8",piece:"blackBishop"},{cell:"d8",piece:"blackQueen"},{cell:"e8",piece:"blackKing"},{cell:"f8",piece:"blackBishop"},{cell:"g8",piece:"blackKnight"},{cell:"h8",piece:"blackRook"},{cell:"a7",piece:"blackPawn"},{cell:"b7",piece:"blackPawn"},{cell:"c7",piece:"blackPawn"},{cell:"d7",piece:"blackPawn"},{cell:"e7",piece:"blackPawn"},{cell:"f7",piece:"blackPawn"},{cell:"g7",piece:"blackPawn"},{cell:"h7",piece:"blackPawn"},{cell:"a1",piece:"whiteRook"},{cell:"b1",piece:"whiteKnight"},{cell:"c1",piece:"whiteBishop"},{cell:"d1",piece:"whiteQueen"},{cell:"e1",piece:"whiteKing"},{cell:"f1",piece:"whiteBishop"},{cell:"g1",piece:"whiteKnight"},{cell:"h1",piece:"whiteRook"},{cell:"a2",piece:"whitePawn"},{cell:"b2",piece:"whitePawn"},{cell:"c2",piece:"whitePawn"},{cell:"d2",piece:"whitePawn"},{cell:"e2",piece:"whitePawn"},{cell:"f2",piece:"whitePawn"},{cell:"g2",piece:"whitePawn"},{cell:"h2",piece:"whitePawn"}],imgNames:{blackQueen:"./chess/black-queen.svg",blackKing:"./chess/black-king.svg",blackBishop:"./chess/black-bishop.svg",blackKnight:"./chess/black-knight.svg",blackRook:"./chess/black-rook.svg",blackPawn:"./chess/black-pawn.svg",whiteQueen:"./chess/white-queen.svg",whiteKing:"./chess/white-king.svg",whiteBishop:"./chess/white-bishop.svg",whiteKnight:"./chess/white-knight.svg",whiteRook:"./chess/white-rook.svg",whitePawn:"./chess/white-pawn.svg",crown:"./flags/crown.svg",cross:"./flags/x.svg",draw:"./flags/draw.svg",leftArrow:"./header/chevron-left.svg",rightArrow:"./header/chevron-right.svg",pause:"./header/pause.svg",exit:"./header/exit.svg",play:"./header/play.svg"},createFunctions:{blackQueen:function(e){return new a.Queen(e,c.color.black)},blackKing:function(e){return new i.King(e,c.color.black)},blackBishop:function(e){return new o.Bishop(e,c.color.black)},blackKnight:function(e){return new s.Knight(e,c.color.black)},blackRook:function(e){return new l.Rook(e,c.color.black)},blackPawn:function(e){return new r.Pawn(e,c.color.black)},whiteQueen:function(e){return new a.Queen(e,c.color.white)},whiteKing:function(e){return new i.King(e,c.color.white)},whiteBishop:function(e){return new o.Bishop(e,c.color.white)},whiteKnight:function(e){return new s.Knight(e,c.color.white)},whiteRook:function(e){return new l.Rook(e,c.color.white)},whitePawn:function(e){return new r.Pawn(e,c.color.white)}},isWhiteFromBelow:!0,isTwoPlayersOffline:!0,passantCell:{positiveIncrement:4,negativeIncrement:3},startPage:"#/Lobby",dataBase:{version:1,storeUserName:"user",storeGamesName:"replays"},playersInitStates:{players:["Player 1","Player 2"],playerImgURL:"../../../avatar/Unknown.png"},serverURL:"wss://ancient-oasis-48599.herokuapp.com",boostBtnsAmount:4}},610:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.timer=void 0;var s=n(506);n(563);var r=function(e){function t(){var t=e.call(this,"div",["timer"])||this;t.timeNow=0,t.minute=new s.BaseComponents("label",["timer__inner"]),t.element.appendChild(t.minute.element);var n=new s.BaseComponents("div",["timer__colon"]);return n.element.innerHTML=":",t.element.appendChild(n.element),t.second=new s.BaseComponents("label",["timer__inner"]),t.element.appendChild(t.second.element),t.showTime(),t}return i(t,e),t.prototype.showTime=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.minute.element.innerHTML=e<10?"0"+e:""+e,this.second.element.innerHTML=t<10?"0"+t:""+t},t.prototype.startTimer=function(){var e=this;this.timer=setInterval((function(){e.timeNow++,e.showTime(Math.floor(e.timeNow/60),e.timeNow%60)}),1e3)},t.prototype.stopTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=void 0)},t.prototype.getTimeNow=function(){return this.timeNow},t.prototype.setTimeNow=function(e){this.timeNow=e},t.prototype.incrementTimeNow=function(){this.timeNow++},t.prototype.getTimer=function(){return this.timer},t.prototype.setTimer=function(e){this.timer=e},t.prototype.resetTimer=function(){this.timeNow=0,this.minute.element.innerHTML="00",this.second.element.innerHTML="00"},t.prototype.clearTimer=function(){this.stopTimer(),this.resetTimer()},t}(s.BaseComponents);t.timer=new r},266:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WatchReplay=void 0;var s=n(510),r=n(513),a=n(767),l=n(229),c=n(188),p=n(595),h=n(610),u=function(e){function t(t,n){var o,i=e.call(this,t)||this;i.whiteIncrement=0,i.blackIncrement=0,i.moveCounter=0,i.isFirstGameEnd=!0,i.boostMode=1,i.winner=t.winner,i.prevBtn=n.moveBtns.prevBtn,i.stopBtn=n.moveBtns.stopBtn,i.nextBtn=n.moveBtns.nextBtn,i.boostModeBtns=n.boostBtns,i.boostModeBtns[0].classList.add(p.setting.classNames.enable),i.initReplayBtnsListners(),i.moveAmount=t.moveAmount;var s=i.getPlayerStatistics();return o=s.firstPlayer.getColor()===c.color.white?[s.firstPlayer,s.secondPlayer]:[s.secondPlayer,s.firstPlayer],i.whitePlayer=o[0],i.blackPlayer=o[1],i.initTimer(),i}return i(t,e),t.prototype.initReplayBtnsListners=function(){var e=this;this.prevBtn.addEventListener("click",(function(){e.removePauseState(),e.makeMove(!1)})),this.stopBtn.addEventListener("click",(function(){e.stopBtn.classList.contains(p.setting.classNames.headers.replaysPlay)?(e.removePauseState(),e.startReplayTimer()):(e.stopBtn.classList.add(p.setting.classNames.headers.replaysPlay),e.stopBtn.style.backgroundImage="url("+p.setting.imgNames.play+")",e.stopTimer())})),this.nextBtn.addEventListener("click",(function(){e.removePauseState(),e.makeMove(!0)})),this.boostModeBtns.forEach((function(t){var n=t.id;t.addEventListener("click",(function(){e.boostModeBtns.forEach((function(e){e.classList.remove(p.setting.classNames.enable)})),t.classList.add(p.setting.classNames.enable),e.boostMode=Number(n),e.stopBtn.classList.contains(p.setting.classNames.headers.replaysPlay)||e.startNewBoostModeTimer()}))}))},t.prototype.removePauseState=function(){this.stopBtn.classList.remove(p.setting.classNames.headers.replaysPlay),this.stopBtn.style.backgroundImage="url("+p.setting.imgNames.pause+")"},t.prototype.makeMove=function(e){var t;if(e){if(this.isWhiteMove?(this.removeMoveRecordBacklights(this.whitePlayer.moveTable,this.whiteIncrement-1),this.addMoveRecordBacklights(this.whitePlayer.moveTable,this.whiteIncrement),t=this.whitePlayer.moveTable.takeMove(this.whiteIncrement),this.whiteIncrement++):(this.removeMoveRecordBacklights(this.blackPlayer.moveTable,this.blackIncrement-1),this.addMoveRecordBacklights(this.blackPlayer.moveTable,this.blackIncrement),t=this.blackPlayer.moveTable.takeMove(this.blackIncrement),this.blackIncrement++),this.confirmMoveSwitching(!0,t))return}else if(this.isWhiteMove?(this.blackIncrement--,this.removeMoveRecordBacklights(this.blackPlayer.moveTable,this.blackIncrement+1),this.addMoveRecordBacklights(this.blackPlayer.moveTable,this.blackIncrement),t=this.blackPlayer.moveTable.takeMove(this.blackIncrement)):(this.whiteIncrement--,this.removeMoveRecordBacklights(this.whitePlayer.moveTable,this.whiteIncrement+1),this.addMoveRecordBacklights(this.whitePlayer.moveTable,this.whiteIncrement),t=this.whitePlayer.moveTable.takeMove(this.whiteIncrement)),this.confirmMoveSwitching(!1,t))return},t.prototype.makeReplayPieceMove=function(e,t){var n,o=e.getClearMove(),i=o.endCell,s=o.startCell;if(t)i=(n=[s,i])[0],s=n[1],this.pieceActive=this.chessBoard.selectPiece(s),this.replayPieceMove(i,t);else{e.setSetup(JSON.parse(JSON.stringify(p.setting.gameSetup))),this.pieceActive=this.chessBoard.selectPiece(s),this.replayPieceMove(i,t);var r=e.getClearMove().newPiece;r&&this.pieceActive instanceof a.Pawn&&this.replaceTransormPiece(this.pieceActive,r)}this.removeReplayCancelMoveAndCheckValidation(this.pieceActive.color,t)},t.prototype.addMoveRecordBacklights=function(e,t){t>-1&&t<e.getAllMoves().length&&e.takeMove(t).element.classList.add(p.setting.classNames.replays.activeMove)},t.prototype.removeMoveRecordBacklights=function(e,t){t>-1&&t<e.getAllMoves().length&&e.takeMove(t).element.classList.remove(p.setting.classNames.replays.activeMove)},t.prototype.replayPieceMove=function(e,t){this.pieceActive&&(this.checkBacklightRemove(),this.moveBacklightRemove(),t||this.moveBacklightAdd(e),this.chessBoard.pieceMove(e,this.pieceActive))},t.prototype.removeReplayCancelMoveAndCheckValidation=function(e,t){this.chessBoard.removeCloseMove(),this.replayCheckMateValidation(e,t),this.pieceActive=void 0,this.isWhiteMove=!this.isWhiteMove,this.addMoveHolder()},t.prototype.replayCheckMateValidation=function(e,t){var n,o=t?s.colorFunctions.getReverseColor(e):e,i=this.chessBoard.checkValidation(o),r=this.chessBoard.movePossibilityValidation(o);if(i&&!r){if(this.checkBacklightAdd(),!this.activePlayer)throw new Error("Active player does not exist!");this.createWinPopup(null===(n=this.activePlayer)||void 0===n?void 0:n.getName())}else i?(this.checkBacklightAdd(o),console.log("check")):r||this.createDrawPopup();2===this.chessBoard.pieces.length&&(this.gameEnd(),this.isEndGame=!0)},t.prototype.updateTimer=function(e){var t=r.timeFunctions.getNumberTime(e);h.timer.stopTimer(),this.startReplayTimer(t)},t.prototype.confirmMoveSwitching=function(e,t){if(e){if(this.moveCounter++,this.makeReplayPieceMove(t,!e),this.updateTimer(t.getClearMove().time),this.moveCounter===this.moveAmount)return this.disableBlockBtn(!0),this.isFirstGameEnd&&(this.gameEnd(),this.isFirstGameEnd=!1),h.timer.stopTimer(),!0;this.enableBlockBtn(!1)}else this.moveCounter--,this.moveCounter||this.disableBlockBtn(!1),this.enableBlockBtn(!0),this.previousMove(t);return!1},t.prototype.previousMove=function(e){var t=this.getPreviousMoveRecord(e),n=-1===e.getClearMove().fullName.indexOf(c.color.white)?[this.blackPlayer,this.blackIncrement-1]:[this.whitePlayer,this.whiteIncrement-1],o=n[0],i=n[1];t?(p.setting.gameSetup=JSON.parse(JSON.stringify(t.getSetup())),this.makePreviousMove(t),this.removeMoveRecordBacklights(o.moveTable,i+1),this.addMoveRecordBacklights(o.moveTable,i),this.makeReplayPieceMove(t,!1),this.updateTimer(t.getClearMove().time)):(this.makePreviousMove(),this.removeMoveRecordBacklights(o.moveTable,i+1),this.updateTimer("00:00"),this.isWhiteMove=!this.isWhiteMove,this.addMoveHolder())},t.prototype.makePreviousMove=function(e){var t;this.checkBacklightRemove(),this.moveBacklightRemove(),e?(t=-1===e.getClearMove().fullName.indexOf(c.color.white)?c.color.black:c.color.white,p.setting.gameSetup=JSON.parse(JSON.stringify(e.getSetup()))):(t=c.color.black,p.setting.gameSetup=JSON.parse(JSON.stringify(p.setting.initialGameSetup))),this.chessBoard.renderNewChessBoard(p.setting.gameSetup),this.chessBoard.removeCloseMove(),this.replayCheckMateValidation(t,!0)},t.prototype.getPreviousMoveRecord=function(e){var t=-1===e.getClearMove().fullName.indexOf(c.color.white)?[this.whitePlayer,this.whiteIncrement-1]:[this.blackPlayer,this.blackIncrement-1],n=t[0],o=t[1];return o>-1&&o<n.moveTable.getAllMoves().length?n.moveTable.takeMove(o):null},t.prototype.disableBlockBtn=function(e){e?(this.stopBtn.classList.add(p.setting.classNames.disable),this.nextBtn.classList.add(p.setting.classNames.disable)):this.prevBtn.classList.add(p.setting.classNames.disable)},t.prototype.enableBlockBtn=function(e){e?(this.stopBtn.classList.remove(p.setting.classNames.disable),this.nextBtn.classList.remove(p.setting.classNames.disable)):this.prevBtn.classList.remove(p.setting.classNames.disable)},t.prototype.gameEnd=function(){this.winner?this.createWinPopup(this.winner.name):this.createDrawPopup()},t.prototype.initTimer=function(){this.startReplayTimer(0)},t.prototype.startReplayTimer=function(e){var t=this;void 0!==e&&(h.timer.setTimeNow(e),h.timer.showTime(Math.floor(e/60),e%60));var n=setInterval((function(){h.timer.incrementTimeNow();var e=h.timer.getTimeNow();t.compareMoves(e),h.timer.showTime(Math.floor(e/60),e%60)}),1e3/this.boostMode);h.timer.setTimer(n)},t.prototype.compareMoves=function(e){var t,n,o=r.timeFunctions.getStringTime(e);(null===(t=this.whitePlayer.moveTable.getAllMoves()[this.whiteIncrement])||void 0===t?void 0:t.time)!==o&&(null===(n=this.blackPlayer.moveTable.getAllMoves()[this.blackIncrement])||void 0===n?void 0:n.time)!==o||this.makeMove(!0)},t.prototype.stopTimer=function(){h.timer.stopTimer()},t.prototype.startNewBoostModeTimer=function(){h.timer.stopTimer(),this.startReplayTimer()},t}(l.Game);t.WatchReplay=u},650:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cellCoordinatesToName=void 0,t.cellCoordinatesToName=function(e){return String.fromCharCode(e.X+97)+String(e.Y+1)}},836:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cellNameToCellPosition=void 0,t.cellNameToCellPosition=function(e){var t=e.charCodeAt(0);return 63-(8*(Number(e[1])-1)+Math.abs(t-104))}},175:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cellNameToCoordinates=void 0,t.cellNameToCoordinates=function(e){return{X:e.charCodeAt(0)-97,Y:Number(e[1])-1}}},510:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.colorFunctions=void 0;var o=n(188);t.colorFunctions={getReverseColor:function(e){return e===o.color.white?o.color.black:o.color.white},getRandomColor:function(){return Math.random()>.5?o.color.black:o.color.white}}},735:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=void 0,t.createElement=function(e){var t,n=document.createElement("div");return(t=n.classList).add.apply(t,e),n}},771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageReader=void 0;var n=function(){function e(){}return e.writeMessage=function(e,t){return e+" "+t},e.readMessage=function(e){return e.split(" ")},e}();t.MessageReader=n},513:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.timeFunctions=void 0,t.timeFunctions={getStringTime:function(e){var t=Math.floor(e/60),n=e%60;return(t<10?"0"+t:String(t))+":"+(n<10?"0"+n:String(n))},getNumberTime:function(e){var t=e.split(":"),n=t[0],o=t[1];return Number(o)+60*Number(n)}}}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={exports:{}};return t[e].call(s.exports,s,s.exports,o),s.exports}o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e=new(o(77).App)(document.body),window.addEventListener("hashchange",(function(){e.router.changeRoute()}))})();
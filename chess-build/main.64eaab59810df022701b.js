(()=>{"use strict";var e,t={57:(e,t,n)=>{n.r(t)},995:(e,t,n)=>{n.r(t)},978:(e,t,n)=>{n.r(t)},115:(e,t,n)=>{n.r(t)},906:(e,t,n)=>{n.r(t)},801:(e,t,n)=>{n.r(t)},457:(e,t,n)=>{n.r(t)},94:(e,t,n)=>{n.r(t)},786:(e,t,n)=>{n.r(t)},729:(e,t,n)=>{n.r(t)},241:(e,t,n)=>{n.r(t)},563:(e,t,n)=>{n.r(t)},77:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;var r=n(690),s=n(0),a=n(229),l=n(977),c=n(381),p=n(456),u=n(561),h=n(649),d=n(610),v=n(266),m=function(){function e(e){this.rootElement=e,this.initDB(),this.header=new l.Header,this.rootElement.appendChild(this.header.element),this.footer=new s.Footer,this.rootElement.appendChild(this.footer.element),this.router=new h.Router}return e.prototype.initDB=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,r.storage.createDataBase()];case 1:return e.sent(),this.initRoute(),this.router.changeRoute(),[2]}}))}))},e.prototype.initRoute=function(){var e=this;this.router.add({pageName:"watch-replays",hash:"Watch-replay",needFoo:function(){return e.startWatchReplay()}}),this.router.add({pageName:"lobby",hash:"#/Lobby",needFoo:function(){return e.startLobbyPage()}}),this.router.add({pageName:"setting",hash:"#/Setting",needFoo:function(){return e.startSettingPage()}}),this.router.add({pageName:"game",hash:"#/Game",needFoo:function(){return e.startGamePage()}}),this.router.add({pageName:"replays",hash:"#/Replays",needFoo:function(){return e.startReplaysPage()}})},e.prototype.startLobbyPage=function(){this.header.removeAllBtns(),this.clearWindow(),this.lobby?this.lobby.resetOnlineSearch():this.lobby=new c.Lobby,this.activePage=this.lobby,this.rootElement.insertBefore(this.lobby.element,this.footer.element)},e.prototype.startSettingPage=function(){},e.prototype.startGamePage=function(){var e;this.header.removeAllBtns(),this.clearWindow(),(null===(e=this.lobby)||void 0===e?void 0:e.socket)&&this.lobby.color?this.game=new p.OnlineGame(this.lobby.color,this.lobby.socket):(this.game=new a.Game,this.game.dragAndDropListners());var t=this.header.createSurrenderAndDrawBtns();this.initGameBtns(t.surrenderBtn,t.drawBtn),this.initTimer(),this.activePage=this.game,this.rootElement.insertBefore(this.game.element,this.footer.element)},e.prototype.initGameBtns=function(e,t){var n=this;e.addEventListener("click",(function(){var e,t;(null===(e=n.game)||void 0===e?void 0:e.isEndGame)||(n.game instanceof p.OnlineGame?n.game.surrenderBtnEvent():null===(t=n.game)||void 0===t||t.surrender())}),{once:!0}),t.addEventListener("click",(function(){var e,t;(null===(e=n.game)||void 0===e?void 0:e.isEndGame)||(n.game instanceof p.OnlineGame?n.game.drawBtnEvent():null===(t=n.game)||void 0===t||t.draw())}))},e.prototype.startReplaysPage=function(){this.header.removeAllBtns(),this.clearWindow(),this.replays=new u.Replays,this.activePage=this.replays,this.rootElement.insertBefore(this.replays.element,this.footer.element)},e.prototype.startWatchReplay=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(o){switch(o.label){case 0:return this.header.removeAllBtns(),this.clearWindow(),[4,e.getReplay()];case 1:return t=o.sent(),n=this.header.createReplayBtns(),this.initReplayBtnsListners(n.previousBtn,n.nextBtn),this.watchReplay=new v.WatchReplay(t),this.activePage=this.watchReplay,this.rootElement.insertBefore(this.watchReplay.element,this.footer.element),[2]}}))}))},e.getReplay=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t){return o(e,void 0,void 0,(function(){var e,n,o,s,a;return i(this,(function(i){switch(i.label){case 0:return e=window.location.hash,n=e.split("/"),o=n[n.length-1],[4,r.storage.getReplays()];case 1:return s=i.sent(),a=s[Number(o)],t(a),[2]}}))}))}))]}))}))},e.prototype.initReplayBtnsListners=function(e,t){var n=this;e.addEventListener("click",(function(){var e;null===(e=n.watchReplay)||void 0===e||e.makeMove(!1)})),t.addEventListener("click",(function(){var e;null===(e=n.watchReplay)||void 0===e||e.makeMove(!0)}))},e.prototype.initTimer=function(){d.timer.clearTimer(),this.header.getContainer().appendChild(d.timer.element),d.timer.startTimer()},e.prototype.clearWindow=function(){var e;this.game instanceof p.OnlineGame&&this.game.offSocket(),null===(e=this.activePage)||void 0===e||e.element.remove()},e}();t.App=m},636:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ChessBoard=void 0;var r=n(650),s=n(836),a=n(175),l=n(443),c=n(767),p=n(278),u=n(506),h=n(188),d=n(595);n(57);var v=n(510),m=function(e){function t(t){var n=e.call(this,"div",[d.setting.classNames.board,d.setting.classNames.game.noRotate])||this;return n.pieces=[],n.allMoves=[],n.cells=n.cellsInit(),n.element.appendChild(n.boardNumerationInit("number")),n.element.appendChild(n.boardNumerationInit("letter")),n.newPlacePieces(t),n.allPossibleMoveDetermination(),n}return i(t,e),t.prototype.cellsInit=function(){for(var e=[],t=!0,n=8;n>=1;n--){for(var o=1;o<=8;o++){var i=document.createElement("div");i.id=""+String.fromCharCode(96+o)+n,t?i.classList.add(d.setting.classNames.cell,d.setting.classNames.whiteCell):i.classList.add(d.setting.classNames.cell,d.setting.classNames.blackCell),t=!t,e.push(i),this.element.appendChild(i)}t=!t}return e},t.prototype.boardNumerationInit=function(e){var t=document.createElement("div");if(t.classList.add(d.setting.classNames.numerationAll),e===d.setting.classNames.numberId){t.id=d.setting.classNames.numberId;for(var n=8;n>=1;n--){var o=document.createElement("div");o.innerHTML=String(n),o.classList.add(d.setting.classNames.numerationEach),t.appendChild(o)}}else for(t.id=d.setting.classNames.letterId,n=1;n<=8;n++){var i=document.createElement("div");i.innerHTML=String.fromCharCode(96+n),i.classList.add(d.setting.classNames.numerationEach),t.appendChild(i)}return t},t.prototype.newPlacePieces=function(e){var t=this;e.forEach((function(e){var n=e.piece,o=d.setting.createFunctions[n](e.cell);t.pieces.push(o);var i=s.cellNameToCellPosition(e.cell);t.cells[i].appendChild(o.element)}))},t.prototype.allPossibleMoveDetermination=function(){var e=this;this.pieces.forEach((function(t){t.possibleMoveDetermination(d.setting.gameSetup),e.capturingEnPassantValidation(t)})),this.castlingDetermination(),this.updateAllPossibleMoves()},t.prototype.updateAllPossibleMoves=function(){var e=this;this.allMoves=[],this.pieces.forEach((function(t){e.allMoves.push({cell:t.cell,moves:t.possibleMoves})}))},t.prototype.capturingEnPassantValidation=function(e){if(e instanceof c.Pawn){var t=a.cellNameToCoordinates(e.cell),n=e.getPawnIncrement()>0?d.setting.passantCell.positiveIncrement:d.setting.passantCell.negativeIncrement,o={X:t.X,Y:n};JSON.stringify(t)===JSON.stringify(o)&&(this.passantInDirection(e,1),this.passantInDirection(e,-1))}},t.prototype.passantInDirection=function(e,t){var n=a.cellNameToCoordinates(e.cell),o={X:n.X+t,Y:n.Y+e.getPawnIncrement()},i=r.cellCoordinatesToName(o),s={X:n.X+t,Y:n.Y},l=r.cellCoordinatesToName(s);this.passantPiecesValidation(l)&&e.possibleMoves.push(i)},t.prototype.passantPiecesValidation=function(e){for(var t=0;t<this.pieces.length;t++){var n=this.pieces[t];if(n.cell===e&&n instanceof c.Pawn&&n.canBeCapturedEnPassant)return!0}return!1},t.prototype.castlingDetermination=function(){this.castlingForEachPiece(h.color.white),this.castlingForEachPiece(h.color.black)},t.prototype.castlingForEachPiece=function(e){var t=this.kingSearcher(e),n=a.cellNameToCoordinates(t.cell);this.castlingValidationInDirection(t,1)&&t.possibleMoves.push(r.cellCoordinatesToName({X:n.X+2,Y:n.Y})),this.castlingValidationInDirection(t,-1)&&t.possibleMoves.push(r.cellCoordinatesToName({X:n.X-2,Y:n.Y}))},t.prototype.kingSearcher=function(e){for(var t=0;t<this.pieces.length;t++){var n=this.pieces[t];if(n instanceof l.King&&n.color===e)return n}throw Error("King does not exist!")},t.prototype.castlingValidationInDirection=function(e,t){if(e.isFirstMove){var n=a.cellNameToCoordinates(e.cell),o=v.colorFunctions.getReverseColor(e.color);return!this.clearCellAndRookValidation(n,t)&&!this.castlingCellInCheckValidation(o,n,t)}return!1},t.prototype.clearCellAndRookValidation=function(e,t){for(var n,o=e.X+t;o<8&&o>-1;o+=t){if(7===o||0===o){for(var i=0;i<this.pieces.length;i++)if(this.pieces[i].cell===r.cellCoordinatesToName({X:o,Y:e.Y})&&this.pieces[i]instanceof p.Rook){n=this.pieces[i];break}return!(null==n?void 0:n.isFirstMove)}var s=r.cellCoordinatesToName({X:o,Y:e.Y});for(i=0;i<d.setting.gameSetup.length;i++)if(d.setting.gameSetup[i].cell===s)return!0}throw Error("Breaking bad!")},t.prototype.castlingCellInCheckValidation=function(e,t,n){for(var o=this.possibleWhitesOrBlacksMoves(e),i=Math.abs(2*n),s=t.X;s>t.X-i&&s<t.X+i;s+=n){var a=r.cellCoordinatesToName({X:s,Y:t.Y});if(-1!==o.indexOf(a))return!0}return!1},t.prototype.getAllCells=function(){return this.cells},t.prototype.selectPiece=function(e){for(var t=0;t<this.pieces.length;t++)if(this.pieces[t].cell===e)return this.pieces[t];throw Error()},t.prototype.pieceMove=function(e,n){(n instanceof p.Rook||n instanceof l.King)&&(this.castlingMove(e,n),n.isFirstMove=!1),this.capturingEnPassantTry(e,n),this.longPawnMoveReset(),t.longPawnMoveValidation(e,n),this.capturingTry(e),n.element.remove(),this.cells[s.cellNameToCellPosition(e)].appendChild(n.element),t.updateGameSetup(e,n),n.cell=e},t.prototype.removeCloseMove=function(){this.allPossibleMoveDetermination(),this.removeMovesForСheck(h.color.white),this.removeMovesForСheck(h.color.black)},t.prototype.longPawnMoveReset=function(){for(var e=0;e<this.pieces.length;e++){var t=this.pieces[e];t instanceof c.Pawn&&(t.canBeCapturedEnPassant=!1)}},t.longPawnMoveValidation=function(e,t){var n=a.cellNameToCoordinates(e),o=a.cellNameToCoordinates(t.cell);t instanceof c.Pawn&&(t.canBeCapturedEnPassant=2===Math.abs(n.Y-o.Y))},t.prototype.capturingEnPassantTry=function(e,t){if(t instanceof c.Pawn){var n=a.cellNameToCoordinates(e),o=a.cellNameToCoordinates(t.cell),i=n.X-o.X;if(i)for(var s=r.cellCoordinatesToName({X:o.X+i,Y:o.Y}),l=0;l<this.pieces.length;l++){var p=this.pieces[l];if(p instanceof c.Pawn&&p.cell===s&&p.canBeCapturedEnPassant){for(var u=0;u<d.setting.gameSetup.length;u++)if(d.setting.gameSetup[u].cell===s){d.setting.gameSetup.splice(u,1);break}p.element.remove(),this.pieces.splice(l,1);break}}}},t.updateGameSetup=function(e,t){for(var n=0;n<d.setting.gameSetup.length;n++)if(d.setting.gameSetup[n].cell===t.cell){d.setting.gameSetup[n].cell=e;break}},t.prototype.capturingTry=function(e){for(var t=0;t<this.pieces.length;t++)if(this.pieces[t].cell===e){for(var n=0;n<d.setting.gameSetup.length;n++)d.setting.gameSetup[n].cell===e&&d.setting.gameSetup.splice(n,1);this.pieces[t].element.remove(),this.pieces.splice(t,1);break}},t.prototype.castlingMove=function(e,n){var o=a.cellNameToCoordinates(e),i=a.cellNameToCoordinates(n.cell);if(n instanceof l.King&&n.isFirstMove&&(o.X===i.X+2||o.X===i.X-2)){for(var c=(o.X-i.X)/2,u=c>0?7:0,h=r.cellCoordinatesToName({X:u,Y:i.Y}),d=void 0,v=0;v<this.pieces.length;v++)if(this.pieces[v].cell===h&&this.pieces[v]instanceof p.Rook){d=this.pieces[v];break}if(!d)throw Error("Rook does not exist!");var m=r.cellCoordinatesToName({X:i.X+c,Y:i.Y});d.element.remove(),this.cells[s.cellNameToCellPosition(m)].appendChild(d.element),t.updateGameSetup(m,d),d.cell=m}},t.prototype.removeMovesForСheck=function(e){var t=JSON.parse(JSON.stringify(d.setting.gameSetup)),n=v.colorFunctions.getReverseColor(e);this.possibleMoveDeterminationInCheck(n,t)},t.prototype.possibleMoveDeterminationInCheck=function(e,n){var o=this,i=[],r=[];this.pieces.forEach((function(t){t.color===e?i.push(t):r.push(t)})),i.forEach((function(e){for(var i=e.cell,s=0;s<e.possibleMoves.length;s++){var a=o.testCapturing(n,e,r,e.possibleMoves[s]);t.moveTesting(n,e,e.possibleMoves[s]),o.testCheckValidation(n,r)&&(e.possibleMoves.splice(s,1),s--),a&&(n.push(a.capturedPieceSetup),r.push(a.capturedPiece))}t.moveTesting(n,e,i)})),this.updateAllPossibleMoves()},t.prototype.testCheckValidation=function(e,n){if(!n.length)return!1;var o=n[0].color===h.color.white?h.color.black:h.color.white,i=t.getKingPosition(e,o),r=[];return n.forEach((function(t){var n=Object.assign(Object.create(Object.getPrototypeOf(t)),t);n.possibleMoveDetermination(e),r.push.apply(r,n.possibleMoves)})),-1!==r.indexOf(i)},t.moveTesting=function(e,t,n){for(var o=0;o<e.length;o++)if(e[o].cell===t.cell&&-1!==e[o].piece.indexOf(t.color)){e[o].cell=n;break}t.cell=n},t.prototype.testCapturing=function(e,t,n,o){for(var i,r,s=0;s<e.length;s++)if(e[s].cell===o&&-1===e[s].piece.indexOf(t.color)){i=e[s],e.splice(s,1);break}for(s=0;s<n.length;s++)if(n[s].cell===o){r=n[s],n.splice(s,1);break}if(this.testCapturingEnPassant(i,r,o,e,t,n),r&&i)return{capturedPieceSetup:i,capturedPiece:r}},t.prototype.testCapturingEnPassant=function(e,t,n,o,i,s){if(i instanceof c.Pawn)for(var l=a.cellNameToCoordinates(n),p=r.cellCoordinatesToName({X:l.X,Y:l.Y-i.getPawnIncrement()}),u=0;u<s.length;u++){var h=s[u];if(h instanceof c.Pawn&&h.cell===p&&h.canBeCapturedEnPassant){for(var d=0;d<o.length;d++)if(o[d].cell===p){o[d],o.splice(d,1);break}s.splice(u,1);break}}},t.prototype.checkValidation=function(e){var n=v.colorFunctions.getReverseColor(e),o=t.getKingPosition(d.setting.gameSetup,n);return-1!==this.possibleWhitesOrBlacksMoves(e).indexOf(o)},t.prototype.movePossibilityValidation=function(e){var t=v.colorFunctions.getReverseColor(e);return!!this.possibleWhitesOrBlacksMoves(t).length},t.prototype.possibleWhitesOrBlacksMoves=function(e){var t=[];return this.pieces.forEach((function(n){n.color===e&&t.push.apply(t,n.possibleMoves)})),t},t.prototype.getCheckPieces=function(e){var n=[],o=v.colorFunctions.getReverseColor(e),i=t.getKingPosition(d.setting.gameSetup,o);return this.pieces.forEach((function(e){-1===e.possibleMoves.indexOf(i)&&e.cell!==i||n.push(e)})),n},t.getKingPosition=function(e,t){for(var n=0;n<e.length;n++)if(e[n].piece===t+"King")return e[n].cell;throw Error("King does not exist")},t}(u.BaseComponents);t.ChessBoard=m},839:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.BasePiece=void 0;var r=n(650),s=n(506),a=n(188),l=n(595),c=function(e){function t(t,n,o){var i=e.call(this,"img",[l.setting.classNames.piece])||this;return i.name=o,i.possibleMoves=[],i.cell=t,i.color=n,i}return i(t,e),t.piecesCheck=function(e,t){var n=r.cellCoordinatesToName({X:e.X,Y:e.Y}),o="";if(t.forEach((function(e){e.cell!==n||(o=e.piece)})),o)return-1!==o.indexOf(a.color.black)?a.color.black:a.color.white},t.prototype.possibleMoveCheck=function(e,n,o,i){for(var s=e.X+n,a=e.Y+o;s<8&&s>-1&&a<8&&a>-1;s+=n,a+=o){var l={X:s,Y:a},c=t.piecesCheck(l,i);if(c){c!==this.color&&this.possibleMoves.push(r.cellCoordinatesToName(l));break}this.possibleMoves.push(r.cellCoordinatesToName(l))}},t}(s.BaseComponents);t.BasePiece=c},91:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Bishop=void 0;var r=n(175),s=n(595),a=function(e){function t(t,n){var o=e.call(this,t,n,"Bishop")||this,i=n+o.name;return o.element.setAttribute(s.setting.classNames.dataPiece,i),o.element.src=s.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=r.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,-1,1,e),this.possibleMoveCheck(t,1,1,e),this.possibleMoveCheck(t,1,-1,e),this.possibleMoveCheck(t,-1,-1,e)},t}(n(839).BasePiece);t.Bishop=a},443:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.King=void 0;var r=n(650),s=n(175),a=n(595),l=n(839),c=function(e){function t(t,n){var o=e.call(this,t,n,"King")||this;o.isFirstMove=!0;var i=n+o.name;return o.element.setAttribute(a.setting.classNames.dataPiece,i),o.element.src=a.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];for(var t=s.cellNameToCoordinates(this.cell),n=t.Y-1;n<t.Y+2;n++)if(n<8&&n>-1)for(var o=t.X-1;o<t.X+2;o++)o<8&&o>-1&&l.BasePiece.piecesCheck({X:o,Y:n},e)!==this.color&&this.possibleMoves.push(r.cellCoordinatesToName({X:o,Y:n}))},t}(l.BasePiece);t.King=c},822:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Knight=void 0;var r=n(650),s=n(175),a=n(595),l=n(839),c=function(e){function t(t,n){var o=e.call(this,t,n,"Knight")||this,i=n+o.name;return o.element.setAttribute(a.setting.classNames.dataPiece,i),o.element.src=a.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=s.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,1,2,e),this.possibleMoveCheck(t,-1,2,e),this.possibleMoveCheck(t,1,-2,e),this.possibleMoveCheck(t,-1,-2,e),this.possibleMoveCheck(t,2,1,e),this.possibleMoveCheck(t,2,-1,e),this.possibleMoveCheck(t,-2,1,e),this.possibleMoveCheck(t,-2,-1,e)},t.prototype.possibleMoveCheck=function(e,t,n,o){var i=e.X+t,s=e.Y+n;i<8&&i>-1&&s<8&&s>-1&&l.BasePiece.piecesCheck({X:i,Y:s},o)!==this.color&&this.possibleMoves.push(r.cellCoordinatesToName({X:i,Y:s}))},t}(l.BasePiece);t.Knight=c},767:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Pawn=void 0;var r=n(650),s=n(175),a=n(188),l=n(595),c=n(839),p=function(e){function t(t,n){var o,i,r=e.call(this,t,n,"Pawn")||this;r.canBeCapturedEnPassant=!1;var s=n+r.name;return r.element.setAttribute(l.setting.classNames.dataPiece,s),r.element.src=l.setting.imgNames[s],l.setting.isWhiteFromBelow?(o=r.color===a.color.white?[1,"2"]:[-1,"7"],r.pawnIncrement=o[0],r.startRow=o[1]):(i=r.color===a.color.white?[-1,"7"]:[1,"2"],r.pawnIncrement=i[0],r.startRow=i[1]),r}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=s.cellNameToCoordinates(this.cell);this.possiblePawnMoveCheck(t,e)&&this.cell[1]===this.startRow&&this.possiblePawnMoveCheck({X:t.X,Y:t.Y+this.pawnIncrement},e),this.possibleCaptureCheck(t,-1,e),this.possibleCaptureCheck(t,1,e)},t.prototype.possiblePawnMoveCheck=function(e,t){var n=e.Y+this.pawnIncrement;return n<8&&n>-1&&!c.BasePiece.piecesCheck({X:e.X,Y:n},t)&&(this.possibleMoves.push(r.cellCoordinatesToName({X:e.X,Y:n})),!0)},t.prototype.possibleCaptureCheck=function(e,t,n){var o=e.X+t,i=e.Y+this.pawnIncrement;o<8&&o>-1&&i<8&&i>-1&&c.BasePiece.piecesCheck({X:o,Y:i},n)&&c.BasePiece.piecesCheck({X:o,Y:i},n)!==this.color&&this.possibleMoves.push(r.cellCoordinatesToName({X:o,Y:i}))},t.prototype.getPawnIncrement=function(){return this.pawnIncrement},t}(c.BasePiece);t.Pawn=p},336:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Queen=void 0;var r=n(175),s=n(595),a=function(e){function t(t,n){var o=e.call(this,t,n,"Queen")||this,i=n+o.name;return o.element.setAttribute(s.setting.classNames.dataPiece,i),o.element.src=s.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=r.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,-1,1,e),this.possibleMoveCheck(t,0,1,e),this.possibleMoveCheck(t,1,1,e),this.possibleMoveCheck(t,1,0,e),this.possibleMoveCheck(t,1,-1,e),this.possibleMoveCheck(t,0,-1,e),this.possibleMoveCheck(t,-1,-1,e),this.possibleMoveCheck(t,-1,0,e)},t}(n(839).BasePiece);t.Queen=a},278:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Rook=void 0;var r=n(175),s=n(595),a=function(e){function t(t,n){var o=e.call(this,t,n,"Rook")||this;o.isFirstMove=!0;var i=n+o.name;return o.element.setAttribute(s.setting.classNames.dataPiece,i),o.element.src=s.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=r.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,0,1,e),this.possibleMoveCheck(t,0,-1,e),this.possibleMoveCheck(t,1,0,e),this.possibleMoveCheck(t,-1,0,e)},t.prototype.getPossibleMoves=function(){return this.possibleMoves},t}(n(839).BasePiece);t.Rook=a},690:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.storage=void 0;var o=n(491);t.storage=new o.DataBase},491:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataBase=void 0;var o=n(595),i=function(){function e(){}return e.prototype.createDataBase=function(){var e=this;return new Promise((function(t){var n=indexedDB.open("Chess",o.setting.dataBase.version);n.onupgradeneeded=function(){e.dataBase=n.result,e.dataBase.createObjectStore(o.setting.dataBase.storeUserName,{keyPath:"counter"}),e.dataBase.createObjectStore(o.setting.dataBase.storeGamesName,{autoIncrement:!0})},n.onsuccess=function(){e.dataBase=n.result,t()},n.onerror=function(){throw Error("Error opening database!")}}))},e.prototype.addPlayer=function(e,t,n){var i,r=null===(i=this.dataBase)||void 0===i?void 0:i.transaction([o.setting.dataBase.storeUserName],"readwrite");if(!r)throw Error("Data base not exist!");var s={player:e,counter:t,color:n};r.objectStore(o.setting.dataBase.storeUserName).put(s),r.oncomplete=function(){console.log("Player saved!")},r.onerror=function(){console.log("Error storing player!")}},e.prototype.getPlayers=function(){var e=this;return new Promise((function(t){var n,i=null===(n=e.dataBase)||void 0===n?void 0:n.transaction([o.setting.dataBase.storeUserName],"readonly");if(!i)throw Error("Data base not exist!");var r=i.objectStore(o.setting.dataBase.storeUserName).openCursor(),s=[];r.onsuccess=function(){var e=r.result;e?(s.push(e.value.player),e.continue()):t(s)},r.onerror=function(){throw Error("Error with cursor request!")}}))},e.prototype.addReplay=function(e,t,n,i){var r,s=null===(r=this.dataBase)||void 0===r?void 0:r.transaction([o.setting.dataBase.storeGamesName],"readwrite");if(!s)throw Error("Data base not exist!");var a={firstPlayer:e,secondPlayer:t,winner:n,time:i};s.objectStore(o.setting.dataBase.storeGamesName).put(a),s.oncomplete=function(){console.log("Replay saved!")},s.onerror=function(){console.log("Error storing replay!")}},e.prototype.getReplays=function(){var e=this;return new Promise((function(t){var n,i=null===(n=e.dataBase)||void 0===n?void 0:n.transaction([o.setting.dataBase.storeGamesName],"readonly");if(!i)throw Error("Data base not exist!");var r=i.objectStore(o.setting.dataBase.storeGamesName).openCursor(),s=[];r.onsuccess=function(){var e=r.result;e?(s.push(e.value),e.continue()):t(s)},r.onerror=function(){throw Error("Error with cursor request!")}}))},e}();t.DataBase=i},0:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0;var r=n(506);n(995);var s=function(e){function t(){var t=e.call(this,"footer",["footer"])||this;return t.element.innerHTML='\n    <div class="footer__container">\n      <a class="footer__link" href="https://github.com/Dauniusha">GitHub</a>\n      <span class="footer__text">RS School 2021</span>\n    </div>\n    ',t}return i(t,e),t}(r.BaseComponents);t.Footer=s},229:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var a=n(836),l=n(510),c=n(735),p=n(513),u=n(636),h=n(767),d=n(690),v=n(506),m=n(188),f=n(874),y=n(53),g=n(595),b=n(610);n(978);var w=function(e){function t(t,n){var o,i,r=e.call(this,"section",["game"])||this;return r.possibleCells=[],r.isWhiteMove=!0,r.isEndGame=!1,r.isDragAndDrop=!1,r.isSecondClick=!1,t?(o=r.replayPlayerInit(t.firstPlayer,t.secondPlayer),r.firstPlayer=o[0],r.secondPlayer=o[1],setTimeout((function(){r.addMoveHolder()}),200),r.chessBoard=new u.ChessBoard(g.setting.initialGameSetup),r.element.insertBefore(r.chessBoard.element,r.secondPlayer.element)):(i=r.playerInit(n),r.firstPlayer=i[0],r.secondPlayer=i[1],setTimeout((function(){r.addMoveHolder()}),200),r.chessBoard=new u.ChessBoard(g.setting.initialGameSetup),r.element.insertBefore(r.chessBoard.element,r.secondPlayer.element)),r}return i(t,e),t.prototype.playerInit=function(e){e||(e=l.colorFunctions.getRandomColor());var t=new f.PlayerStatistics({color:e,counter:0});this.element.appendChild(t.element);var n=l.colorFunctions.getReverseColor(e),o=new f.PlayerStatistics({color:n,counter:1});return this.element.appendChild(o.element),[t,o]},t.prototype.replayPlayerInit=function(e,t){var n=new f.PlayerStatistics(void 0,{player:e,counter:0});this.element.appendChild(n.element);var o=new f.PlayerStatistics(void 0,{player:t,counter:1});return this.element.appendChild(o.element),[n,o]},t.prototype.getChessBoard=function(){return this.chessBoard},t.prototype.chessBoardListnersInit=function(){var e=this;this.chessBoard.element.addEventListener("click",(function(t){var n,o,i,r,s,a,l,c=null===(n=t.target)||void 0===n?void 0:n.closest("."+g.setting.classNames.piece),p=e.isWhiteMove?m.color.white:m.color.black;if((null===(o=t.target)||void 0===o?void 0:o.closest("."+g.setting.classNames.possibleClearCell))||(null===(i=t.target)||void 0===i?void 0:i.closest("."+g.setting.classNames.possibleEngagedCell)))(u=null===(r=t.target)||void 0===r?void 0:r.closest("."+g.setting.classNames.cell))&&e.completeMove(u.id);else if(c&&-1!==(null===(s=c.getAttribute(g.setting.classNames.dataPiece))||void 0===s?void 0:s.indexOf(p))){var u;(u=null===(a=t.target)||void 0===a?void 0:a.closest("."+g.setting.classNames.cell))&&(null===(l=e.pieceActive)||void 0===l?void 0:l.cell)!==u.id?e.selectPiece(u.id):(e.possibleCellsBacklightRemove(),e.pieceActive=void 0)}else e.possibleCellsBacklightRemove()}))},t.prototype.dragAndDropListners=function(){var e=this;this.chessBoard.element.addEventListener("mousedown",(function(n){var o,i,r,s,a,l,c;e.isDragAndDrop=!1,console.log("mousedown");var p=null===(o=n.target)||void 0===o?void 0:o.closest("."+g.setting.classNames.piece);p&&(p.ondragstart=function(){return!1});var u=e.isWhiteMove?m.color.white:m.color.black,h=null===(i=n.target)||void 0===i?void 0:i.closest("."+g.setting.classNames.cell);if(h&&((null===(r=n.target)||void 0===r?void 0:r.closest("."+g.setting.classNames.possibleClearCell))||(null===(s=n.target)||void 0===s?void 0:s.closest("."+g.setting.classNames.possibleEngagedCell))))return e.completeMove(h.id),void(e.chessBoard.element.onmousemove=null);console.log(e.pieceActive),p&&-1!==(null===(a=p.getAttribute(g.setting.classNames.dataPiece))||void 0===a?void 0:a.indexOf(u))?(h&&(null===(l=e.pieceActive)||void 0===l?void 0:l.cell)!==h.id?e.selectPiece(h.id):h&&(null===(c=e.pieceActive)||void 0===c?void 0:c.cell)===h.id&&(e.isSecondClick=!0),e.dragObj={object:p,shiftX:n.clientX-p.getBoundingClientRect().left,shiftY:n.clientY-p.getBoundingClientRect().top,currentDroppable:null},t.addDragStyles(p),e.moveAtCoordinates(n.pageX,n.pageY),p.onmouseup=function(n){var o;if(console.log("mouseup"),e.isDragAndDrop){console.log("drag");var i=t.takeElementBelow(p,n);if(h&&t.removeDragStyles(p,h,i),(null==i?void 0:i.closest("."+g.setting.classNames.possibleClearCell))||(null==i?void 0:i.closest("."+g.setting.classNames.possibleEngagedCell)))return console.log(i),e.completeMove(i.id),e.chessBoard.element.onmousemove=null,void(p.onmouseup=null)}else h&&(t.removeDragStyles(p,h),(null===(o=e.pieceActive)||void 0===o?void 0:o.cell)===h.id&&e.isSecondClick&&(e.possibleCellsBacklightRemove(),e.isSecondClick=!1,e.pieceActive=void 0));e.chessBoard.element.onmousemove=null,p.onmouseup=null},e.chessBoard.element.onmousemove=function(t){e.onMouseMove(t)}):(e.possibleCellsBacklightRemove(),e.pieceActive=void 0)}))},t.addDragStyles=function(e){e.classList.add("draging"),document.body.append(e)},t.removeDragStyles=function(e,t,n){void 0===n&&(n=null),t.appendChild(e),e.classList.remove("draging"),t.classList.add(g.setting.classNames.selectPieceBacklight),t!==n&&(null==n||n.classList.remove(g.setting.classNames.selectPieceBacklight))},t.prototype.onMouseMove=function(e){if(this.isDragAndDrop=!0,console.log("mousemove"),this.moveAtCoordinates(e.pageX,e.pageY),this.dragObj){var n=t.takeElementBelow(this.dragObj.object,e);if(!n)return;var o=n.closest("."+g.setting.classNames.cell);this.dragObj.currentDroppable!=o&&(this.dragObj.currentDroppable&&this.removeDragBacklights(this.dragObj.currentDroppable),this.dragObj.currentDroppable=o,this.dragObj.currentDroppable&&this.addDragBacklights(this.dragObj.currentDroppable))}},t.takeElementBelow=function(e,t){e.hidden=!0;var n=document.elementFromPoint(t.clientX,t.clientY);return e.hidden=!1,n?n.closest("."+g.setting.classNames.cell):null},t.prototype.moveAtCoordinates=function(e,t){this.dragObj&&(this.dragObj.object.style.left=e-this.dragObj.shiftX+"px",this.dragObj.object.style.top=t-this.dragObj.shiftY+"px")},t.prototype.selectPiece=function(e){this.possibleCellsBacklightRemove(),this.pieceActive=this.chessBoard.selectPiece(e),this.possibleCellsBacklightAdd()},t.prototype.possibleCellsBacklightAdd=function(){var e,t,n,o=this,i=this.chessBoard.getAllCells();null===(t=null===(e=this.pieceActive)||void 0===e?void 0:e.element.parentElement)||void 0===t||t.classList.add(g.setting.classNames.selectPieceBacklight),null===(n=this.pieceActive)||void 0===n||n.possibleMoves.forEach((function(e){i.forEach((function(t){e===t.id&&(t.childElementCount?t.classList.add(g.setting.classNames.possibleEngagedCell):t.classList.add(g.setting.classNames.possibleClearCell),o.possibleCells.push(t))}))}))},t.prototype.possibleCellsBacklightRemove=function(){var e,t;null===(t=null===(e=this.pieceActive)||void 0===e?void 0:e.element.parentElement)||void 0===t||t.classList.remove(g.setting.classNames.selectPieceBacklight),this.possibleCells.forEach((function(e){e.classList.remove(g.setting.classNames.possibleClearCell),e.classList.remove(g.setting.classNames.possibleEngagedCell)})),this.possibleCells=[]},t.prototype.completeMove=function(e){this.pieceActive&&(this.pieceMove(e),this.pieceActive instanceof h.Pawn&&(-1!==this.pieceActive.cell.indexOf("8")||-1!==this.pieceActive.cell.indexOf("1"))?this.initPawnTransformation(this.pieceActive):this.removeCancelMoveAndCheckValidation(this.pieceActive.color))},t.prototype.pieceMove=function(e){this.pieceActive&&(this.checkBacklightRemove(),this.moveBacklightRemove(),this.possibleCellsBacklightRemove(),this.moveBacklightAdd(e),this.takeActivePlayer(e),this.chessBoard.pieceMove(e,this.pieceActive))},t.prototype.initPawnTransformation=function(e){var n=this,o=this.createChoosePiecePopup(e.color);o.showPopup(),o.element.addEventListener("click",(function(i){if(i.target instanceof HTMLImageElement){var r=e.color+i.target.alt;n.replaceTransormPiece(e,r),t.removePopup(o),n.removeCancelMoveAndCheckValidation(e.color)}}))},t.prototype.replaceTransormPiece=function(e,t){for(var n=0;n<g.setting.gameSetup.length;n++)if(g.setting.gameSetup[n].cell===e.cell){g.setting.gameSetup[n].piece=t;break}var o=g.setting.createFunctions[t](e.cell);e.element.remove();var i=a.cellNameToCellPosition(e.cell);this.chessBoard.getAllCells()[i].appendChild(o.element),this.chessBoard.pieces.splice(this.chessBoard.pieces.indexOf(e),1,o)},t.prototype.removeCancelMoveAndCheckValidation=function(e){this.chessBoard.removeCloseMove(),this.checkMateValidation(e),this.pieceActive=void 0,this.isWhiteMove=!this.isWhiteMove,this.addMoveHolder()},t.prototype.takeActivePlayer=function(e){var t,n;if(!this.pieceActive)throw new Error("pieceActive does not exist!");this.activePlayer=this.pieceActive.color===(null===(t=this.firstPlayer)||void 0===t?void 0:t.getColor())?this.firstPlayer:this.secondPlayer,null===(n=this.activePlayer)||void 0===n||n.moveTable.addMove(this.pieceActive.name,this.activePlayer.getColor(),this.pieceActive.cell,e,p.timeFunctions.getStringTime(b.timer.getTimeNow()))},t.prototype.moveBacklightAdd=function(e){var t=this;this.chessBoard.getAllCells().forEach((function(n){var o;(null===(o=t.pieceActive)||void 0===o?void 0:o.cell)!==n.id&&e!==n.id||n.classList.add(g.setting.classNames.moveBacklight)}))},t.prototype.moveBacklightRemove=function(){this.chessBoard.getAllCells().forEach((function(e){e.classList.contains(g.setting.classNames.moveBacklight)&&e.classList.remove(g.setting.classNames.moveBacklight)}))},t.prototype.addDragBacklights=function(e){e.classList.add(g.setting.classNames.selectPieceBacklight)},t.prototype.removeDragBacklights=function(e){e.classList.remove(g.setting.classNames.selectPieceBacklight)},t.prototype.checkMateValidation=function(e){var t,n=this.chessBoard.checkValidation(e),o=this.chessBoard.movePossibilityValidation(e);n&&!o?(this.checkBacklightAdd(),this.createEndGame(!0,null===(t=this.activePlayer)||void 0===t?void 0:t.getName()),this.isEndGame=!0):n?(this.checkBacklightAdd(),console.log("check")):o||(this.createEndGame(!1),this.isEndGame=!0)},t.prototype.createEndGame=function(e,t){void 0===t&&(t=""),e?this.createWinPopup(t):this.createDrawPopup(),this.createReplay()},t.prototype.createReplay=function(){var e,t,n;if(this.firstPlayer&&this.secondPlayer&&this.activePlayer){var o=null===(e=this.firstPlayer)||void 0===e?void 0:e.getPlayerWithMoves(),i=null===(t=this.secondPlayer)||void 0===t?void 0:t.getPlayerWithMoves(),r=null===(n=this.activePlayer)||void 0===n?void 0:n.getPlayer().getNameWithAvatar();d.storage.addReplay(o,i,r,"1:30")}},t.prototype.createWinPopup=function(e){this.createPopup(e+" won!")},t.prototype.createDrawPopup=function(){this.createPopup("Draw!")},t.prototype.createPopup=function(e){var n,o=new y.Popup;o.btnsInit(),o.text.innerHTML=e,null===(n=this.element.parentElement)||void 0===n||n.appendChild(o.element),o.showPopup(),o.element.addEventListener("click",(function(){t.removePopup(o)}),{once:!0})},t.createConfirmDrawPopup=function(){var e=new y.Popup;return e.element.id="confirm-popup",e.text.innerHTML="The opponent offers a draw",e},t.prototype.checkBacklightAdd=function(){this.pieceActive&&(this.checkPieces=this.chessBoard.getCheckPieces(this.pieceActive.color),this.checkPieces.forEach((function(e){var t;null===(t=e.element.parentElement)||void 0===t||t.classList.add(g.setting.classNames.checkBacklight)})))},t.prototype.checkBacklightRemove=function(){this.checkPieces&&this.checkPieces.forEach((function(e){var t;null===(t=e.element.parentElement)||void 0===t||t.classList.remove(g.setting.classNames.checkBacklight)}))},t.prototype.checkRotateChessBoard=function(){g.setting.isTwoPlayersOffline&&this.rotateChessBoard()},t.prototype.rotateChessBoard=function(){this.chessBoard.element.classList.toggle(g.setting.classNames.game.rotate),this.chessBoard.element.classList.toggle(g.setting.classNames.game.noRotate)},t.prototype.addMoveHolder=function(){var e,t,n=(null===(e=this.firstPlayer)||void 0===e?void 0:e.getColor())===m.color.white?this.firstPlayer:this.secondPlayer,o=(null===(t=this.firstPlayer)||void 0===t?void 0:t.getColor())===m.color.black?this.firstPlayer:this.secondPlayer;this.isWhiteMove?(null==n||n.getPlayer().getAvatar().classList.add(g.setting.classNames.game.playerActive),null==o||o.getPlayer().getAvatar().classList.remove(g.setting.classNames.game.playerActive)):(null==n||n.getPlayer().getAvatar().classList.remove(g.setting.classNames.game.playerActive),null==o||o.getPlayer().getAvatar().classList.add(g.setting.classNames.game.playerActive))},t.prototype.getPlayerStatistics=function(){if(this.firstPlayer&&this.secondPlayer)return{firstPlayer:this.firstPlayer,secondPlayer:this.secondPlayer};throw new Error("players does not exist!")},t.prototype.surrender=function(){var e,t,n=(null===(e=this.firstPlayer)||void 0===e?void 0:e.getColor())===m.color.white?this.firstPlayer:this.secondPlayer,o=(null===(t=this.firstPlayer)||void 0===t?void 0:t.getColor())===m.color.black?this.firstPlayer:this.secondPlayer;this.isWhiteMove?this.createEndGame(!0,null==o?void 0:o.getName()):this.createEndGame(!0,null==n?void 0:n.getName()),this.isEndGame=!0},t.prototype.draw=function(){var e,n=this,o=t.createConfirmDrawPopup();o.confirmPopupBtns(),null===(e=this.element.parentElement)||void 0===e||e.appendChild(o.element),o.showPopup(),o.element.addEventListener("click",(function(e){return r(n,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,o.closePopup()];case 1:return t.sent(),o.element.remove(),e.target.classList.contains(g.setting.classNames.popups.popupLobbyBtn)&&(this.createEndGame(!1),this.isEndGame=!0),[2]}}))}))}),{once:!0})},t.prototype.createChoosePiecePopup=function(e){var t,n=new y.Popup;n.text.innerHTML="Choose new piece";var o=c.createElement(["choose-piece"]);return o.innerHTML='\n    <img class="choose-piece__each" src="./chess/'+e+'-queen.svg" alt="Queen">\n    <img class="choose-piece__each" src="./chess/'+e+'-rook.svg" alt="Rook">\n    <img class="choose-piece__each" src="./chess/'+e+'-knight.svg" alt="Knight">\n    <img class="choose-piece__each" src="./chess/'+e+'-bishop.svg" alt="Bishop">\n    ',n.element.appendChild(o),null===(t=this.element.parentElement)||void 0===t||t.appendChild(n.element),n},t.removePopup=function(e){return r(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,e.closePopup()];case 1:return t.sent(),e.element.remove(),[2]}}))}))},t}(v.BaseComponents);t.Game=w},977:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;var r=n(735),s=n(506),a=n(595),l=n(610);n(115);var c=function(e){function t(){var t=e.call(this,"header",[a.setting.classNames.headers.header])||this;return t.container=document.createElement("div"),t.container.classList.add(a.setting.classNames.headers.container),t.element.appendChild(t.container),t.addLogo(),t}return i(t,e),t.prototype.addLogo=function(){var e=document.createElement("div");e.classList.add(a.setting.classNames.headers.logo),e.innerHTML='\n      <img class="'+a.setting.classNames.headers.logoImg+'" src="../../../logo/logo.svg">\n      <a href="#/Lobby" class="'+a.setting.classNames.headers.logoText+'">Chess</a>\n    ',this.container.appendChild(e)},t.prototype.createReplayBtns=function(){var e=r.createElement([a.setting.classNames.replays.headerBtns]);return this.previousMoveBtn=r.createElement([a.setting.classNames.replays.headerBtn]),this.previousMoveBtn.style.backgroundImage="url("+a.setting.imgNames.leftArrow+")",e.appendChild(this.previousMoveBtn),this.nextMoveBtn=r.createElement([a.setting.classNames.replays.headerBtn]),this.nextMoveBtn.style.backgroundImage="url("+a.setting.imgNames.rightArrow+")",e.appendChild(this.nextMoveBtn),this.container.appendChild(e),{previousBtn:this.previousMoveBtn,nextBtn:this.nextMoveBtn}},t.prototype.createSurrenderAndDrawBtns=function(){var e=r.createElement([a.setting.classNames.headers.gameBtnsContainer]);return this.surrenderBtn=r.createElement([a.setting.classNames.headers.gameBtn]),this.surrenderBtn.innerHTML="surrender",this.surrenderBtn.id="surrender",e.appendChild(this.surrenderBtn),this.drawBtn=r.createElement([a.setting.classNames.headers.gameBtn]),this.drawBtn.innerHTML="offer a draw",this.drawBtn.id="draw",e.appendChild(this.drawBtn),this.container.appendChild(e),{surrenderBtn:this.surrenderBtn,drawBtn:this.drawBtn}},t.prototype.removeAllBtns=function(){var e,t,n,o;l.timer.element.remove(),null===(t=null===(e=this.nextMoveBtn)||void 0===e?void 0:e.parentElement)||void 0===t||t.remove(),this.nextMoveBtn=void 0,this.previousMoveBtn=void 0,null===(o=null===(n=this.surrenderBtn)||void 0===n?void 0:n.parentElement)||void 0===o||o.remove(),this.surrenderBtn=void 0,this.drawBtn=void 0},t.prototype.getContainer=function(){return this.container},t}(s.BaseComponents);t.Header=c},381:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Lobby=void 0;var r=n(735),s=n(690),a=n(506),l=n(559),c=n(595);n(906);var p=function(e){function t(){var n,o=e.call(this,"section",[c.setting.classNames.lobby.lobby])||this;o.container=r.createElement([c.setting.classNames.lobby.container]),o.element.appendChild(o.container);var i=o.playerBlockInit();o.playerFirst=new l.Player({writable:!0,counter:0}),o.replaysBtn=t.replaysBtnInit(),i.appendChild(o.playerFirst.element),i.appendChild(o.replaysBtn),n=t.startBtnAndSwicherInit(),o.startGameBtn=n[0],o.startTextElement=n[1],o.gameSwitcherBtn=n[2],o.container.appendChild(o.startGameBtn),o.initStartListner(),o.initToogleListner();var s=o.playerBlockInit();return o.playerSecond=new l.Player({writable:!0,counter:1}),o.settingBtn=t.settingBtnInit(),s.appendChild(o.playerSecond.element),s.appendChild(o.settingBtn),o}return i(t,e),t.prototype.playerBlockInit=function(){var e=document.createElement("div");return e.classList.add("player-menu"),this.container.appendChild(e),e},t.replaysBtnInit=function(){var e=document.createElement("a");return e.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.replay),e.href="#/Replays",e.innerHTML='\n      <p class="'+c.setting.classNames.lobby.menu.replayText+'">View replays</p>\n      <img class="'+c.setting.classNames.lobby.menu.replayImg+'" src="./lobby/replays/play-button.svg" alt="play">\n    ',e},t.settingBtnInit=function(){var e=document.createElement("a");return e.href="#/Setting",e.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.setting),e.innerHTML='\n      <img class="'+c.setting.classNames.lobby.menu.settingImg+'" src="./lobby/setting/settings.svg" alt="setting">\n    ',e},t.startBtnAndSwicherInit=function(){var e=r.createElement([c.setting.classNames.lobby.menu.start]),t=document.createElement("a");t.href="#/Game",t.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.startText),t.innerHTML="Start";var n=document.createElement("div");return n.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.gameMode),n.dataset.mode="online",n.innerHTML='\n      <div class="game-mode__text" id="online">Online</div>\n      <div class="game-mode__text" id="offline">Offline</div>\n    ',e.appendChild(t),e.appendChild(n),[e,t,n]},t.prototype.initToogleListner=function(){var e=this;this.gameSwitcherBtn.addEventListener("click",(function(){var t="online";"online"===e.gameSwitcherBtn.dataset.mode&&(e.resetOnlineSearch(),e.hideLoadingScreen(),t="offline"),e.startGameBtn.dataset.mode="start-"+t,e.gameSwitcherBtn.dataset.mode=t}))},t.prototype.initStartListner=function(){var e=this;this.startTextElement.addEventListener("click",(function(t){"online"===e.gameSwitcherBtn.dataset.mode?(t.preventDefault(),e.blockBtns(),e.showLoadingOrConnectingScreen("connecting"),e.initSocket()):(s.storage.addPlayer(e.playerFirst.getNameWithAvatar(),0),s.storage.addPlayer(e.playerSecond.getNameWithAvatar(),1))}))},t.prototype.initSocket=function(){var e=this;this.socket=new WebSocket(c.setting.serverURL),this.socket.addEventListener("open",(function(){e.socket&&e.socket.addEventListener("message",(function(t){e.newMessage(t.data)}))}))},t.prototype.newMessage=function(e){var t,n;switch(console.log(e),e){case"loading":this.showLoadingOrConnectingScreen("loading");break;case"connected":null===(t=this.socket)||void 0===t||t.send("name "+this.playerFirst.getName()),null===(n=this.socket)||void 0===n||n.send("avatar "+this.playerFirst.getAvatarURL());break;case"white":case"black":this.color=e;break;default:var o=e.split(" ");switch(o[0]){case"name":this.playerSecond.setName(o.splice(1).join(" "));break;case"avatar":this.playerSecond.setAvatar(o[1]),s.storage.addPlayer(this.playerFirst.getNameWithAvatar(),0,this.color),s.storage.addPlayer(this.playerSecond.getNameWithAvatar(),1),this.hideLoadingScreen(),this.removeBlockBtns(),window.location.hash="#/Game"}}},t.prototype.showLoadingOrConnectingScreen=function(e){this.hideLoadingScreen(),this.loadingElement=r.createElement([c.setting.classNames.lobby.menu.menu,"loading"]),this.loadingElement.innerHTML=' \n    <p class="loading__text">'+e+'</p>\n    <div class="lds-ellipsis">\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n    ',this.playerSecond.element.appendChild(this.loadingElement)},t.prototype.resetOnlineSearch=function(){this.hideLoadingScreen(),this.removeBlockBtns(),this.resetColorAndSocket()},t.prototype.hideLoadingScreen=function(){var e;null===(e=this.loadingElement)||void 0===e||e.remove(),this.loadingElement=void 0},t.prototype.resetColorAndSocket=function(){var e;this.color=void 0,null===(e=this.socket)||void 0===e||e.close(),this.socket=void 0},t.prototype.blockBtns=function(){this.startTextElement.classList.add(c.setting.classNames.disable),this.playerSecond.getAvatar().classList.add(c.setting.classNames.disable),this.playerSecond.getNameElement().classList.add(c.setting.classNames.disable)},t.prototype.removeBlockBtns=function(){this.startTextElement.classList.remove(c.setting.classNames.disable),this.playerSecond.getAvatar().classList.remove(c.setting.classNames.disable),this.playerSecond.getNameElement().classList.remove(c.setting.classNames.disable)},t}(a.BaseComponents);t.Lobby=p},506:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponents=void 0;t.BaseComponents=function(e,t){var n;void 0===e&&(e="div"),void 0===t&&(t=[]),this.element=document.createElement(e),(n=this.element.classList).add.apply(n,t)}},188:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.color=void 0,t.color={white:"white",black:"black"}},152:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.MoveTable=void 0;var r=n(506),s=n(467),a=n(595);n(801);var l=function(e){function t(){var t=e.call(this,"div",[a.setting.classNames.game.playerMoveTable])||this;return t.fullPieceName=[],t}return i(t,e),t.prototype.addMove=function(e,t,n,o,i){var r=t+e,a=new s.Move(r,n,o,i);this.fullPieceName.push(a),this.element.appendChild(a.element)},t.prototype.moveInit=function(e){var t=this;e.forEach((function(e){var n=new s.Move(e.fullName,e.startCell,e.endCell,e.time);t.fullPieceName.push(n),t.element.appendChild(n.element)}))},t.prototype.takeMove=function(e){return this.fullPieceName[e]},t.prototype.getAllMoves=function(){var e=[];return this.fullPieceName.forEach((function(t){e.push(t.getClearMove())})),e},t.prototype.getAllMovesElement=function(){return this.fullPieceName},t}(r.BaseComponents);t.MoveTable=l},467:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Move=void 0;var r=n(735),s=n(506),a=n(595);n(457);var l=function(e){function t(t,n,o,i){var s=e.call(this,"div",[a.setting.classNames.game.playerMoveTableEach])||this;s.fullName=t,s.startCell=n,s.endCell=o,s.time=i;var l=r.createElement([a.setting.classNames.game.playerMoveTableImg]);l.style.backgroundImage="url("+a.setting.imgNames[s.fullName]+")";var c=r.createElement([a.setting.classNames.game.playerMoveTableCells]);c.innerHTML=s.startCell+" - "+s.endCell;var p=r.createElement([a.setting.classNames.game.playerMoveTableTime]);return p.innerHTML=s.time,s.element.appendChild(l),s.element.appendChild(c),s.element.appendChild(p),s}return i(t,e),t.prototype.getClearMove=function(){return{fullName:this.fullName,startCell:this.startCell,endCell:this.endCell,time:this.time}},t}(s.BaseComponents);t.Move=l},456:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineGame=void 0;var a=n(229),l=n(771),c=n(188),p=n(595),u=n(767),h=function(e){function t(t,n){var o=e.call(this,void 0,t)||this;return o.socket=n,"black"===t&&o.rotateChessBoard(),o.color=t,o.initListner(),o.makeMoveAndSendData(),o}return i(t,e),t.prototype.initListner=function(){var e=this;this.socket.addEventListener("message",(function(t){var n;switch(t.data){case"draw":e.confirmDrawPopup();break;case"confirm draw":e.createEndGame(!1),e.isEndGame=!0;break;case"refuse draw":break;case"surrender":e.createEndGame(!0,null===(n=e.firstPlayer)||void 0===n?void 0:n.getName()),e.isEndGame=!0;break;case"Bishop":case"Rook":case"Queen":case"Knight":e.transformPieceFromMessage(t.data);break;default:e.makeEnemyOnlineMove(t.data)}})),this.socket.addEventListener("close",(function(){var t;e.isEndGame||(e.createEndGame(!0,null===(t=e.secondPlayer)||void 0===t?void 0:t.getName()),e.isEndGame=!0)}))},t.prototype.confirmDrawPopup=function(){var e,t=this,n=a.Game.createConfirmDrawPopup();n.confirmPopupBtns(),null===(e=this.element.parentElement)||void 0===e||e.appendChild(n.element),n.showPopup(),n.element.addEventListener("click",(function(e){return r(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,n.closePopup()];case 1:return t.sent(),n.element.remove(),e.target.classList.contains(p.setting.classNames.popups.popupLobbyBtn)?(this.socket.send("confirm draw"),this.createEndGame(!1),this.isEndGame=!0):this.socket.send("refuse draw"),[2]}}))}))}),{once:!0})},t.prototype.transformPieceFromMessage=function(e){for(var t=0;t<this.chessBoard.pieces.length;t++){var n=this.chessBoard.pieces[t];if(n instanceof u.Pawn&&(-1!==n.cell.indexOf("8")||-1!==n.cell.indexOf("1"))){this.pieceActive=n;var o=n.color+e;return this.replaceTransormPiece(n,o),this.chessBoard.removeCloseMove(),this.checkMateValidation(n.color),void(this.pieceActive=void 0)}}},t.prototype.makeEnemyOnlineMove=function(e){var t;if("disconnected"!==e){var n=l.MessageReader.readMessage(e),o=n[0],i=n[1];this.pieceActive=this.chessBoard.selectPiece(o),this.pieceMove(i),this.removeCancelMoveAndCheckValidation(this.pieceActive.color)}else this.isEndGame||(this.createEndGame(!0,null===(t=this.firstPlayer)||void 0===t?void 0:t.getName()),this.isEndGame=!0)},t.prototype.makeOnlineCompleteMove=function(e){this.pieceActive&&(this.socket.send(l.MessageReader.writeMessage(this.pieceActive.cell,e)),this.pieceMove(e),this.pieceActive instanceof u.Pawn&&(-1!==this.pieceActive.cell.indexOf("8")||-1!==this.pieceActive.cell.indexOf("1"))?this.initOnlinePawnTransformation(this.pieceActive):this.removeCancelMoveAndCheckValidation(this.pieceActive.color))},t.prototype.initOnlinePawnTransformation=function(e){var t=this,n=this.createChoosePiecePopup(e.color);n.showPopup(),n.element.addEventListener("click",(function(o){if(o.target instanceof HTMLImageElement){var i=o.target.alt,r=e.color+i;t.socket.send(i),t.replaceTransormPiece(e,r),a.Game.removePopup(n),t.removeCancelMoveAndCheckValidation(e.color)}}))},t.prototype.makeMoveAndSendData=function(){var e=this;this.chessBoard.element.addEventListener("click",(function(t){var n,o,i,r,s,a,l,u=null===(n=t.target)||void 0===n?void 0:n.closest("."+p.setting.classNames.piece),h=e.isWhiteMove?c.color.white:c.color.black;if((null===(o=t.target)||void 0===o?void 0:o.closest("."+p.setting.classNames.possibleClearCell))||(null===(i=t.target)||void 0===i?void 0:i.closest("."+p.setting.classNames.possibleEngagedCell)))(d=null===(r=t.target)||void 0===r?void 0:r.closest("."+p.setting.classNames.cell))&&e.pieceActive&&(console.log(e.pieceActive.cell),e.makeOnlineCompleteMove(d.id));else if(u&&-1!==(null===(s=u.getAttribute(p.setting.classNames.dataPiece))||void 0===s?void 0:s.indexOf(h))&&h===e.color){var d;(d=null===(a=t.target)||void 0===a?void 0:a.closest("."+p.setting.classNames.cell))&&(null===(l=e.pieceActive)||void 0===l?void 0:l.cell)!==d.id?e.selectPiece(d.id):(e.possibleCellsBacklightRemove(),e.pieceActive=void 0)}else e.possibleCellsBacklightRemove()}))},t.prototype.surrenderBtnEvent=function(){var e;this.socket.send("surrender"),this.createEndGame(!0,null===(e=this.secondPlayer)||void 0===e?void 0:e.getName()),this.isEndGame=!0},t.prototype.drawBtnEvent=function(){this.socket.send("draw")},t.prototype.offSocket=function(){this.socket.close()},t}(a.Game);t.OnlineGame=h},874:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerStatistics=void 0;var r=n(506),s=n(152),a=n(559),l=n(595);n(94);var c=function(e){function t(t,n){var o=e.call(this,"div",[l.setting.classNames.game.playerStatistics])||this;if(t)o.color=t.color,o.player=new a.Player({writable:!1,counter:t.counter}),o.moveTable=new s.MoveTable;else{if(!n)throw new Error("All parametr is invalid!");o.color=n.player.color,o.player=new a.Player(void 0,{avatarURL:n.player.player.avatarURL,name:n.player.player.name}),o.moveTable=new s.MoveTable,o.moveTable.moveInit(n.player.moves)}return o.element.appendChild(o.player.element),o.element.appendChild(o.moveTable.element),o}return i(t,e),t.prototype.getColor=function(){return this.color},t.prototype.getName=function(){return this.player.getName()},t.prototype.getPlayer=function(){return this.player},t.prototype.getPlayerWithMoves=function(){return{player:this.player.getNameWithAvatar(),moves:this.moveTable.getAllMoves(),color:this.color}},t}(r.BaseComponents);t.PlayerStatistics=c},559:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;var a=n(690),l=n(506),c=n(595),p=function(e){function t(t,n){var o=e.call(this,"div",[c.setting.classNames.player.player])||this;return t?t.writable?o.playerInit(t.counter):o.getPlayer(t.counter):n&&o.createClearPlayer(n.avatarURL,n.name),o}return i(t,e),t.prototype.playerInit=function(e){return r(this,void 0,void 0,(function(){var t,n,o,i;return s(this,(function(r){switch(r.label){case 0:return[4,a.storage.getPlayers()];case 1:return t=r.sent(),i=t[e]?[t[e].avatarURL,t[e].name]:[c.setting.playersInitStates.playerImgURL,c.setting.playersInitStates.players[e]],this.avatarURL=i[0],this.name=i[1],(n=document.createElement("input")).type="file",n.classList.add(c.setting.classNames.player.avatar),n.style.backgroundImage="url("+this.avatarURL+")",this.avatar=n,this.element.appendChild(n),this.upload(n),(o=document.createElement("input")).classList.add(c.setting.classNames.player.name),o.type="text",o.value=this.name,this.nameElement=o,this.element.appendChild(o),this.input(o),[2]}}))}))},t.prototype.getPlayer=function(e){return r(this,void 0,void 0,(function(){var t,n;return s(this,(function(o){switch(o.label){case 0:return[4,a.storage.getPlayers()];case 1:return t=o.sent(),n=t[e]?[t[e].avatarURL,t[e].name]:[c.setting.playersInitStates.playerImgURL,c.setting.playersInitStates.players[e]],this.avatarURL=n[0],this.name=n[1],this.createClearPlayer(this.avatarURL,this.name),[2]}}))}))},t.prototype.createClearPlayer=function(e,t){var n=document.createElement("div");n.classList.add(c.setting.classNames.player.gameAvatar),e!==c.setting.playersInitStates.playerImgURL?n.style.backgroundImage="url("+e+")":n.innerHTML=t[0],this.avatar=n,this.element.appendChild(n);var o=document.createElement("div");o.classList.add(c.setting.classNames.player.name),o.innerHTML=t,this.nameElement=o,this.element.appendChild(o)},t.prototype.upload=function(e){var t=this;e.addEventListener("change",(function(){var n=new FileReader;if(!e.files)throw Error("Files for avatar does not exist!");var o=e.files[0];n.readAsDataURL(o),n.onload=function(){t.avatarURL=n.result,e.style.background="url("+n.result+") center no-repeat",e.style.backgroundSize="cover"}}))},t.prototype.input=function(e){var t=this;e.addEventListener("input",(function(){t.name=e.value}))},t.prototype.getName=function(){if(this.name)return this.name;throw new Error("Name does not exist!")},t.prototype.getNameElement=function(){if(this.nameElement)return this.nameElement;throw new Error("Name element does not exist!")},t.prototype.getNameWithAvatar=function(){if(this.avatarURL&&this.name)return{avatarURL:this.avatarURL,name:this.name};throw new Error("Name or avatar does not exist!")},t.prototype.getAvatar=function(){if(this.avatar)return this.avatar;throw new Error("Avatar does not exist!")},t.prototype.getAvatarURL=function(){if(this.avatarURL)return this.avatarURL;throw new Error("Avatar URL does not exist!")},t.prototype.setAvatar=function(e){this.avatarURL=e,this.avatar&&(this.avatar.style.backgroundImage="url("+e+")")},t.prototype.setName=function(e){this.name=e,this.nameElement&&(this.nameElement instanceof HTMLInputElement?this.nameElement.value=e:this.nameElement.innerHTML=e)},t}(l.BaseComponents);t.Player=p},53:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;var r=n(735),s=n(506),a=n(595);n(786);var l=function(e){function t(){var t=e.call(this,"div",["popup",a.setting.classNames.popups.closeClass])||this,n=new s.BaseComponents("div",["popup__inner"]);return t.popUp=new s.BaseComponents("div",["popup__container"]),n.element.appendChild(t.popUp.element),t.text=t.popupTextInit(),t.element.appendChild(n.element),t}return i(t,e),t.prototype.showPopup=function(){this.element.classList.remove(a.setting.classNames.popups.closeClass)},t.prototype.closePopup=function(){var e=this;return new Promise((function(t){e.element.classList.add(a.setting.classNames.popups.closeClass),e.element.addEventListener("transitionend",(function(){return t()}))}))},t.prototype.btnsInit=function(){var e=document.createElement("a");e.innerHTML="To lobby",e.href="#/Lobby",e.classList.add(a.setting.classNames.popups.popupLobbyBtn),this.popUp.element.appendChild(e);var t=document.createElement("a");t.innerHTML="Watch replay",t.href="#/Replays",t.classList.add(a.setting.classNames.popups.popupReplaysBtn),this.popUp.element.appendChild(t)},t.prototype.popupTextInit=function(){var e=document.createElement("p");return e.classList.add(a.setting.classNames.popups.popupText),this.popUp.element.appendChild(e),e},t.prototype.confirmPopupBtns=function(){var e=r.createElement([a.setting.classNames.popups.popupLobbyBtn]);e.id="confirm",e.innerHTML="Confirm",this.popUp.element.appendChild(e);var t=r.createElement([a.setting.classNames.popups.popupReplaysBtn]);return t.id="refuse",t.innerHTML="Refuse",this.popUp.element.appendChild(t),[e,t]},t}(s.BaseComponents);t.Popup=l},433:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Replay=void 0;var r=n(735),s=n(506),a=n(595);n(729);var l=function(e){function t(n,o){var i=e.call(this,"a",[a.setting.classNames.replays.replaysEach])||this;i.element.href="#/Replays/Watch-replay/"+o,i.element.title="Watch replay";var r=t.createReplayPieceElement(n.firstPlayer);i.element.appendChild(r);var s=t.addCrossImg();i.element.appendChild(s);var l=t.createReplayPieceElement(n.secondPlayer);i.element.appendChild(l);var c=t.createTimerElement(n.time);return i.element.appendChild(c),t.createCrownElement(n,r,l),i}return i(t,e),t.createReplayPieceElement=function(e){var n=r.createElement([a.setting.classNames.replays.replaysEachContainer]),o=t.createPieceProtoElement(e.color);n.appendChild(o);var i=r.createElement([a.setting.classNames.replays.playerContainer]);n.appendChild(i);var s=r.createElement([a.setting.classNames.replays.avatar]);e.player.avatarURL===a.setting.playersInitStates.playerImgURL?s.innerHTML=e.player.name[0]:s.style.backgroundImage="url("+e.player.avatarURL+")";var l=r.createElement([a.setting.classNames.replays.name]);return l.innerHTML=e.player.name,i.appendChild(s),i.appendChild(l),n},t.createPieceProtoElement=function(e){var t=e+"Pawn",n=r.createElement([a.setting.classNames.replays.piecePrototype]);return n.style.backgroundImage="url("+a.setting.imgNames[t]+")",n},t.createTimerElement=function(e){var t=r.createElement([a.setting.classNames.replays.time]);return t.innerHTML=e,t},t.createCrownElement=function(e,t,n){var o=r.createElement([a.setting.classNames.replays.crown]);o.style.backgroundImage="url("+a.setting.imgNames.crown+")",(JSON.stringify(e.firstPlayer.player)===JSON.stringify(e.winner)?t:n).appendChild(o)},t.addCrossImg=function(){var e=r.createElement([a.setting.classNames.replays.cross]);return e.style.backgroundImage="url("+a.setting.imgNames.cross+")",e},t}(s.BaseComponents);t.Replay=l},561:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{l(o.next(e))}catch(e){r(e)}}function a(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,o=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Replays=void 0;var a=n(735),l=n(690),c=n(506),p=n(433),u=n(595);n(241);var h=function(e){function t(){var t=e.call(this,"section",[u.setting.classNames.replays.replays])||this;return t.replays=[],t.container=a.createElement([u.setting.classNames.replays.replaysContainer]),t.element.appendChild(t.container),t.replaysInit(),t}return i(t,e),t.prototype.replaysInit=function(){return r(this,void 0,void 0,(function(){var e,t,n=this;return s(this,(function(o){switch(o.label){case 0:return[4,l.storage.getReplays()];case 1:return e=o.sent(),t=0,e.forEach((function(e){var o=new p.Replay(e,t++);n.replays.push(o),n.container.appendChild(o.element)})),[2]}}))}))},t}(c.BaseComponents);t.Replays=h},649:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;var o=n(595),i=function(){function e(){this.routes=[]}return e.prototype.add=function(e){this.routes.push(e)},e.prototype.newRoute=function(e){this.enumiration(e)},e.prototype.changeRoute=function(){var e=window.location.hash;e?this.enumiration(e):this.enumiration(o.setting.startPage)},e.prototype.enumiration=function(e){for(var t=0;t<this.routes.length;t++)if(-1!==e.indexOf(this.routes[t].hash)){this.routes[t].needFoo();break}},e}();t.Router=i},595:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setting=void 0;var o=n(91),i=n(443),r=n(822),s=n(767),a=n(336),l=n(278),c=n(188);t.setting={classNames:{board:"chess-board",cell:"cell",whiteCell:"white-cell",blackCell:"black-cell",numerationAll:"cell-numeration",numerationEach:"cell-nnumeration__each",letterId:"letter",numberId:"number",piece:"piece",dataPiece:"piece-type",possibleClearCell:"possible-clear-ceil",possibleEngagedCell:"possible-engaged-ceil",moveBacklight:"move-backlight",checkBacklight:"check-backlight",selectPieceBacklight:"select-piece-backlight",headers:{header:"header",container:"header__container",logo:"header-logo",logoImg:"header-logo__img",logoText:"header-logo__text",gameBtnsContainer:"header-game-btns",gameBtn:"header-game-btns__each",timer:{timer:"timer",timerEach:"timer__inner",timerColon:"timer__colon"}},lobby:{lobby:"lobby",container:"lobby__container",menu:{menu:"menu",replay:"menu-replay",replayText:"menu-replay__text",replayImg:"menu-replay__img",setting:"menu-setting",settingImg:"menu-setting__inner",start:"menu-start",startText:"menu-start__text",gameMode:"game-mode"}},player:{player:"player",avatar:"player__avatar",gameAvatar:"player__game-avatar",name:"player__name"},game:{playerStatistics:"player-statistics",playerMoveTable:"player-statistics__table",playerMoveTableEach:"player-statistics__table-each",playerMoveTableImg:"player-statistics__table-img",playerMoveTableCells:"player-statistics__table-cells",playerMoveTableTime:"player-statistics__table-time",rotate:"rotating",noRotate:"rotated",playerActive:"player-active"},popups:{closeClass:"popup_close",popupReplaysBtn:"popup__replays-btn",popupLobbyBtn:"popup__lobby-btn",popupText:"popup__text"},replays:{replays:"replays",replaysContainer:"replays__container",replaysEach:"replays__each",replaysEachContainer:"replays__each-container",piecePrototype:"replays__piece-prototype",avatar:"replays__avatar",name:"replays__name",time:"replays__time",crown:"replays__crown",cross:"replays__cross",playerContainer:"replays__player-container",headerBtns:"header-btns",headerBtn:"header-btns__each"},disable:"disable",enable:"enable"},initialGameSetup:[{cell:"a8",piece:"blackRook"},{cell:"b8",piece:"blackKnight"},{cell:"c8",piece:"blackBishop"},{cell:"d8",piece:"blackQueen"},{cell:"e8",piece:"blackKing"},{cell:"f8",piece:"blackBishop"},{cell:"g8",piece:"blackKnight"},{cell:"h8",piece:"blackRook"},{cell:"a7",piece:"blackPawn"},{cell:"b7",piece:"blackPawn"},{cell:"c7",piece:"blackPawn"},{cell:"d7",piece:"blackPawn"},{cell:"e7",piece:"blackPawn"},{cell:"f7",piece:"blackPawn"},{cell:"g7",piece:"blackPawn"},{cell:"h7",piece:"blackPawn"},{cell:"a1",piece:"whiteRook"},{cell:"b1",piece:"whiteKnight"},{cell:"c1",piece:"whiteBishop"},{cell:"d1",piece:"whiteQueen"},{cell:"e1",piece:"whiteKing"},{cell:"f1",piece:"whiteBishop"},{cell:"g1",piece:"whiteKnight"},{cell:"h1",piece:"whiteRook"},{cell:"a2",piece:"whitePawn"},{cell:"b2",piece:"whitePawn"},{cell:"c2",piece:"whitePawn"},{cell:"d2",piece:"whitePawn"},{cell:"e2",piece:"whitePawn"},{cell:"f2",piece:"whitePawn"},{cell:"g2",piece:"whitePawn"},{cell:"h2",piece:"whitePawn"}],gameSetup:[{cell:"a8",piece:"blackRook"},{cell:"b8",piece:"blackKnight"},{cell:"c8",piece:"blackBishop"},{cell:"d8",piece:"blackQueen"},{cell:"e8",piece:"blackKing"},{cell:"f8",piece:"blackBishop"},{cell:"g8",piece:"blackKnight"},{cell:"h8",piece:"blackRook"},{cell:"a7",piece:"blackPawn"},{cell:"b7",piece:"blackPawn"},{cell:"c7",piece:"blackPawn"},{cell:"d7",piece:"blackPawn"},{cell:"e7",piece:"blackPawn"},{cell:"f7",piece:"blackPawn"},{cell:"g7",piece:"blackPawn"},{cell:"h7",piece:"blackPawn"},{cell:"a1",piece:"whiteRook"},{cell:"b1",piece:"whiteKnight"},{cell:"c1",piece:"whiteBishop"},{cell:"d1",piece:"whiteQueen"},{cell:"e1",piece:"whiteKing"},{cell:"f1",piece:"whiteBishop"},{cell:"g1",piece:"whiteKnight"},{cell:"h1",piece:"whiteRook"},{cell:"a2",piece:"whitePawn"},{cell:"b2",piece:"whitePawn"},{cell:"c2",piece:"whitePawn"},{cell:"d2",piece:"whitePawn"},{cell:"e2",piece:"whitePawn"},{cell:"f2",piece:"whitePawn"},{cell:"g2",piece:"whitePawn"},{cell:"h2",piece:"whitePawn"}],imgNames:{blackQueen:"./chess/black-queen.svg",blackKing:"./chess/black-king.svg",blackBishop:"./chess/black-bishop.svg",blackKnight:"./chess/black-knight.svg",blackRook:"./chess/black-rook.svg",blackPawn:"./chess/black-pawn.svg",whiteQueen:"./chess/white-queen.svg",whiteKing:"./chess/white-king.svg",whiteBishop:"./chess/white-bishop.svg",whiteKnight:"./chess/white-knight.svg",whiteRook:"./chess/white-rook.svg",whitePawn:"./chess/white-pawn.svg",crown:"./flags/crown.svg",cross:"./flags/x.svg",leftArrow:"./header/chevron-left.svg",rightArrow:"./header/chevron-right.svg"},createFunctions:{blackQueen:function(e){return new a.Queen(e,c.color.black)},blackKing:function(e){return new i.King(e,c.color.black)},blackBishop:function(e){return new o.Bishop(e,c.color.black)},blackKnight:function(e){return new r.Knight(e,c.color.black)},blackRook:function(e){return new l.Rook(e,c.color.black)},blackPawn:function(e){return new s.Pawn(e,c.color.black)},whiteQueen:function(e){return new a.Queen(e,c.color.white)},whiteKing:function(e){return new i.King(e,c.color.white)},whiteBishop:function(e){return new o.Bishop(e,c.color.white)},whiteKnight:function(e){return new r.Knight(e,c.color.white)},whiteRook:function(e){return new l.Rook(e,c.color.white)},whitePawn:function(e){return new s.Pawn(e,c.color.white)}},isWhiteFromBelow:!0,isTwoPlayersOffline:!0,passantCell:{positiveIncrement:4,negativeIncrement:3},startPage:"#/Lobby",dataBase:{version:1,storeUserName:"user",storeGamesName:"replays"},playersInitStates:{players:["Player 1","Player 2"],playerImgURL:"../../../avatar/Unknown.png"},serverURL:"wss://ancient-oasis-48599.herokuapp.com"}},610:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.timer=void 0;var r=n(506);n(563);var s=function(e){function t(){var t=e.call(this,"div",["timer"])||this;t.timeNow=0,t.minute=new r.BaseComponents("label",["timer__inner"]),t.element.appendChild(t.minute.element);var n=new r.BaseComponents("div",["timer__colon"]);return n.element.innerHTML=":",t.element.appendChild(n.element),t.second=new r.BaseComponents("label",["timer__inner"]),t.element.appendChild(t.second.element),t.showTime(),t}return i(t,e),t.prototype.showTime=function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.minute.element.innerHTML=e<10?"0"+e:""+e,this.second.element.innerHTML=t<10?"0"+t:""+t},t.prototype.startTimer=function(){var e=this;this.timer=setInterval((function(){e.timeNow++,e.showTime(Math.floor(e.timeNow/60),e.timeNow%60)}),1e3)},t.prototype.stopTimer=function(){this.timer&&(clearInterval(this.timer),this.timer=void 0)},t.prototype.getTimeNow=function(){return this.timeNow},t.prototype.getTimer=function(){return this.timer},t.prototype.resetTimer=function(){this.timeNow=0,this.minute.element.innerHTML="00",this.second.element.innerHTML="00"},t.prototype.clearTimer=function(){this.stopTimer(),this.resetTimer()},t}(r.BaseComponents);t.timer=new s},266:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WatchReplay=void 0;var r=n(229),s=n(188),a=function(e){function t(t){var n,o=e.call(this,t)||this;o.whiteIncrement=0,o.blackIncrement=0;var i=o.getPlayerStatistics();return n=i.firstPlayer.getColor()===s.color.white?[i.firstPlayer,i.secondPlayer]:[i.secondPlayer,i.firstPlayer],o.whitePlayer=n[0],o.blackPlayer=n[1],o}return i(t,e),t.prototype.makeMove=function(e){var t,n;e?this.isWhiteMove?(t=this.whitePlayer.moveTable.getAllMoves()[this.whiteIncrement].startCell,n=this.whitePlayer.moveTable.getAllMoves()[this.whiteIncrement].endCell,this.whiteIncrement++):(t=this.blackPlayer.moveTable.getAllMoves()[this.blackIncrement].startCell,n=this.blackPlayer.moveTable.getAllMoves()[this.blackIncrement].endCell,this.blackIncrement++):this.isWhiteMove?(this.blackIncrement--,n=this.blackPlayer.moveTable.getAllMoves()[this.blackIncrement].startCell,t=this.blackPlayer.moveTable.getAllMoves()[this.blackIncrement].endCell):(this.whiteIncrement--,n=this.whitePlayer.moveTable.getAllMoves()[this.whiteIncrement].startCell,t=this.whitePlayer.moveTable.getAllMoves()[this.whiteIncrement].endCell),this.pieceActive=this.chessBoard.selectPiece(t),this.replayPieceMove(n)},t.prototype.replayPieceMove=function(e){this.pieceActive&&(this.checkBacklightRemove(),this.moveBacklightRemove(),this.moveBacklightAdd(e),this.chessBoard.pieceMove(e,this.pieceActive),this.isWhiteMove=!this.isWhiteMove,this.replayCheckMateValidation(this.pieceActive.color),this.pieceActive=void 0)},t.prototype.replayCheckMateValidation=function(e){var t,n=this.chessBoard.checkValidation(e),o=this.chessBoard.movePossibilityValidation(e);if(n&&!o){if(this.checkBacklightAdd(),!this.activePlayer)throw new Error("Active player does not exist!");this.createWinPopup(null===(t=this.activePlayer)||void 0===t?void 0:t.getName())}else n?(this.checkBacklightAdd(),console.log("check")):o||this.createDrawPopup()},t}(r.Game);t.WatchReplay=a},650:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cellCoordinatesToName=void 0,t.cellCoordinatesToName=function(e){return String.fromCharCode(e.X+97)+String(e.Y+1)}},836:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cellNameToCellPosition=void 0,t.cellNameToCellPosition=function(e){var t=e.charCodeAt(0);return 63-(8*(Number(e[1])-1)+Math.abs(t-104))}},175:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cellNameToCoordinates=void 0,t.cellNameToCoordinates=function(e){return{X:e.charCodeAt(0)-97,Y:Number(e[1])-1}}},510:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.colorFunctions=void 0;var o=n(188);t.colorFunctions={getReverseColor:function(e){return e===o.color.white?o.color.black:o.color.white},getRandomColor:function(){return Math.random()>.5?o.color.black:o.color.white}}},735:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=void 0,t.createElement=function(e){var t,n=document.createElement("div");return(t=n.classList).add.apply(t,e),n}},771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageReader=void 0;var n=function(){function e(){}return e.writeMessage=function(e,t){return e+" "+t},e.readMessage=function(e){return e.split(" ")},e}();t.MessageReader=n},513:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.timeFunctions=void 0,t.timeFunctions={getStringTime:function(e){var t=Math.floor(e/60),n=e%60;return(t<10?"0"+t:String(t))+":"+(n<10?"0"+n:String(n))},getNumberTime:function(e){var t=e.split(":"),n=t[0],o=t[1];return Number(o)+60*Number(n)}}}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e].call(r.exports,r,r.exports,o),r.exports}o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e=new(o(77).App)(document.body),window.addEventListener("hashchange",(function(){e.router.changeRoute()}))})();
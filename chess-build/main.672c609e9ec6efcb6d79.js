(()=>{"use strict";var e,t={57:(e,t,n)=>{n.r(t)},995:(e,t,n)=>{n.r(t)},978:(e,t,n)=>{n.r(t)},115:(e,t,n)=>{n.r(t)},906:(e,t,n)=>{n.r(t)},801:(e,t,n)=>{n.r(t)},457:(e,t,n)=>{n.r(t)},94:(e,t,n)=>{n.r(t)},786:(e,t,n)=>{n.r(t)},729:(e,t,n)=>{n.r(t)},241:(e,t,n)=>{n.r(t)},77:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;var r=n(690),a=n(0),s=n(229),l=n(977),c=n(381),p=n(456),u=n(561),h=n(649),d=n(266),v=function(){function e(e){this.rootElement=e,this.initDB(),this.header=new l.Header,this.rootElement.appendChild(this.header.element),this.footer=new a.Footer,this.rootElement.appendChild(this.footer.element),this.router=new h.Router}return e.prototype.initDB=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,r.storage.createDataBase()];case 1:return e.sent(),this.initRoute(),[2]}}))}))},e.prototype.initRoute=function(){var e=this;this.router.add({pageName:"watch-replays",hash:"Watch-replay",needFoo:function(){return e.startWatchReplay()}}),this.router.add({pageName:"lobby",hash:"#/Lobby",needFoo:function(){return e.startLobbyPage()}}),this.router.add({pageName:"setting",hash:"#/Setting",needFoo:function(){return e.startSettingPage()}}),this.router.add({pageName:"game",hash:"#/Game",needFoo:function(){return e.startGamePage()}}),this.router.add({pageName:"replays",hash:"#/Replays",needFoo:function(){return e.startReplaysPage()}})},e.prototype.startLobbyPage=function(){this.clearWindow(),this.lobby||(this.lobby=new c.Lobby),this.activePage=this.lobby,this.lobby.resetColorAndSocket(),this.rootElement.insertBefore(this.lobby.element,this.footer.element)},e.prototype.startSettingPage=function(){},e.prototype.startGamePage=function(){var e;this.clearWindow(),(null===(e=this.lobby)||void 0===e?void 0:e.socket)&&this.lobby.color?this.game=new p.OnlineGame(this.lobby.color,this.lobby.socket):(this.game=new s.Game,this.game.chessBoardListnersInit()),this.activePage=this.game,this.rootElement.insertBefore(this.game.element,this.footer.element)},e.prototype.startReplaysPage=function(){this.clearWindow(),this.replays=new u.Replays,this.activePage=this.replays,this.rootElement.insertBefore(this.replays.element,this.footer.element)},e.prototype.startWatchReplay=function(){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(o){switch(o.label){case 0:return this.clearWindow(),[4,e.getReplay()];case 1:return t=o.sent(),n=this.header.createReplayBtns(),this.initReplayBtnsListners(n.previousBtn,n.nextBtn),this.watchReplay=new d.WatchReplay(t),this.activePage=this.watchReplay,this.rootElement.insertBefore(this.watchReplay.element,this.footer.element),[2]}}))}))},e.getReplay=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t){return o(e,void 0,void 0,(function(){var e,n,o,a,s;return i(this,(function(i){switch(i.label){case 0:return e=window.location.hash,n=e.split("/"),o=n[n.length-1],[4,r.storage.getReplays()];case 1:return a=i.sent(),s=a[Number(o)],t(s),[2]}}))}))}))]}))}))},e.prototype.initReplayBtnsListners=function(e,t){var n=this;e.addEventListener("click",(function(){var e;null===(e=n.watchReplay)||void 0===e||e.makeMove(!1)})),t.addEventListener("click",(function(){var e;null===(e=n.watchReplay)||void 0===e||e.makeMove(!0)}))},e.prototype.clearWindow=function(){var e;null===(e=this.activePage)||void 0===e||e.element.remove()},e}();t.App=v},636:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ChessBoard=void 0;var r=n(650),a=n(836),s=n(175),l=n(443),c=n(767),p=n(278),u=n(506),h=n(188),d=n(595);n(57);var v=n(510),f=function(e){function t(t){var n=e.call(this,"div",[d.setting.classNames.board,d.setting.classNames.game.noRotate])||this;return n.pieces=[],n.allMoves=[],n.cells=n.cellsInit(),n.element.appendChild(n.boardNumerationInit("number")),n.element.appendChild(n.boardNumerationInit("letter")),n.newPlacePieces(t),n.allPossibleMoveDetermination(),n}return i(t,e),t.prototype.cellsInit=function(){for(var e=[],t=!0,n=8;n>=1;n--){for(var o=1;o<=8;o++){var i=document.createElement("div");i.id=""+String.fromCharCode(96+o)+n,t?i.classList.add(d.setting.classNames.cell,d.setting.classNames.whiteCell):i.classList.add(d.setting.classNames.cell,d.setting.classNames.blackCell),t=!t,e.push(i),this.element.appendChild(i)}t=!t}return e},t.prototype.boardNumerationInit=function(e){var t=document.createElement("div");if(t.classList.add(d.setting.classNames.numerationAll),e===d.setting.classNames.numberId){t.id=d.setting.classNames.numberId;for(var n=8;n>=1;n--){var o=document.createElement("div");o.innerHTML=String(n),o.classList.add(d.setting.classNames.numerationEach),t.appendChild(o)}}else for(t.id=d.setting.classNames.letterId,n=1;n<=8;n++){var i=document.createElement("div");i.innerHTML=String.fromCharCode(96+n),i.classList.add(d.setting.classNames.numerationEach),t.appendChild(i)}return t},t.prototype.newPlacePieces=function(e){var t=this;e.forEach((function(e){var n=e.piece,o=d.setting.createFunctions[n](e.cell);t.pieces.push(o);var i=a.cellNameToCellPosition(e.cell);t.cells[i].appendChild(o.element)}))},t.prototype.allPossibleMoveDetermination=function(){var e=this;this.pieces.forEach((function(t){t.possibleMoveDetermination(d.setting.gameSetup),e.capturingEnPassantValidation(t)})),this.castlingDetermination(),this.updateAllPossibleMoves()},t.prototype.updateAllPossibleMoves=function(){var e=this;this.allMoves=[],this.pieces.forEach((function(t){e.allMoves.push({cell:t.cell,moves:t.possibleMoves})}))},t.prototype.capturingEnPassantValidation=function(e){if(e instanceof c.Pawn){var t=s.cellNameToCoordinates(e.cell),n=e.getPawnIncrement()>0?d.setting.passantCell.positiveIncrement:d.setting.passantCell.negativeIncrement,o={X:t.X,Y:n};JSON.stringify(t)===JSON.stringify(o)&&(this.passantInDirection(e,1),this.passantInDirection(e,-1))}},t.prototype.passantInDirection=function(e,t){var n=s.cellNameToCoordinates(e.cell),o={X:n.X+t,Y:n.Y+e.getPawnIncrement()},i=r.cellCoordinatesToName(o),a={X:n.X+t,Y:n.Y},l=r.cellCoordinatesToName(a);this.passantPiecesValidation(l)&&e.possibleMoves.push(i)},t.prototype.passantPiecesValidation=function(e){for(var t=0;t<this.pieces.length;t++){var n=this.pieces[t];if(n.cell===e&&n instanceof c.Pawn&&n.canBeCapturedEnPassant)return!0}return!1},t.prototype.castlingDetermination=function(){this.castlingForEachPiece(h.color.white),this.castlingForEachPiece(h.color.black)},t.prototype.castlingForEachPiece=function(e){var t=this.kingSearcher(e),n=s.cellNameToCoordinates(t.cell);this.castlingValidationInDirection(t,1)&&t.possibleMoves.push(r.cellCoordinatesToName({X:n.X+2,Y:n.Y})),this.castlingValidationInDirection(t,-1)&&t.possibleMoves.push(r.cellCoordinatesToName({X:n.X-2,Y:n.Y}))},t.prototype.kingSearcher=function(e){for(var t=0;t<this.pieces.length;t++){var n=this.pieces[t];if(n instanceof l.King&&n.color===e)return n}throw Error("King does not exist!")},t.prototype.castlingValidationInDirection=function(e,t){if(e.isFirstMove){var n=s.cellNameToCoordinates(e.cell),o=v.colorFunctions.getReverseColor(e.color);return!this.clearCellAndRookValidation(n,t)&&!this.castlingCellInCheckValidation(o,n,t)}return!1},t.prototype.clearCellAndRookValidation=function(e,t){for(var n,o=e.X+t;o<8&&o>-1;o+=t){if(7===o||0===o){for(var i=0;i<this.pieces.length;i++)if(this.pieces[i].cell===r.cellCoordinatesToName({X:o,Y:e.Y})&&this.pieces[i]instanceof p.Rook){n=this.pieces[i];break}return!(null==n?void 0:n.isFirstMove)}var a=r.cellCoordinatesToName({X:o,Y:e.Y});for(i=0;i<d.setting.gameSetup.length;i++)if(d.setting.gameSetup[i].cell===a)return!0}throw Error("Breaking bad!")},t.prototype.castlingCellInCheckValidation=function(e,t,n){for(var o=this.possibleWhitesOrBlacksMoves(e),i=Math.abs(2*n),a=t.X;a>t.X-i&&a<t.X+i;a+=n){var s=r.cellCoordinatesToName({X:a,Y:t.Y});if(-1!==o.indexOf(s))return!0}return!1},t.prototype.getAllCells=function(){return this.cells},t.prototype.selectPiece=function(e){for(var t=0;t<this.pieces.length;t++)if(this.pieces[t].cell===e)return this.pieces[t];throw Error()},t.prototype.pieceMove=function(e,n){(n instanceof p.Rook||n instanceof l.King)&&(this.castlingMove(e,n),n.isFirstMove=!1),this.capturingEnPassantTry(e,n),this.longPawnMoveReset(),t.longPawnMoveValidation(e,n),this.capturingTry(e),n.element.remove(),this.cells[a.cellNameToCellPosition(e)].appendChild(n.element),t.updateGameSetup(e,n),n.cell=e,this.allPossibleMoveDetermination(),this.removeMovesForСheck(h.color.white),this.removeMovesForСheck(h.color.black)},t.prototype.longPawnMoveReset=function(){for(var e=0;e<this.pieces.length;e++){var t=this.pieces[e];t instanceof c.Pawn&&(t.canBeCapturedEnPassant=!1)}},t.longPawnMoveValidation=function(e,t){var n=s.cellNameToCoordinates(e),o=s.cellNameToCoordinates(t.cell);t instanceof c.Pawn&&(t.canBeCapturedEnPassant=2===Math.abs(n.Y-o.Y))},t.prototype.capturingEnPassantTry=function(e,t){if(t instanceof c.Pawn){var n=s.cellNameToCoordinates(e),o=s.cellNameToCoordinates(t.cell),i=n.X-o.X;if(i)for(var a=r.cellCoordinatesToName({X:o.X+i,Y:o.Y}),l=0;l<this.pieces.length;l++){var p=this.pieces[l];if(p instanceof c.Pawn&&p.cell===a&&p.canBeCapturedEnPassant){for(var u=0;u<d.setting.gameSetup.length;u++)if(d.setting.gameSetup[u].cell===a){d.setting.gameSetup.splice(u,1);break}p.element.remove(),this.pieces.splice(l,1);break}}}},t.updateGameSetup=function(e,t){for(var n=0;n<d.setting.gameSetup.length;n++)if(d.setting.gameSetup[n].cell===t.cell){d.setting.gameSetup[n].cell=e;break}},t.prototype.capturingTry=function(e){for(var t=0;t<this.pieces.length;t++)if(this.pieces[t].cell===e){for(var n=0;n<d.setting.gameSetup.length;n++)d.setting.gameSetup[n].cell===e&&d.setting.gameSetup.splice(n,1);this.pieces[t].element.remove(),this.pieces.splice(t,1);break}},t.prototype.castlingMove=function(e,n){var o=s.cellNameToCoordinates(e),i=s.cellNameToCoordinates(n.cell);if(n instanceof l.King&&n.isFirstMove&&(o.X===i.X+2||o.X===i.X-2)){for(var c=(o.X-i.X)/2,u=c>0?7:0,h=r.cellCoordinatesToName({X:u,Y:i.Y}),d=void 0,v=0;v<this.pieces.length;v++)if(this.pieces[v].cell===h&&this.pieces[v]instanceof p.Rook){d=this.pieces[v];break}if(!d)throw Error("Rook does not exist!");var f=r.cellCoordinatesToName({X:i.X+c,Y:i.Y});d.element.remove(),this.cells[a.cellNameToCellPosition(f)].appendChild(d.element),t.updateGameSetup(f,d),d.cell=f}},t.prototype.removeMovesForСheck=function(e){var t=JSON.parse(JSON.stringify(d.setting.gameSetup)),n=v.colorFunctions.getReverseColor(e);this.possibleMoveDeterminationInCheck(n,t)},t.prototype.possibleMoveDeterminationInCheck=function(e,n){var o=this,i=[],r=[];this.pieces.forEach((function(t){t.color===e?i.push(t):r.push(t)})),i.forEach((function(e){for(var i=e.cell,a=0;a<e.possibleMoves.length;a++){var s=o.testCapturing(n,e,r,e.possibleMoves[a]);t.moveTesting(n,e,e.possibleMoves[a]),o.testCheckValidation(n,r)&&(e.possibleMoves.splice(a,1),a--),s&&(n.push(s.capturedPieceSetup),r.push(s.capturedPiece))}t.moveTesting(n,e,i)})),this.updateAllPossibleMoves()},t.prototype.testCheckValidation=function(e,n){if(!n.length)return!1;var o=n[0].color===h.color.white?h.color.black:h.color.white,i=t.getKingPosition(e,o),r=[];return n.forEach((function(t){var n=Object.assign(Object.create(Object.getPrototypeOf(t)),t);n.possibleMoveDetermination(e),r.push.apply(r,n.possibleMoves)})),-1!==r.indexOf(i)},t.moveTesting=function(e,t,n){for(var o=0;o<e.length;o++)if(e[o].cell===t.cell&&-1!==e[o].piece.indexOf(t.color)){e[o].cell=n;break}t.cell=n},t.prototype.testCapturing=function(e,t,n,o){for(var i,r,a=0;a<e.length;a++)if(e[a].cell===o&&-1===e[a].piece.indexOf(t.color)){i=e[a],e.splice(a,1);break}for(a=0;a<n.length;a++)if(n[a].cell===o){r=n[a],n.splice(a,1);break}if(this.testCapturingEnPassant(i,r,o,e,t,n),r&&i)return{capturedPieceSetup:i,capturedPiece:r}},t.prototype.testCapturingEnPassant=function(e,t,n,o,i,a){if(i instanceof c.Pawn)for(var l=s.cellNameToCoordinates(n),p=r.cellCoordinatesToName({X:l.X,Y:l.Y-i.getPawnIncrement()}),u=0;u<a.length;u++){var h=a[u];if(h instanceof c.Pawn&&h.cell===p&&h.canBeCapturedEnPassant){for(var d=0;d<o.length;d++)if(o[d].cell===p){o[d],o.splice(d,1);break}a.splice(u,1);break}}},t.prototype.checkValidation=function(e){var n=v.colorFunctions.getReverseColor(e),o=t.getKingPosition(d.setting.gameSetup,n);return-1!==this.possibleWhitesOrBlacksMoves(e).indexOf(o)},t.prototype.movePossibilityValidation=function(e){var t=v.colorFunctions.getReverseColor(e);return!!this.possibleWhitesOrBlacksMoves(t).length},t.prototype.possibleWhitesOrBlacksMoves=function(e){var t=[];return this.pieces.forEach((function(n){n.color===e&&t.push.apply(t,n.possibleMoves)})),t},t.prototype.getCheckPieces=function(e){var n=[],o=v.colorFunctions.getReverseColor(e),i=t.getKingPosition(d.setting.gameSetup,o);return this.pieces.forEach((function(e){-1===e.possibleMoves.indexOf(i)&&e.cell!==i||n.push(e)})),n},t.getKingPosition=function(e,t){for(var n=0;n<e.length;n++)if(e[n].piece===t+"King")return e[n].cell;throw Error("King does not exist")},t}(u.BaseComponents);t.ChessBoard=f},839:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.BasePiece=void 0;var r=n(650),a=n(506),s=n(188),l=n(595),c=function(e){function t(t,n){var o=e.call(this,"img",[l.setting.classNames.piece])||this;return o.possibleMoves=[],o.cell=t,o.color=n,o}return i(t,e),t.piecesCheck=function(e,t){var n=r.cellCoordinatesToName({X:e.X,Y:e.Y}),o="";if(t.forEach((function(e){e.cell!==n||(o=e.piece)})),o)return-1!==o.indexOf(s.color.black)?s.color.black:s.color.white},t.prototype.possibleMoveCheck=function(e,n,o,i){for(var a=e.X+n,s=e.Y+o;a<8&&a>-1&&s<8&&s>-1;a+=n,s+=o){var l={X:a,Y:s},c=t.piecesCheck(l,i);if(c){c!==this.color&&this.possibleMoves.push(r.cellCoordinatesToName(l));break}this.possibleMoves.push(r.cellCoordinatesToName(l))}},t}(a.BaseComponents);t.BasePiece=c},91:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Bishop=void 0;var r=n(175),a=n(595),s=function(e){function t(t,n){var o=e.call(this,t,n)||this,i=n+"Bishop";return o.element.setAttribute(a.setting.classNames.dataPiece,i),o.element.src=a.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=r.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,-1,1,e),this.possibleMoveCheck(t,1,1,e),this.possibleMoveCheck(t,1,-1,e),this.possibleMoveCheck(t,-1,-1,e)},t}(n(839).BasePiece);t.Bishop=s},443:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.King=void 0;var r=n(650),a=n(175),s=n(595),l=n(839),c=function(e){function t(t,n){var o=e.call(this,t,n)||this;o.isFirstMove=!0;var i=n+"King";return o.element.setAttribute(s.setting.classNames.dataPiece,i),o.element.src=s.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];for(var t=a.cellNameToCoordinates(this.cell),n=t.Y-1;n<t.Y+2;n++)if(n<8&&n>-1)for(var o=t.X-1;o<t.X+2;o++)o<8&&o>-1&&l.BasePiece.piecesCheck({X:o,Y:n},e)!==this.color&&this.possibleMoves.push(r.cellCoordinatesToName({X:o,Y:n}))},t}(l.BasePiece);t.King=c},822:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Knight=void 0;var r=n(650),a=n(175),s=n(595),l=n(839),c=function(e){function t(t,n){var o=e.call(this,t,n)||this,i=n+"Knight";return o.element.setAttribute(s.setting.classNames.dataPiece,i),o.element.src=s.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=a.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,1,2,e),this.possibleMoveCheck(t,-1,2,e),this.possibleMoveCheck(t,1,-2,e),this.possibleMoveCheck(t,-1,-2,e),this.possibleMoveCheck(t,2,1,e),this.possibleMoveCheck(t,2,-1,e),this.possibleMoveCheck(t,-2,1,e),this.possibleMoveCheck(t,-2,-1,e)},t.prototype.possibleMoveCheck=function(e,t,n,o){var i=e.X+t,a=e.Y+n;i<8&&i>-1&&a<8&&a>-1&&l.BasePiece.piecesCheck({X:i,Y:a},o)!==this.color&&this.possibleMoves.push(r.cellCoordinatesToName({X:i,Y:a}))},t}(l.BasePiece);t.Knight=c},767:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Pawn=void 0;var r=n(650),a=n(175),s=n(188),l=n(595),c=n(839),p=function(e){function t(t,n){var o,i,r=e.call(this,t,n)||this;r.canBeCapturedEnPassant=!1;var a=n+"Pawn";return r.element.setAttribute(l.setting.classNames.dataPiece,a),r.element.src=l.setting.imgNames[a],l.setting.isWhiteFromBelow?(o=r.color===s.color.white?[1,"2"]:[-1,"7"],r.pawnIncrement=o[0],r.startRow=o[1]):(i=r.color===s.color.white?[-1,"7"]:[1,"2"],r.pawnIncrement=i[0],r.startRow=i[1]),r}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=a.cellNameToCoordinates(this.cell);this.possiblePawnMoveCheck(t,e)&&this.cell[1]===this.startRow&&this.possiblePawnMoveCheck({X:t.X,Y:t.Y+this.pawnIncrement},e),this.possibleCaptureCheck(t,-1,e),this.possibleCaptureCheck(t,1,e)},t.prototype.possiblePawnMoveCheck=function(e,t){var n=e.Y+this.pawnIncrement;return n<8&&n>-1&&!c.BasePiece.piecesCheck({X:e.X,Y:n},t)&&(this.possibleMoves.push(r.cellCoordinatesToName({X:e.X,Y:n})),!0)},t.prototype.possibleCaptureCheck=function(e,t,n){var o=e.X+t,i=e.Y+this.pawnIncrement;o<8&&o>-1&&i<8&&i>-1&&c.BasePiece.piecesCheck({X:o,Y:i},n)&&c.BasePiece.piecesCheck({X:o,Y:i},n)!==this.color&&this.possibleMoves.push(r.cellCoordinatesToName({X:o,Y:i}))},t.prototype.getPawnIncrement=function(){return this.pawnIncrement},t}(c.BasePiece);t.Pawn=p},336:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Queen=void 0;var r=n(175),a=n(595),s=function(e){function t(t,n){var o=e.call(this,t,n)||this,i=n+"Queen";return o.element.setAttribute(a.setting.classNames.dataPiece,i),o.element.src=a.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=r.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,-1,1,e),this.possibleMoveCheck(t,0,1,e),this.possibleMoveCheck(t,1,1,e),this.possibleMoveCheck(t,1,0,e),this.possibleMoveCheck(t,1,-1,e),this.possibleMoveCheck(t,0,-1,e),this.possibleMoveCheck(t,-1,-1,e),this.possibleMoveCheck(t,-1,0,e)},t}(n(839).BasePiece);t.Queen=s},278:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Rook=void 0;var r=n(175),a=n(595),s=function(e){function t(t,n){var o=e.call(this,t,n)||this;o.isFirstMove=!0;var i=n+"Rook";return o.element.setAttribute(a.setting.classNames.dataPiece,i),o.element.src=a.setting.imgNames[i],o}return i(t,e),t.prototype.possibleMoveDetermination=function(e){this.possibleMoves=[];var t=r.cellNameToCoordinates(this.cell);this.possibleMoveCheck(t,0,1,e),this.possibleMoveCheck(t,0,-1,e),this.possibleMoveCheck(t,1,0,e),this.possibleMoveCheck(t,-1,0,e)},t.prototype.getPossibleMoves=function(){return this.possibleMoves},t}(n(839).BasePiece);t.Rook=s},690:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.storage=void 0;var o=n(491);t.storage=new o.DataBase},491:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DataBase=void 0;var o=n(595),i=function(){function e(){}return e.prototype.createDataBase=function(){var e=this;return new Promise((function(t){var n=indexedDB.open("Chess",o.setting.dataBase.version);n.onupgradeneeded=function(){e.dataBase=n.result,e.dataBase.createObjectStore(o.setting.dataBase.storeUserName,{keyPath:"counter"}),e.dataBase.createObjectStore(o.setting.dataBase.storeGamesName,{autoIncrement:!0})},n.onsuccess=function(){e.dataBase=n.result,t()},n.onerror=function(){throw Error("Error opening database!")}}))},e.prototype.addPlayer=function(e,t,n){var i,r=null===(i=this.dataBase)||void 0===i?void 0:i.transaction([o.setting.dataBase.storeUserName],"readwrite");if(!r)throw Error("Data base not exist!");var a={player:e,counter:t,color:n};r.objectStore(o.setting.dataBase.storeUserName).put(a),r.oncomplete=function(){console.log("Player saved!")},r.onerror=function(){console.log("Error storing player!")}},e.prototype.getPlayers=function(){var e=this;return new Promise((function(t){var n,i=null===(n=e.dataBase)||void 0===n?void 0:n.transaction([o.setting.dataBase.storeUserName],"readonly");if(!i)throw Error("Data base not exist!");var r=i.objectStore(o.setting.dataBase.storeUserName).openCursor(),a=[];r.onsuccess=function(){var e=r.result;e?(a.push(e.value.player),e.continue()):t(a)},r.onerror=function(){throw Error("Error with cursor request!")}}))},e.prototype.addReplay=function(e,t,n,i){var r,a=null===(r=this.dataBase)||void 0===r?void 0:r.transaction([o.setting.dataBase.storeGamesName],"readwrite");if(!a)throw Error("Data base not exist!");var s={firstPlayer:e,secondPlayer:t,winner:n,time:i};a.objectStore(o.setting.dataBase.storeGamesName).put(s),a.oncomplete=function(){console.log("Replay saved!")},a.onerror=function(){console.log("Error storing replay!")}},e.prototype.getReplays=function(){var e=this;return new Promise((function(t){var n,i=null===(n=e.dataBase)||void 0===n?void 0:n.transaction([o.setting.dataBase.storeGamesName],"readonly");if(!i)throw Error("Data base not exist!");var r=i.objectStore(o.setting.dataBase.storeGamesName).openCursor(),a=[];r.onsuccess=function(){var e=r.result;e?(a.push(e.value),e.continue()):t(a)},r.onerror=function(){throw Error("Error with cursor request!")}}))},e}();t.DataBase=i},0:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0;var r=n(506);n(995);var a=function(e){function t(){var t=e.call(this,"footer",["footer"])||this;return t.element.innerHTML='\n    <div class="footer__container">\n      <a class="footer__link" href="https://github.com/Dauniusha">GitHub</a>\n      <span class="footer__text">RS School 2021</span>\n    </div>\n    ',t}return i(t,e),t}(r.BaseComponents);t.Footer=a},229:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var s=n(510),l=n(636),c=n(690),p=n(506),u=n(188),h=n(874),d=n(53),v=n(595);n(978);var f=function(e){function t(t,n){var o,i,r=e.call(this,"section",["game"])||this;return r.possibleCells=[],r.isWhiteMove=!0,t?(o=r.replayPlayerInit(t.firstPlayer,t.secondPlayer),r.firstPlayer=o[0],r.secondPlayer=o[1],setTimeout((function(){r.addMoveHolder()}),200),r.chessBoard=new l.ChessBoard(v.setting.initialGameSetup),r.element.insertBefore(r.chessBoard.element,r.secondPlayer.element)):(i=r.playerInit(n),r.firstPlayer=i[0],r.secondPlayer=i[1],setTimeout((function(){r.addMoveHolder()}),200),r.chessBoard=new l.ChessBoard(v.setting.initialGameSetup),r.element.insertBefore(r.chessBoard.element,r.secondPlayer.element)),r}return i(t,e),t.prototype.playerInit=function(e){e||(e=s.colorFunctions.getRandomColor());var t=new h.PlayerStatistics({color:e,counter:0});this.element.appendChild(t.element);var n=s.colorFunctions.getReverseColor(e),o=new h.PlayerStatistics({color:n,counter:1});return this.element.appendChild(o.element),[t,o]},t.prototype.replayPlayerInit=function(e,t){var n=new h.PlayerStatistics(void 0,{player:e,counter:0});this.element.appendChild(n.element);var o=new h.PlayerStatistics(void 0,{player:t,counter:1});return this.element.appendChild(o.element),[n,o]},t.prototype.getChessBoard=function(){return this.chessBoard},t.prototype.chessBoardListnersInit=function(){var e=this;this.chessBoard.element.addEventListener("click",(function(t){var n,o,i,r,a,s,l=null===(n=t.target)||void 0===n?void 0:n.closest("."+v.setting.classNames.piece);if(e.isWhiteMove?u.color.white:u.color.black,(null===(o=t.target)||void 0===o?void 0:o.closest("."+v.setting.classNames.possibleClearCell))||(null===(i=t.target)||void 0===i?void 0:i.closest("."+v.setting.classNames.possibleEngagedCell)))(c=null===(r=t.target)||void 0===r?void 0:r.closest("."+v.setting.classNames.cell))&&(e.pieceMove(c.id),e.isWhiteMove=!e.isWhiteMove,e.addMoveHolder());else if(l){var c;(c=null===(a=t.target)||void 0===a?void 0:a.closest("."+v.setting.classNames.cell))&&(null===(s=e.pieceActive)||void 0===s?void 0:s.cell)!==c.id?e.selectPiece(c.id):(e.possibleCellsBacklightRemove(),e.pieceActive=void 0)}else e.possibleCellsBacklightRemove()}))},t.prototype.selectPiece=function(e){this.possibleCellsBacklightRemove(),this.pieceActive=this.chessBoard.selectPiece(e),this.possibleCellsBacklightAdd()},t.prototype.possibleCellsBacklightAdd=function(){var e,t,n,o=this,i=this.chessBoard.getAllCells();null===(t=null===(e=this.pieceActive)||void 0===e?void 0:e.element.parentElement)||void 0===t||t.classList.add(v.setting.classNames.selectPieceBacklight),null===(n=this.pieceActive)||void 0===n||n.possibleMoves.forEach((function(e){i.forEach((function(t){e===t.id&&(t.childElementCount?t.classList.add(v.setting.classNames.possibleEngagedCell):t.classList.add(v.setting.classNames.possibleClearCell),o.possibleCells.push(t))}))}))},t.prototype.possibleCellsBacklightRemove=function(){var e,t;null===(t=null===(e=this.pieceActive)||void 0===e?void 0:e.element.parentElement)||void 0===t||t.classList.remove(v.setting.classNames.selectPieceBacklight),this.possibleCells.forEach((function(e){e.classList.remove(v.setting.classNames.possibleClearCell),e.classList.remove(v.setting.classNames.possibleEngagedCell)})),this.possibleCells=[]},t.prototype.pieceMove=function(e){this.pieceActive&&(this.checkBacklightRemove(),this.moveBacklightRemove(),this.possibleCellsBacklightRemove(),this.moveBacklightAdd(e),this.takeActivePlayer(e),this.chessBoard.pieceMove(e,this.pieceActive),this.checkMateValidation(this.pieceActive.color),this.pieceActive=void 0)},t.prototype.takeActivePlayer=function(e){var t,n;if(!this.pieceActive)throw new Error("pieceActive does not exist!");this.activePlayer=this.pieceActive.color===(null===(t=this.firstPlayer)||void 0===t?void 0:t.getColor())?this.firstPlayer:this.secondPlayer,null===(n=this.activePlayer)||void 0===n||n.moveTable.addMove(this.pieceActive.constructor.name,this.activePlayer.getColor(),this.pieceActive.cell,e)},t.prototype.moveBacklightAdd=function(e){var t=this;this.chessBoard.getAllCells().forEach((function(n){var o;(null===(o=t.pieceActive)||void 0===o?void 0:o.cell)!==n.id&&e!==n.id||n.classList.add(v.setting.classNames.moveBacklight)}))},t.prototype.moveBacklightRemove=function(){this.chessBoard.getAllCells().forEach((function(e){e.classList.contains(v.setting.classNames.moveBacklight)&&e.classList.remove(v.setting.classNames.moveBacklight)}))},t.prototype.checkMateValidation=function(e){var t,n=this.chessBoard.checkValidation(e),o=this.chessBoard.movePossibilityValidation(e);n&&!o?(this.checkBacklightAdd(),this.createEndGame(!0,null===(t=this.activePlayer)||void 0===t?void 0:t.getName())):n?(this.checkBacklightAdd(),console.log("check")):o||this.createEndGame(!1)},t.prototype.createEndGame=function(e,t){void 0===t&&(t=""),e?this.createWinPopup(t):this.createDrawPopup(),this.createReplay()},t.prototype.createReplay=function(){var e,t,n;if(this.firstPlayer&&this.secondPlayer&&this.activePlayer){var o=null===(e=this.firstPlayer)||void 0===e?void 0:e.getPlayerWithMoves(),i=null===(t=this.secondPlayer)||void 0===t?void 0:t.getPlayerWithMoves(),r=null===(n=this.activePlayer)||void 0===n?void 0:n.getPlayer().getNameWithAvatar();c.storage.addReplay(o,i,r,"1:30")}},t.prototype.createWinPopup=function(e){this.createPopup(e+" won!")},t.prototype.createDrawPopup=function(){this.createPopup("Draw!")},t.prototype.createPopup=function(e){var t=this,n=new d.Popup;n.text.innerHTML=e,this.element.appendChild(n.element),n.showPopup(),n.element.addEventListener("click",(function(){return r(t,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,n.closePopup()];case 1:return e.sent(),n.element.remove(),[2]}}))}))}),{once:!0})},t.prototype.checkBacklightAdd=function(){this.pieceActive&&(this.checkPieces=this.chessBoard.getCheckPieces(this.pieceActive.color),this.checkPieces.forEach((function(e){var t;null===(t=e.element.parentElement)||void 0===t||t.classList.add(v.setting.classNames.checkBacklight)})))},t.prototype.checkBacklightRemove=function(){this.checkPieces&&this.checkPieces.forEach((function(e){var t;null===(t=e.element.parentElement)||void 0===t||t.classList.remove(v.setting.classNames.checkBacklight)}))},t.prototype.checkRotateChessBoard=function(){v.setting.isTwoPlayersOffline&&this.rotateChessBoard()},t.prototype.rotateChessBoard=function(){this.chessBoard.element.classList.toggle(v.setting.classNames.game.rotate),this.chessBoard.element.classList.toggle(v.setting.classNames.game.noRotate)},t.prototype.addMoveHolder=function(){var e,t,n=(null===(e=this.firstPlayer)||void 0===e?void 0:e.getColor())===u.color.white?this.firstPlayer:this.secondPlayer,o=(null===(t=this.firstPlayer)||void 0===t?void 0:t.getColor())===u.color.black?this.firstPlayer:this.secondPlayer;this.isWhiteMove?(null==n||n.getPlayer().getAvatar().classList.add(v.setting.classNames.game.playerActive),null==o||o.getPlayer().getAvatar().classList.remove(v.setting.classNames.game.playerActive)):(null==n||n.getPlayer().getAvatar().classList.remove(v.setting.classNames.game.playerActive),null==o||o.getPlayer().getAvatar().classList.add(v.setting.classNames.game.playerActive))},t.prototype.getPlayerStatistics=function(){if(this.firstPlayer&&this.secondPlayer)return{firstPlayer:this.firstPlayer,secondPlayer:this.secondPlayer};throw new Error("players does not exist!")},t}(p.BaseComponents);t.Game=f},977:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;var r=n(735),a=n(506),s=n(595);n(115);var l=function(e){function t(){var t=e.call(this,"header",[s.setting.classNames.headers.header])||this;return t.container=document.createElement("div"),t.container.classList.add(s.setting.classNames.headers.container),t.element.appendChild(t.container),t.addLogo(),t}return i(t,e),t.prototype.addLogo=function(){var e=document.createElement("div");e.classList.add(s.setting.classNames.headers.logo),e.innerHTML='\n      <img class="'+s.setting.classNames.headers.logoImg+'" src="./logo/logo.svg">\n      <span class="'+s.setting.classNames.headers.logoText+'">Chess</span>\n    ',this.container.appendChild(e)},t.prototype.createReplayBtns=function(){var e=r.createElement([s.setting.classNames.replays.headerBtns]);return this.previousMoveBtn=r.createElement([s.setting.classNames.replays.headerBtn]),this.previousMoveBtn.style.backgroundImage="url("+s.setting.imgNames.leftArrow+")",e.appendChild(this.previousMoveBtn),this.nextMoveBtn=r.createElement([s.setting.classNames.replays.headerBtn]),this.nextMoveBtn.style.backgroundImage="url("+s.setting.imgNames.rightArrow+")",e.appendChild(this.nextMoveBtn),this.container.appendChild(e),{previousBtn:this.previousMoveBtn,nextBtn:this.nextMoveBtn}},t}(a.BaseComponents);t.Header=l},381:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Lobby=void 0;var r=n(735),a=n(690),s=n(506),l=n(559),c=n(595);n(906);var p=function(e){function t(){var n,o=e.call(this,"section",[c.setting.classNames.lobby.lobby])||this;o.container=r.createElement([c.setting.classNames.lobby.container]),o.element.appendChild(o.container);var i=o.playerBlockInit();o.playerFirst=new l.Player({writable:!0,counter:0}),o.replaysBtn=t.replaysBtnInit(),i.appendChild(o.playerFirst.element),i.appendChild(o.replaysBtn),n=t.startBtnAndSwicherInit(),o.startGameBtn=n[0],o.startTextElement=n[1],o.gameSwitcherBtn=n[2],o.container.appendChild(o.startGameBtn),o.initStartListner(),o.initToogleListner();var a=o.playerBlockInit();return o.playerSecond=new l.Player({writable:!0,counter:1}),o.settingBtn=t.settingBtnInit(),a.appendChild(o.playerSecond.element),a.appendChild(o.settingBtn),o}return i(t,e),t.prototype.playerBlockInit=function(){var e=document.createElement("div");return e.classList.add("player-menu"),this.container.appendChild(e),e},t.replaysBtnInit=function(){var e=document.createElement("a");return e.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.replay),e.href="#/Replays",e.innerHTML='\n      <p class="'+c.setting.classNames.lobby.menu.replayText+'">View replays</p>\n      <img class="'+c.setting.classNames.lobby.menu.replayImg+'" src="./lobby/replays/play-button.svg" alt="play">\n    ',e},t.settingBtnInit=function(){var e=document.createElement("a");return e.href="#/Setting",e.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.setting),e.innerHTML='\n      <img class="'+c.setting.classNames.lobby.menu.settingImg+'" src="./lobby/setting/settings.svg" alt="setting">\n    ',e},t.startBtnAndSwicherInit=function(){var e=r.createElement([c.setting.classNames.lobby.menu.start]),t=document.createElement("a");t.href="#/Game",t.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.startText),t.innerHTML="Start";var n=document.createElement("div");return n.classList.add(c.setting.classNames.lobby.menu.menu,c.setting.classNames.lobby.menu.gameMode),n.dataset.mode="online",n.innerHTML='\n      <div class="game-mode__text" id="online">Online</div>\n      <div class="game-mode__text" id="offline">Offline</div>\n    ',e.appendChild(t),e.appendChild(n),[e,t,n]},t.prototype.initToogleListner=function(){var e=this;this.gameSwitcherBtn.addEventListener("click",(function(){var t="online";"online"===e.gameSwitcherBtn.dataset.mode&&(e.resetOnlineSearch(),t="offline"),e.startGameBtn.dataset.mode="start-"+t,e.gameSwitcherBtn.dataset.mode=t}))},t.prototype.resetOnlineSearch=function(){this.removeBlockBtns(),this.resetColorAndSocket()},t.prototype.initStartListner=function(){var e=this;this.startTextElement.addEventListener("click",(function(t){"online"===e.gameSwitcherBtn.dataset.mode?(t.preventDefault(),e.initSocket()):(a.storage.addPlayer(e.playerFirst.getNameWithAvatar(),0),a.storage.addPlayer(e.playerSecond.getNameWithAvatar(),1))}))},t.prototype.initSocket=function(){var e=this;this.socket=new WebSocket(c.setting.serverURL),this.socket.addEventListener("open",(function(){e.socket&&e.socket.addEventListener("message",(function(t){e.newMessage(t.data)}))}))},t.prototype.newMessage=function(e){var t,n;switch(e){case"loading":this.blockBtns();break;case"connected":null===(t=this.socket)||void 0===t||t.send("name "+this.playerFirst.getName()),null===(n=this.socket)||void 0===n||n.send("avatar "+this.playerFirst.getAvatarURL());break;case"white":case"black":this.color=e;break;default:var o=e.split(" ");switch(o[0]){case"name":this.playerSecond.setName(o.splice(1).join(" "));break;case"avatar":this.playerSecond.setAvatar(o[1]),a.storage.addPlayer(this.playerFirst.getNameWithAvatar(),0,this.color),a.storage.addPlayer(this.playerSecond.getNameWithAvatar(),1),window.location.hash="#/Game"}}},t.prototype.resetColorAndSocket=function(){var e;this.color=void 0,null===(e=this.socket)||void 0===e||e.close(),this.socket=void 0},t.prototype.blockBtns=function(){this.startTextElement.classList.add(c.setting.classNames.disable),this.playerSecond.element.classList.add(c.setting.classNames.disable)},t.prototype.removeBlockBtns=function(){this.startTextElement.classList.remove(c.setting.classNames.disable),this.playerSecond.element.classList.remove(c.setting.classNames.disable)},t}(s.BaseComponents);t.Lobby=p},506:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponents=void 0;t.BaseComponents=function(e,t){var n;void 0===e&&(e="div"),void 0===t&&(t=[]),this.element=document.createElement(e),(n=this.element.classList).add.apply(n,t)}},188:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.color=void 0,t.color={white:"white",black:"black"}},152:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.MoveTable=void 0;var r=n(506),a=n(467),s=n(595);n(801);var l=function(e){function t(){var t=e.call(this,"div",[s.setting.classNames.game.playerMoveTable])||this;return t.fullPieceName=[],t}return i(t,e),t.prototype.addMove=function(e,t,n,o){var i=t+e,r=new a.Move(i,n,o);this.fullPieceName.push(r),this.element.appendChild(r.element)},t.prototype.moveInit=function(e){var t=this;e.forEach((function(e){var n=new a.Move(e.fullName,e.startCell,e.endCell);t.fullPieceName.push(n),t.element.appendChild(n.element)}))},t.prototype.takeMove=function(e){return this.fullPieceName[e]},t.prototype.getAllMoves=function(){var e=[];return this.fullPieceName.forEach((function(t){e.push(t.getClearMove())})),e},t.prototype.getAllMovesElement=function(){return this.fullPieceName},t}(r.BaseComponents);t.MoveTable=l},467:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Move=void 0;var r=n(735),a=n(506),s=n(595);n(457);var l=function(e){function t(t,n,o,i){void 0===i&&(i="1:30");var a=e.call(this,"div",[s.setting.classNames.game.playerMoveTableEach])||this;a.fullName=t,a.startCell=n,a.endCell=o,a.time=i;var l=r.createElement([s.setting.classNames.game.playerMoveTableImg]);l.style.backgroundImage="url("+s.setting.imgNames[a.fullName]+")";var c=r.createElement([s.setting.classNames.game.playerMoveTableCells]);c.innerHTML=a.startCell+" - "+a.endCell;var p=r.createElement([s.setting.classNames.game.playerMoveTableTime]);return p.innerHTML=a.time,a.element.appendChild(l),a.element.appendChild(c),a.element.appendChild(p),a}return i(t,e),t.prototype.getClearMove=function(){return{fullName:this.fullName,startCell:this.startCell,endCell:this.endCell,time:this.time}},t}(a.BaseComponents);t.Move=l},456:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineGame=void 0;var r=n(229),a=n(771),s=n(188),l=n(595),c=function(e){function t(t,n){var o=e.call(this,void 0,t)||this;return o.socket=n,"black"===t&&o.rotateChessBoard(),o.color=t,o.initListner(),o.makeMoveAndSendData(),o}return i(t,e),t.prototype.initListner=function(){var e=this;this.socket.addEventListener("message",(function(t){e.makeEnemyOnlineMove(t.data)})),this.socket.addEventListener("close",(function(){var t;e.createEndGame(!0,null===(t=e.secondPlayer)||void 0===t?void 0:t.getName())}))},t.prototype.makeEnemyOnlineMove=function(e){var t;if("disconnected"!==e){var n=a.MessageReader.readMessage(e),o=n[0],i=n[1];this.pieceActive=this.chessBoard.selectPiece(o),this.pieceMove(i),this.isWhiteMove=!this.isWhiteMove,this.addMoveHolder()}else this.createEndGame(!0,null===(t=this.firstPlayer)||void 0===t?void 0:t.getName())},t.prototype.makeMoveAndSendData=function(){var e=this;this.chessBoard.element.addEventListener("click",(function(t){var n,o,i,r,c,p,u,h,d,v=null===(n=t.target)||void 0===n?void 0:n.closest("."+l.setting.classNames.piece),f=e.isWhiteMove?s.color.white:s.color.black;if((null===(o=t.target)||void 0===o?void 0:o.closest("."+l.setting.classNames.possibleClearCell))||(null===(i=t.target)||void 0===i?void 0:i.closest("."+l.setting.classNames.possibleEngagedCell)))(y=null===(r=t.target)||void 0===r?void 0:r.closest("."+l.setting.classNames.cell))&&e.pieceActive&&(console.log(null===(c=e.pieceActive)||void 0===c?void 0:c.cell),e.socket.send(a.MessageReader.writeMessage(null===(p=e.pieceActive)||void 0===p?void 0:p.cell,y.id)),e.pieceMove(y.id),e.isWhiteMove=!e.isWhiteMove,e.addMoveHolder());else if(v&&-1!==(null===(u=v.getAttribute(l.setting.classNames.dataPiece))||void 0===u?void 0:u.indexOf(f))&&f===e.color){var y;(y=null===(h=t.target)||void 0===h?void 0:h.closest("."+l.setting.classNames.cell))&&(null===(d=e.pieceActive)||void 0===d?void 0:d.cell)!==y.id?e.selectPiece(y.id):(e.possibleCellsBacklightRemove(),e.pieceActive=void 0)}else e.possibleCellsBacklightRemove()}))},t}(r.Game);t.OnlineGame=c},874:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerStatistics=void 0;var r=n(506),a=n(152),s=n(559),l=n(595);n(94);var c=function(e){function t(t,n){var o=e.call(this,"div",[l.setting.classNames.game.playerStatistics])||this;if(t)o.color=t.color,o.player=new s.Player({writable:!1,counter:t.counter}),o.moveTable=new a.MoveTable;else{if(!n)throw new Error("All parametr is invalid!");o.color=n.player.color,o.player=new s.Player(void 0,{avatarURL:n.player.player.avatarURL,name:n.player.player.name}),o.moveTable=new a.MoveTable,o.moveTable.moveInit(n.player.moves)}return o.element.appendChild(o.player.element),o.element.appendChild(o.moveTable.element),o}return i(t,e),t.prototype.getColor=function(){return this.color},t.prototype.getName=function(){return this.player.getName()},t.prototype.getPlayer=function(){return this.player},t.prototype.getPlayerWithMoves=function(){return{player:this.player.getNameWithAvatar(),moves:this.moveTable.getAllMoves(),color:this.color}},t}(r.BaseComponents);t.PlayerStatistics=c},559:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;var s=n(690),l=n(506),c=n(595),p=function(e){function t(t,n){var o=e.call(this,"div",[c.setting.classNames.player.player])||this;return t?t.writable?o.playerInit(t.counter):o.getPlayer(t.counter):n&&o.createClearPlayer(n.avatarURL,n.name),o}return i(t,e),t.prototype.playerInit=function(e){return r(this,void 0,void 0,(function(){var t,n,o,i;return a(this,(function(r){switch(r.label){case 0:return[4,s.storage.getPlayers()];case 1:return t=r.sent(),i=t[e]?[t[e].avatarURL,t[e].name]:[c.setting.playersInitStates.playerImgURL,c.setting.playersInitStates.players[e]],this.avatarURL=i[0],this.name=i[1],(n=document.createElement("input")).type="file",n.classList.add(c.setting.classNames.player.avatar),n.style.backgroundImage="url("+this.avatarURL+")",this.avatar=n,this.element.appendChild(n),this.upload(n),(o=document.createElement("input")).classList.add(c.setting.classNames.player.name),o.type="text",o.value=this.name,this.nameElement=o,this.element.appendChild(o),this.input(o),[2]}}))}))},t.prototype.getPlayer=function(e){return r(this,void 0,void 0,(function(){var t,n;return a(this,(function(o){switch(o.label){case 0:return[4,s.storage.getPlayers()];case 1:return t=o.sent(),n=t[e]?[t[e].avatarURL,t[e].name]:[c.setting.playersInitStates.playerImgURL,c.setting.playersInitStates.players[e]],this.avatarURL=n[0],this.name=n[1],this.createClearPlayer(this.avatarURL,this.name),[2]}}))}))},t.prototype.createClearPlayer=function(e,t){var n=document.createElement("div");n.classList.add(c.setting.classNames.player.gameAvatar),e!==c.setting.playersInitStates.playerImgURL?n.style.backgroundImage="url("+e+")":n.innerHTML=t[0],this.avatar=n,this.element.appendChild(n);var o=document.createElement("div");o.classList.add(c.setting.classNames.player.name),o.innerHTML=t,this.nameElement=o,this.element.appendChild(o)},t.prototype.upload=function(e){var t=this;e.addEventListener("change",(function(){var n=new FileReader;if(!e.files)throw Error("Files for avatar does not exist!");var o=e.files[0];n.readAsDataURL(o),n.onload=function(){t.avatarURL=n.result,e.style.background="url("+n.result+") center no-repeat",e.style.backgroundSize="cover"}}))},t.prototype.input=function(e){var t=this;e.addEventListener("input",(function(){t.name=e.value}))},t.prototype.getName=function(){if(this.name)return this.name;throw new Error("Name does not exist!")},t.prototype.getNameWithAvatar=function(){if(this.avatarURL&&this.name)return{avatarURL:this.avatarURL,name:this.name};throw new Error("Name or avatar does not exist!")},t.prototype.getAvatar=function(){if(this.avatar)return this.avatar;throw new Error("Avatar does not exist!")},t.prototype.getAvatarURL=function(){if(this.avatarURL)return this.avatarURL;throw new Error("Avatar URL does not exist!")},t.prototype.setAvatar=function(e){this.avatarURL=e,this.avatar&&(this.avatar.style.backgroundImage="url("+e+")")},t.prototype.setName=function(e){this.name=e,this.nameElement&&(this.nameElement instanceof HTMLInputElement?this.nameElement.value=e:this.nameElement.innerHTML=e)},t}(l.BaseComponents);t.Player=p},53:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0;var r=n(506),a=n(595);n(786);var s=function(e){function t(){var t=e.call(this,"div",["popup",a.setting.classNames.popups.closeClass])||this,n=new r.BaseComponents("div",["popup__inner"]);return t.popUp=new r.BaseComponents("div",["popup__container"]),n.element.appendChild(t.popUp.element),t.text=t.popupTextInit(),t.btnsInit(),t.element.appendChild(n.element),t}return i(t,e),t.prototype.showPopup=function(){this.element.classList.remove(a.setting.classNames.popups.closeClass)},t.prototype.closePopup=function(){var e=this;return new Promise((function(t){e.element.classList.add(a.setting.classNames.popups.closeClass),e.element.addEventListener("transitionend",(function(){return t()}))}))},t.prototype.btnsInit=function(){var e=document.createElement("a");e.innerHTML="To lobby",e.href="#/Lobby",e.classList.add(a.setting.classNames.popups.popupLobbyBtn),this.popUp.element.appendChild(e);var t=document.createElement("a");t.innerHTML="Watch replay",t.href="#/Replays",t.classList.add(a.setting.classNames.popups.popupReplaysBtn),this.popUp.element.appendChild(t)},t.prototype.popupTextInit=function(){var e=document.createElement("p");return e.classList.add(a.setting.classNames.popups.popupText),this.popUp.element.appendChild(e),e},t}(r.BaseComponents);t.Popup=s},433:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Replay=void 0;var r=n(735),a=n(506),s=n(595);n(729);var l=function(e){function t(n,o){var i=e.call(this,"a",[s.setting.classNames.replays.replaysEach])||this;i.element.href="#/Replays/Watch-replay/"+o,i.element.title="Watch replay";var r=t.createReplayPieceElement(n.firstPlayer);i.element.appendChild(r);var a=t.addCrossImg();i.element.appendChild(a);var l=t.createReplayPieceElement(n.secondPlayer);i.element.appendChild(l);var c=t.createTimerElement(n.time);return i.element.appendChild(c),t.createCrownElement(n,r,l),i}return i(t,e),t.createReplayPieceElement=function(e){var n=r.createElement([s.setting.classNames.replays.replaysEachContainer]),o=t.createPieceProtoElement(e.color);n.appendChild(o);var i=r.createElement([s.setting.classNames.replays.playerContainer]);n.appendChild(i);var a=r.createElement([s.setting.classNames.replays.avatar]);e.player.avatarURL===s.setting.playersInitStates.playerImgURL?a.innerHTML=e.player.name[0]:a.style.backgroundImage="url("+e.player.avatarURL+")";var l=r.createElement([s.setting.classNames.replays.name]);return l.innerHTML=e.player.name,i.appendChild(a),i.appendChild(l),n},t.createPieceProtoElement=function(e){var t=e+"Pawn",n=r.createElement([s.setting.classNames.replays.piecePrototype]);return n.style.backgroundImage="url("+s.setting.imgNames[t]+")",n},t.createTimerElement=function(e){var t=r.createElement([s.setting.classNames.replays.time]);return t.innerHTML=e,t},t.createCrownElement=function(e,t,n){var o=r.createElement([s.setting.classNames.replays.crown]);o.style.backgroundImage="url("+s.setting.imgNames.crown+")",(JSON.stringify(e.firstPlayer.player)===JSON.stringify(e.winner)?t:n).appendChild(o)},t.addCrossImg=function(){var e=r.createElement([s.setting.classNames.replays.cross]);return e.style.backgroundImage="url("+s.setting.imgNames.cross+")",e},t}(a.BaseComponents);t.Replay=l},561:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Replays=void 0;var s=n(735),l=n(690),c=n(506),p=n(433),u=n(595);n(241);var h=function(e){function t(){var t=e.call(this,"section",[u.setting.classNames.replays.replays])||this;return t.replays=[],t.container=s.createElement([u.setting.classNames.replays.replaysContainer]),t.element.appendChild(t.container),t.replaysInit(),t}return i(t,e),t.prototype.replaysInit=function(){return r(this,void 0,void 0,(function(){var e,t,n=this;return a(this,(function(o){switch(o.label){case 0:return[4,l.storage.getReplays()];case 1:return e=o.sent(),t=0,e.forEach((function(e){var o=new p.Replay(e,t++);n.replays.push(o),n.container.appendChild(o.element)})),[2]}}))}))},t}(c.BaseComponents);t.Replays=h},649:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;var o=n(595),i=function(){function e(){this.routes=[]}return e.prototype.add=function(e){this.routes.push(e)},e.prototype.newRoute=function(e){this.enumiration(e)},e.prototype.changeRoute=function(){var e=window.location.hash;e?this.enumiration(e):this.enumiration(o.setting.startPage)},e.prototype.enumiration=function(e){for(var t=0;t<this.routes.length;t++)if(-1!==e.indexOf(this.routes[t].hash)){this.routes[t].needFoo();break}},e}();t.Router=i},595:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setting=void 0;var o=n(91),i=n(443),r=n(822),a=n(767),s=n(336),l=n(278),c=n(188);t.setting={classNames:{board:"chess-board",cell:"cell",whiteCell:"white-cell",blackCell:"black-cell",numerationAll:"cell-numeration",numerationEach:"cell-nnumeration__each",letterId:"letter",numberId:"number",piece:"piece",dataPiece:"piece-type",possibleClearCell:"possible-clear-ceil",possibleEngagedCell:"possible-engaged-ceil",moveBacklight:"move-backlight",checkBacklight:"check-backlight",selectPieceBacklight:"select-piece-backlight",headers:{header:"header",container:"header__container",logo:"header-logo",logoImg:"header-logo__img",logoText:"header-logo__text"},lobby:{lobby:"lobby",container:"lobby__container",menu:{menu:"menu",replay:"menu-replay",replayText:"menu-replay__text",replayImg:"menu-replay__img",setting:"menu-setting",settingImg:"menu-setting__inner",start:"menu-start",startText:"menu-start__text",gameMode:"game-mode"}},player:{player:"player",avatar:"player__avatar",gameAvatar:"player__game-avatar",name:"player__name"},game:{playerStatistics:"player-statistics",playerMoveTable:"player-statistics__table",playerMoveTableEach:"player-statistics__table-each",playerMoveTableImg:"player-statistics__table-img",playerMoveTableCells:"player-statistics__table-cells",playerMoveTableTime:"player-statistics__table-time",rotate:"rotating",noRotate:"rotated",playerActive:"player-active"},popups:{closeClass:"popup_close",popupReplaysBtn:"popup__replays-btn",popupLobbyBtn:"popup__lobby-btn",popupText:"popup__text"},replays:{replays:"replays",replaysContainer:"replays__container",replaysEach:"replays__each",replaysEachContainer:"replays__each-container",piecePrototype:"replays__piece-prototype",avatar:"replays__avatar",name:"replays__name",time:"replays__time",crown:"replays__crown",cross:"replays__cross",playerContainer:"replays__player-container",headerBtns:"header-btns",headerBtn:"header-btns__each"},disable:"disable",enable:"enable"},initialGameSetup:[{cell:"a8",piece:"blackRook"},{cell:"b8",piece:"blackKnight"},{cell:"c8",piece:"blackBishop"},{cell:"d8",piece:"blackQueen"},{cell:"e8",piece:"blackKing"},{cell:"f8",piece:"blackBishop"},{cell:"g8",piece:"blackKnight"},{cell:"h8",piece:"blackRook"},{cell:"a7",piece:"blackPawn"},{cell:"b7",piece:"blackPawn"},{cell:"c5",piece:"blackPawn"},{cell:"d6",piece:"blackPawn"},{cell:"e7",piece:"blackPawn"},{cell:"f7",piece:"blackPawn"},{cell:"g7",piece:"blackPawn"},{cell:"h7",piece:"blackPawn"},{cell:"a1",piece:"whiteRook"},{cell:"b1",piece:"whiteKnight"},{cell:"c1",piece:"whiteBishop"},{cell:"d1",piece:"whiteQueen"},{cell:"e1",piece:"whiteKing"},{cell:"f1",piece:"whiteBishop"},{cell:"g1",piece:"whiteKnight"},{cell:"h1",piece:"whiteRook"},{cell:"a2",piece:"whitePawn"},{cell:"b2",piece:"whitePawn"},{cell:"c2",piece:"whitePawn"},{cell:"d2",piece:"whitePawn"},{cell:"e5",piece:"whitePawn"},{cell:"f2",piece:"whitePawn"},{cell:"g2",piece:"whitePawn"},{cell:"h2",piece:"whitePawn"}],gameSetup:[{cell:"a8",piece:"blackRook"},{cell:"b8",piece:"blackKnight"},{cell:"c8",piece:"blackBishop"},{cell:"d8",piece:"blackQueen"},{cell:"e8",piece:"blackKing"},{cell:"f8",piece:"blackBishop"},{cell:"g8",piece:"blackKnight"},{cell:"h8",piece:"blackRook"},{cell:"a7",piece:"blackPawn"},{cell:"b7",piece:"blackPawn"},{cell:"c5",piece:"blackPawn"},{cell:"d6",piece:"blackPawn"},{cell:"e7",piece:"blackPawn"},{cell:"f7",piece:"blackPawn"},{cell:"g7",piece:"blackPawn"},{cell:"h7",piece:"blackPawn"},{cell:"a1",piece:"whiteRook"},{cell:"b1",piece:"whiteKnight"},{cell:"c1",piece:"whiteBishop"},{cell:"d1",piece:"whiteQueen"},{cell:"e1",piece:"whiteKing"},{cell:"f1",piece:"whiteBishop"},{cell:"g1",piece:"whiteKnight"},{cell:"h1",piece:"whiteRook"},{cell:"a2",piece:"whitePawn"},{cell:"b2",piece:"whitePawn"},{cell:"c2",piece:"whitePawn"},{cell:"d2",piece:"whitePawn"},{cell:"e5",piece:"whitePawn"},{cell:"f2",piece:"whitePawn"},{cell:"g2",piece:"whitePawn"},{cell:"h2",piece:"whitePawn"}],imgNames:{blackQueen:"./chess/black-queen.svg",blackKing:"./chess/black-king.svg",blackBishop:"./chess/black-bishop.svg",blackKnight:"./chess/black-knight.svg",blackRook:"./chess/black-rook.svg",blackPawn:"./chess/black-pawn.svg",whiteQueen:"./chess/white-queen.svg",whiteKing:"./chess/white-king.svg",whiteBishop:"./chess/white-bishop.svg",whiteKnight:"./chess/white-knight.svg",whiteRook:"./chess/white-rook.svg",whitePawn:"./chess/white-pawn.svg",crown:"./flags/crown.svg",cross:"./flags/x.svg",leftArrow:"./header/chevron-left.svg",rightArrow:"./header/chevron-right.svg"},createFunctions:{blackQueen:function(e){return new s.Queen(e,c.color.black)},blackKing:function(e){return new i.King(e,c.color.black)},blackBishop:function(e){return new o.Bishop(e,c.color.black)},blackKnight:function(e){return new r.Knight(e,c.color.black)},blackRook:function(e){return new l.Rook(e,c.color.black)},blackPawn:function(e){return new a.Pawn(e,c.color.black)},whiteQueen:function(e){return new s.Queen(e,c.color.white)},whiteKing:function(e){return new i.King(e,c.color.white)},whiteBishop:function(e){return new o.Bishop(e,c.color.white)},whiteKnight:function(e){return new r.Knight(e,c.color.white)},whiteRook:function(e){return new l.Rook(e,c.color.white)},whitePawn:function(e){return new a.Pawn(e,c.color.white)}},isWhiteFromBelow:!0,isTwoPlayersOffline:!0,passantCell:{positiveIncrement:4,negativeIncrement:3},startPage:"#/Lobby",dataBase:{version:1,storeUserName:"user",storeGamesName:"replays"},playersInitStates:{players:["Player 1","Player 2"],playerImgURL:"./avatar/Unknown.png"},serverURL:"wss://ancient-oasis-48599.herokuapp.com"}},266:function(e,t,n){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.WatchReplay=void 0;var r=n(229),a=n(188),s=function(e){function t(t){var n,o=e.call(this,t)||this;o.whiteIncrement=0,o.blackIncrement=0;var i=o.getPlayerStatistics();return n=i.firstPlayer.getColor()===a.color.white?[i.firstPlayer,i.secondPlayer]:[i.secondPlayer,i.firstPlayer],o.whitePlayer=n[0],o.blackPlayer=n[1],o}return i(t,e),t.prototype.makeMove=function(e){var t,n;e?this.isWhiteMove?(t=this.whitePlayer.moveTable.getAllMoves()[this.whiteIncrement].startCell,n=this.whitePlayer.moveTable.getAllMoves()[this.whiteIncrement].endCell,this.whiteIncrement++):(t=this.blackPlayer.moveTable.getAllMoves()[this.blackIncrement].startCell,n=this.blackPlayer.moveTable.getAllMoves()[this.blackIncrement].endCell,this.blackIncrement++):this.isWhiteMove?(this.blackIncrement--,n=this.blackPlayer.moveTable.getAllMoves()[this.blackIncrement].startCell,t=this.blackPlayer.moveTable.getAllMoves()[this.blackIncrement].endCell):(this.whiteIncrement--,n=this.whitePlayer.moveTable.getAllMoves()[this.whiteIncrement].startCell,t=this.whitePlayer.moveTable.getAllMoves()[this.whiteIncrement].endCell),this.pieceActive=this.chessBoard.selectPiece(t),this.replayPieceMove(n)},t.prototype.replayPieceMove=function(e){this.pieceActive&&(this.checkBacklightRemove(),this.moveBacklightRemove(),this.moveBacklightAdd(e),this.chessBoard.pieceMove(e,this.pieceActive),this.isWhiteMove=!this.isWhiteMove,this.replayCheckMateValidation(this.pieceActive.color),this.pieceActive=void 0)},t.prototype.replayCheckMateValidation=function(e){var t,n=this.chessBoard.checkValidation(e),o=this.chessBoard.movePossibilityValidation(e);if(n&&!o){if(this.checkBacklightAdd(),!this.activePlayer)throw new Error("Active player does not exist!");this.createWinPopup(null===(t=this.activePlayer)||void 0===t?void 0:t.getName())}else n?(this.checkBacklightAdd(),console.log("check")):o||this.createDrawPopup()},t}(r.Game);t.WatchReplay=s},650:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cellCoordinatesToName=void 0,t.cellCoordinatesToName=function(e){return String.fromCharCode(e.X+97)+String(e.Y+1)}},836:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cellNameToCellPosition=void 0,t.cellNameToCellPosition=function(e){var t=e.charCodeAt(0);return 63-(8*(Number(e[1])-1)+Math.abs(t-104))}},175:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cellNameToCoordinates=void 0,t.cellNameToCoordinates=function(e){return{X:e.charCodeAt(0)-97,Y:Number(e[1])-1}}},510:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.colorFunctions=void 0;var o=n(188);t.colorFunctions={getReverseColor:function(e){return e===o.color.white?o.color.black:o.color.white},getRandomColor:function(){return Math.random()>.5?o.color.black:o.color.white}}},735:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=void 0,t.createElement=function(e){var t,n=document.createElement("div");return(t=n.classList).add.apply(t,e),n}},771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageReader=void 0;var n=function(){function e(){}return e.writeMessage=function(e,t){return e+" "+t},e.readMessage=function(e){return e.split(" ")},e}();t.MessageReader=n}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e].call(r.exports,r,r.exports,o),r.exports}o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e=new(o(77).App)(document.body),window.addEventListener("load",(function(){e.router.changeRoute()})),window.addEventListener("hashchange",(function(){e.router.changeRoute()}))})();